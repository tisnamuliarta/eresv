/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1047:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(1144),o=n(1048),l={CELL_TYPE:"text",editor:r.a,renderer:o.a}},1048:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(85);var r=n(1049),o=n(664),l=n(671);function c(t,e,n,col,c,f,d){r.a.apply(this,[t,e,n,col,c,f,d]);var h=f;if(!h&&d.placeholder&&(h=d.placeholder),h=Object(l.stringify)(h),d.trimWhitespace&&(h=h.trim()),d.rendererTemplate){Object(o.empty)(e);var y=t.rootDocument.createElement("TEMPLATE");y.setAttribute("bind","{{}}"),y.innerHTML=d.rendererTemplate,HTMLTemplateElement.decorate(y),y.model=t.getSourceDataAtRow(n),e.appendChild(y)}else Object(o.fastInnerText)(e,h)}c.RENDERER_TYPE="text"},1049:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(664);function o(t,e,n,col,o,l,c){var f=[],d=[];c.className&&Object(r.addClass)(e,c.className),c.readOnly&&f.push(c.readOnlyCellClassName),!1===c.valid&&c.invalidCellClassName?f.push(c.invalidCellClassName):d.push(c.invalidCellClassName),!1===c.wordWrap&&c.noWordWrapClassName&&f.push(c.noWordWrapClassName),!l&&c.placeholder&&f.push(c.placeholderCellClassName),Object(r.removeClass)(e,d),Object(r.addClass)(e,f)}o.RENDERER_TYPE="base"},1050:function(t,e,n){"use strict";n(240),n(6),n(40),n(306),n(44),n(654),n(655),n(11),n(62),n(26),n(74);var r=n(847);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,l=void 0,l=function(input,t){if("object"!==o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===o(l)?l:String(l)),n)}var r,l}var c=new WeakMap,f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,l=e.itemSizeFn,f=e.overrideFn,d=e.calculationType,h=e.scrollbarHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:l,overrideFn:f,calculationType:d,horizontalScrollbarHeight:h}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}var e,n,o;return e=t,o=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],(n=[{key:"calculate",value:function(){for(var e,n=0,o=!0,l=[],f=c.get(this),d=f.calculationType,h=f.overrideFn,y=f.rowHeightFn,m=f.scrollOffset,v=f.totalRows,w=f.viewportHeight,S=f.horizontalScrollbarHeight||0,i=0;i<v;i++)if(e=y(i),isNaN(e)&&(e=t.DEFAULT_HEIGHT),n<=m&&d!==r.a&&(this.startRow=i),n>=m&&n+(d===r.a?e:0)<=m+w-S&&(null===this.startRow&&(this.startRow=i),this.endRow=i),l.push(n),n+=e,d!==r.a&&(this.endRow=i),n>=m+w-S){o=!1;break}if(this.endRow===v-1&&o)for(this.startRow=this.endRow;this.startRow>0;){var O=l[this.endRow]+e-l[this.startRow-1];if((O<=w-S||d!==r.a)&&(this.startRow-=1),O>=w-S)break}d===r.b&&null!==this.startRow&&h&&h(this),this.startPosition=l[this.startRow],void 0===this.startPosition&&(this.startPosition=null),v<this.endRow&&(this.endRow=v-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=f},1051:function(t,e,n){"use strict";n(240),n(6),n(40),n(306),n(44),n(654),n(655),n(11),n(62),n(26),n(74);var r=n(847);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,l=void 0,l=function(input,t){if("object"!==o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===o(l)?l:String(l)),n)}var r,l}var c=new WeakMap,f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,l=e.itemSizeFn,f=e.overrideFn,d=e.calculationType,h=e.stretchMode,y=e.stretchingItemWidthFn,m=void 0===y?function(t){return t}:y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:l,overrideFn:f,calculationType:d,stretchingColumnWidthFn:m}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=h,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}var e,n,o;return e=t,o=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],(n=[{key:"calculate",value:function(){for(var t,e=0,n=!0,o=[],l=c.get(this),f=l.calculationType,d=l.overrideFn,h=l.scrollOffset,y=l.totalColumns,m=l.viewportWidth,i=0;i<y;i++){t=this._getColumnWidth(i),e<=h&&f!==r.a&&(this.startColumn=i);var v=h>0?m+1:m;if(e>=h&&e+(f===r.a?t:0)<=h+v&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=i),this.endColumn=i),o.push(e),e+=t,f!==r.a&&(this.endColumn=i),e>=h+m){n=!1;break}}if(this.endColumn===y-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var w=o[this.endColumn]+t-o[this.startColumn-1];if((w<=m||f!==r.a)&&(this.startColumn-=1),w>m)break}f===r.b&&null!==this.startColumn&&d&&d(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),y<this.endColumn&&(this.endColumn=y-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=c.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var l=this._getColumnWidth(i),f=n.stretchingColumnWidthFn(void 0,i);"number"==typeof f?e-=f:o+=l}var d=e-o;if("all"===this.stretch&&d>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var h=this._getColumnWidth(r-1),y=d+h;this.stretchLastWidth=y>=0?y:h}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=c.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var l=Math.round(e*this.stretchAllRatio),f=r.stretchingColumnWidthFn(l,t);this.stretchAllColumnsWidth[t]=void 0===f?l:isNaN(f)?this._getColumnWidth(t):f}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===c.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=c.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=f},1052:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));n(33),n(165),n(64),n(94),n(55),n(115),n(420),n(666);var r=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,l=/^\t/;function c(t){var e=[[""]];if(0===t.length)return e;for(var n,c=0,f=0;t.length>0&&n!==t.length;)if(n=t.length,t.match(l))t=t.replace(l,""),c+=1,e[f][c]="";else if(t.match(r))t=t.replace(r,""),c=0,e[f+=1]=[""];else{var d="";if(t.startsWith('"')){for(var h=0,y=!0;y;){var m=t.slice(0,1);'"'===m&&(h+=1),d+=m,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&h%2==0)&&(y=!1)}d=d.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(t){return new Array(Math.floor(t.length/2)).fill('"').join("")}))}else{var v=t.match(o);d=v?v[0]:"",t=t.slice(d.length)}e[f][c]=d}return e}function f(t){var e,n,r,o,l,c="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(c+="\t"),"string"==typeof(l=t[e][r])?l.indexOf("\n")>-1?c+='"'.concat(l.replace(/"/g,'""'),'"'):c+=l:c+=null==l?"":l;e!==n-1&&(c+="\n")}return c}},1144:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));n(666),n(417),n(418),n(6),n(130),n(668),n(16),n(654),n(655),n(11),n(62),n(26),n(74),n(240),n(40),n(44),n(55),n(34),n(56),n(33);var r=n(996),o=n(681),l=n(719),c=n(664),f=n(675),d=n(727);n(54);function h(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},body=document.body,text=document.createTextNode(""),span=document.createElement("SPAN"),n=function(element,t,e){element.addEventListener(t,e,!1)},r=function(element,t,e){element.removeEventListener(t,e,!1)},o=function(n){var r,o;n?/^[a-zA-Z \.,\\\/\|0-9]$/.test(n)||(n="."):n="",void 0!==text.textContent?text.textContent=t.value+n:text.data=t.value+n,span.style.position="absolute",span.style.fontSize=f(t).fontSize,span.style.fontFamily=f(t).fontFamily,span.style.whiteSpace="pre",body.appendChild(span),r=span.clientWidth+2,body.removeChild(span),t.style.height=e.minHeight+"px",e.minWidth>r?t.style.width=e.minWidth+"px":r>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=r+"px",o=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>o?t.style.height=e.minHeight+"px":e.maxHeight<o?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=o+"px"},l=function(){window.setTimeout(o,0)},c=function(r,c,f){t=r,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)e.minHeight=t.clientHeight;else{var r=parseInt(n.minHeight);isNaN(r)||(e.minHeight=r)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)e.maxHeight=t.clientHeight;else{var o=parseInt(n.maxHeight);isNaN(o)||(e.maxHeight=o)}if(n&&n.minWidth)if("inherit"==n.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(e.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)e.maxWidth=t.clientWidth;else{var c=parseInt(n.maxWidth);isNaN(c)||(e.maxWidth=c)}span.firstChild||(span.className="autoResize",span.style.display="inline-block",span.appendChild(text))}(c),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),f&&(n(t,"change",o),n(t,"cut",l),n(t,"paste",l),n(t,"drop",l),n(t,"keydown",l),n(t,"focus",o),n(t,"compositionstart",l),n(t,"compositionupdate",l),n(t,"compositionend",l)),o()};function f(element){return element.currentStyle||document.defaultView.getComputedStyle(element)}return{init:function(t,e,n){c(t,e,n)},unObserve:function(){r(t,"change",o),r(t,"cut",l),r(t,"paste",l),r(t,"drop",l),r(t,"keydown",l),r(t,"focus",o),r(t,"compositionstart",l),r(t,"compositionupdate",l),r(t,"compositionend",l)},resize:o}}var y=n(671),m=n(763);function v(t,e){for(var n=Object(c.getCaretPosition)(e),r=e.value.split("\n"),o=n,l=0,i=0;i<r.length;i++){var f=r[i];0!==i&&(l+=r[i-1].length+1);var d=l+f.length;if("home"===t?o=l:"end"===t&&(o=d),n<=d)break}Object(c.setCaretPosition)(e,o)}function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function S(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function C(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==w(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===w(o)?o:String(o)),n)}var r,o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=j(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},E.apply(this,arguments)}function T(t,p){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},T(t,p)}function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j(t);if(e){var o=j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return k(t)}(this,n)}}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}var x="ht_editor_hidden",A="textEditor",_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e)}(_,t);var e,n,w,O=R(_);function _(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(e=O.call(this,t)).eventManager=new o.a(k(e)),e.autoResize=h(),e.TEXTAREA=void 0,e.textareaStyle=void 0,e.TEXTAREA_PARENT=void 0,e.textareaParentStyle=void 0,e.layerClass=void 0,e.createElements(),e.bindEvents(),e.hot.addHookOnce("afterDestroy",(function(){return e.destroy()})),e}return e=_,n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(e){return t.onAfterDocumentKeyDown(e)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(t,col,e,td,n,o){var c=this.state;if(E(j(_.prototype),"prepare",this).call(this,t,col,e,td,n,o),!o.readOnly){this.refreshDimensions(!0);var f=o.allowInvalid,d=o.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==r.b.FINISHED&&this.hideEditableElement(),!d&&!Object(l.isMobileBrowser)()&&this.focus()}}},{key:"beginEditing",value:function(t,e){this.state===r.b.VIRGIN&&(this.TEXTAREA.value="",E(j(_.prototype),"beginEditing",this).call(this,t,e))}},{key:"focus",value:function(){this.TEXTAREA.select(),Object(c.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Object(c.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Object(c.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(c.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&Object(c.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(c.addClass)(this.TEXTAREA_PARENT,x),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Object(l.isIE)()||Object(l.isEdge)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(c.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(c.addClass)(this.TEXTAREA_PARENT,x)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;Object(f.rangeEach)(t.length-1,(function(n){var r=t[n];if(Object(c.hasClass)(r,"handsontableEditor"))return e=!0,!1})),Object(c.hasClass)(this.TEXTAREA_PARENT,x)&&Object(c.removeClass)(this.TEXTAREA_PARENT,x),e?(this.layerClass="ht_editor_visible",Object(c.addClass)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(c.addClass)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===r.b.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),n=e.top,o=e.start,l=e.width,f=e.maxWidth,d=e.height,h=e.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),this.showEditableElement();var y=Object(c.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=y.fontSize,this.TEXTAREA.style.fontFamily=y.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var m=Object(c.getComputedStyle)(this.TEXTAREA),v=parseInt(m.paddingLeft,10)+parseInt(m.paddingRight,10),w=parseInt(m.paddingTop,10)+parseInt(m.paddingBottom,10),S=l-v,O=d-w,C=f-v,E=h-w;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(S,C),minHeight:Math.min(O,E),maxWidth:C,maxHeight:E},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(t){return t.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(t){return t.stopPropagation()})),Object(l.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return t.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){t.refreshDimensions(),t.focus()})),this.addHook("afterRowResize",(function(){t.refreshDimensions(),t.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:function(){return Object(y.isDefined)(t.hot.getSelected())},group:A},r=function(){t.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(e){return!t.hot.selection.isMultiple()&&!e.altKey},relativeToGroup:m.a,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(){return!t.hot.selection.isMultiple()},relativeToGroup:m.a,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return r(),!1},relativeToGroup:m.a,position:"before"},{keys:[["PageUp"]],callback:function(){t.hot.selection.transformStart(-t.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){t.hot.selection.transformStart(t.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(e,n){v(S(n,1)[0],t.TEXTAREA)}},{keys:[["End"]],callback:function(e,n){v(S(n,1)[0],t.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}}],n)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(m.b),t.removeShortcutsByGroup(A),t.removeShortcutsByGroup(r.c)}},{key:"onAfterDocumentKeyDown",value:function(t){-1===[d.KEY_CODES.ARROW_UP,d.KEY_CODES.ARROW_RIGHT,d.KEY_CODES.ARROW_DOWN,d.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}],w=[{key:"EDITOR_TYPE",get:function(){return"text"}}],n&&C(e.prototype,n),w&&C(e,w),Object.defineProperty(e,"prototype",{writable:!1}),_}(r.a)},654:function(t,e,n){var r=n(333),o=n(428);r("toPrimitive"),o()},655:function(t,e,n){var r=n(42),o=n(58),l=n(925),c=n(35)("toPrimitive"),f=Date.prototype;r(f,c)||o(f,c,l)},662:function(t,e,n){"use strict";n.r(e),n.d(e,"duckSchema",(function(){return c})),n.d(e,"inherit",(function(){return f})),n.d(e,"extend",(function(){return d})),n.d(e,"deepExtend",(function(){return h})),n.d(e,"deepClone",(function(){return y})),n.d(e,"clone",(function(){return m})),n.d(e,"mixin",(function(){return v})),n.d(e,"isObjectEqual",(function(){return w})),n.d(e,"isObject",(function(){return S})),n.d(e,"defineGetter",(function(){return O})),n.d(e,"objectEach",(function(){return C})),n.d(e,"getProperty",(function(){return E})),n.d(e,"setProperty",(function(){return T})),n.d(e,"deepObjectSize",(function(){return R})),n.d(e,"createObjectPropListener",(function(){return k})),n.d(e,"hasOwnProperty",(function(){return j}));n(420),n(48),n(63),n(6),n(12),n(11),n(62),n(74),n(240),n(40),n(44),n(654),n(655),n(26);var r=n(663);function o(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(object){var t;return Array.isArray(object)?t=object.length?new Array(object.length).fill(null):[]:(t={},C(object,(function(e,n){"__children"!==n&&(e&&"object"===l(e)&&!Array.isArray(e)?t[n]=c(e):Array.isArray(e)?e.length&&"object"===l(e[0])&&!Array.isArray(e[0])?t[n]=[c(e[0])]:t[n]=[]:t[n]=null)}))),t}function f(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function d(t,e,n){var r=Array.isArray(n);return C(e,(function(e,o){(!1===r||n.includes(o))&&(t[o]=e)})),t}function h(t,e){C(e,(function(n,r){e[r]&&"object"===l(e[r])?(t[r]||(Array.isArray(e[r])?t[r]=[]:"[object Date]"===Object.prototype.toString.call(e[r])?t[r]=e[r]:t[r]={}),h(t[r],e[r])):t[r]=e[r]}))}function y(t){return"object"===l(t)?JSON.parse(JSON.stringify(t)):t}function m(object){var t={};return C(object,(function(e,n){t[n]=e})),t}function v(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayEach)(n,(function(e){t.MIXINS.push(e.MIXIN_NAME),C(e,(function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof e)t.prototype[n]=e;else{Object.defineProperty(t.prototype,n,{get:(r=n,o=e,l="_".concat(r),function(){var t;return void 0===this[l]&&(this[l]=(t=o,(Array.isArray(t)||S(t))&&(t=y(t)),t)),this[l]}),set:function(t){var e="_".concat(t);return function(t){this[e]=t}}(n),configurable:!0})}var r,o,l}))})),t}function w(t,e){return JSON.stringify(t)===JSON.stringify(e)}function S(object){return"[object Object]"===Object.prototype.toString.call(object)}function O(object,t,e,n){n.value=e,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(object,t,n)}function C(object,t){for(var e in object)if((!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,e))&&!1===t(object[e],e,object))break;return object}function E(object,t){var e=t.split("."),n=object;return C(e,(function(t){if(void 0===(n=n[t]))return n=void 0,!1})),n}function T(object,t,e){var n=t.split("."),r=object;n.forEach((function(t,o){o!==n.length-1?(j(r,t)||(r[t]={}),r=r[t]):r[t]=e}))}function R(object){if(!S(object))return 0;return function t(e){var n=0;return S(e)?C(e,(function(e,r){"__children"!==r&&(n+=t(e))})):n+=1,n}(object)}function k(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),l=(o(e={_touched:!1},r,t),o(e,"isTouched",(function(){return this._touched})),e);return Object.defineProperty(l,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),l}function j(object,t){return Object.prototype.hasOwnProperty.call(object,t)}},663:function(t,e,n){"use strict";n.r(e),n.d(e,"to2dArray",(function(){return r})),n.d(e,"extendArray",(function(){return o})),n.d(e,"pivot",(function(){return l})),n.d(e,"arrayReduce",(function(){return c})),n.d(e,"arrayFilter",(function(){return f})),n.d(e,"arrayMap",(function(){return d})),n.d(e,"arrayEach",(function(){return h})),n.d(e,"arraySum",(function(){return y})),n.d(e,"arrayMax",(function(){return m})),n.d(e,"arrayMin",(function(){return v})),n.d(e,"arrayAvg",(function(){return w})),n.d(e,"arrayFlatten",(function(){return S})),n.d(e,"arrayUnique",(function(){return O})),n.d(e,"getDifferenceOfArrays",(function(){return C})),n.d(e,"getIntersectionOfArrays",(function(){return E})),n.d(e,"getUnionOfArrays",(function(){return T})),n.d(e,"stringToArray",(function(){return R}));n(56),n(40),n(36),n(666),n(55),n(13),n(6),n(48),n(63),n(240),n(679),n(44),n(33),n(250);function r(t){for(var e=t.length,i=0;i<e;)t[i]=[t[i]],i+=1}function o(t,e){for(var n=e.length,i=0;i<n;)t.push(e[i]),i+=1}function l(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,i=0;i<n;i++)for(var o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function c(t,e,n,r){var o=-1,l=t,c=n;Array.isArray(t)||(l=Array.from(t));var f=l.length;for(r&&f&&(c=l[o+=1]),o+=1;o<f;)c=e(c,l[o],o,l),o+=1;return c}function f(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,l=[],c=-1;n<o;){var f=r[n];e(f,n,r)&&(l[c+=1]=f),n+=1}return l}function d(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,l=[],c=-1;n<o;){var f=r[n];l[c+=1]=e(f,n,r),n+=1}return l}function h(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length;n<o&&!1!==e(r[n],n,r);)n+=1;return t}function y(t){return c(t,(function(a,b){return a+b}),0)}function m(t){return c(t,(function(a,b){return a>b?a:b}),Array.isArray(t)?t[0]:void 0)}function v(t){return c(t,(function(a,b){return a<b?a:b}),Array.isArray(t)?t[0]:void 0)}function w(t){return t.length?y(t)/t.length:0}function S(t){return c(t,(function(t,e){return t.concat(Array.isArray(e)?S(e):e)}),[])}function O(t){var e=[];return h(t,(function(t){-1===e.indexOf(t)&&e.push(t)})),e}function C(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],l=r.slice(1),c=o;return h(l,(function(t){c=c.filter((function(e){return!t.includes(e)}))})),c}function E(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],l=r.slice(1),c=o;return h(l,(function(t){c=c.filter((function(e){return t.includes(e)}))})),c}function T(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],l=r.slice(1),c=new Set(o);return h(l,(function(t){h(t,(function(t){c.has(t)||c.add(t)}))})),Array.from(c)}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}},664:function(t,e,n){"use strict";n.r(e),n.d(e,"getParent",(function(){return m})),n.d(e,"getFrameElement",(function(){return v})),n.d(e,"getParentWindow",(function(){return w})),n.d(e,"hasAccessToParentWindow",(function(){return S})),n.d(e,"closest",(function(){return O})),n.d(e,"closestDown",(function(){return C})),n.d(e,"isChildOf",(function(){return E})),n.d(e,"index",(function(){return T})),n.d(e,"overlayContainsElement",(function(){return R})),n.d(e,"hasClass",(function(){return A})),n.d(e,"addClass",(function(){return _})),n.d(e,"removeClass",(function(){return I})),n.d(e,"removeTextNodes",(function(){return M})),n.d(e,"empty",(function(){return N})),n.d(e,"HTML_CHARACTERS",(function(){return H})),n.d(e,"fastInnerHTML",(function(){return D})),n.d(e,"fastInnerText",(function(){return L})),n.d(e,"isVisible",(function(){return B})),n.d(e,"offset",(function(){return V})),n.d(e,"getWindowScrollTop",(function(){return F})),n.d(e,"getWindowScrollLeft",(function(){return W})),n.d(e,"getScrollTop",(function(){return U})),n.d(e,"getScrollLeft",(function(){return z})),n.d(e,"getScrollableElement",(function(){return G})),n.d(e,"getTrimmingContainer",(function(){return X})),n.d(e,"getStyle",(function(){return K})),n.d(e,"matchesCSSRules",(function(){return Y})),n.d(e,"getComputedStyle",(function(){return $})),n.d(e,"outerWidth",(function(){return Q})),n.d(e,"outerHeight",(function(){return J})),n.d(e,"innerHeight",(function(){return Z})),n.d(e,"innerWidth",(function(){return tt})),n.d(e,"addEvent",(function(){return et})),n.d(e,"removeEvent",(function(){return nt})),n.d(e,"getCaretPosition",(function(){return ot})),n.d(e,"getSelectionEndPosition",(function(){return it})),n.d(e,"getSelectionText",(function(){return at})),n.d(e,"clearTextSelection",(function(){return lt})),n.d(e,"setCaretPosition",(function(){return st})),n.d(e,"getScrollbarWidth",(function(){return ut})),n.d(e,"hasVerticalScrollbar",(function(){return ct})),n.d(e,"hasHorizontalScrollbar",(function(){return ft})),n.d(e,"setOverlayPosition",(function(){return ht})),n.d(e,"getCssTransform",(function(){return pt})),n.d(e,"resetCssTransform",(function(){return yt})),n.d(e,"isInput",(function(){return bt})),n.d(e,"isOutsideInput",(function(){return mt})),n.d(e,"selectElementIfAllowed",(function(){return vt})),n.d(e,"isDetached",(function(){return gt})),n.d(e,"observeVisibilityChangeOnce",(function(){return wt}));n(418),n(48),n(63),n(55),n(666),n(13),n(6),n(246),n(33),n(86),n(115),n(85),n(64),n(36),n(12),n(11),n(62),n(74),n(240),n(40),n(44),n(56),n(34);var r,o,l,c=n(726),f=n(719),d=n(711);function h(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(element){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=-1,n=null,r=element;null!==r;){if(e===t){n=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(e+=1,r=r.parentNode)}return n}function v(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function w(t){return v(t)&&t.parent}function S(t){return!!Object.getPrototypeOf(t.parent)}function O(element){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=Node,r=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,l=element;null!=l&&l!==e;){var c=l,f=c.nodeType,d=c.nodeName;if(f===r&&(t.includes(d)||t.includes(l)))return l;var h=l.host;l=h&&f===o?h:l.parentNode}return null}function C(element,t,e){for(var n=[],r=element;r&&(r=O(r,t,e))&&(!e||e.contains(r));)n.push(r),r=r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode;var o=n.length;return o?n[o-1]:null}function E(t,e){var n=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function T(element){var i=0,t=element;if(t.previousSibling)for(;t=t.previousSibling;)i+=1;return i}function R(t,element,e){var n=e.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(element):null}function k(t){return t&&t.length?t.filter((function(t){return!!t})):[]}if(Object(c.isClassListSupported)()){var j=function(t){var element=t.createElement("div");return element.classList.add("test","test2"),element.classList.contains("test2")};r=function(element,t){return void 0!==element.classList&&"string"==typeof t&&""!==t&&element.classList.contains(t)},o=function(element,t){var e,n=element.ownerDocument,r=t;if("string"==typeof r&&(r=r.split(" ")),(r=k(r)).length>0)if(j(n))(e=element.classList).add.apply(e,h(r));else for(var o=0;r[o];)element.classList.add(r[o]),o+=1},l=function(element,t){var e,n=element.ownerDocument,r=t;if("string"==typeof r&&(r=r.split(" ")),(r=k(r)).length>0)if(j(n))(e=element.classList).remove.apply(e,h(r));else for(var o=0;r[o];)element.classList.remove(r[o]),o+=1}}else{var x=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};r=function(element,t){return void 0!==element.className&&x(t).test(element.className)},o=function(element,t){var e=element.className,n=t;if("string"==typeof n&&(n=n.split(" ")),n=k(n),""===e)e=n.join(" ");else for(var r=0;r<n.length;r++)n[r]&&!x(n[r]).test(e)&&(e+=" ".concat(n[r]));element.className=e},l=function(element,t){var e=0,n=element.className,r=t;for("string"==typeof r&&(r=r.split(" ")),r=k(r);r[e];)n=n.replace(x(r[e])," ").trim(),e+=1;element.className!==n&&(element.className=n)}}function A(element,t){return r(element,t)}function _(element,t){o(element,t)}function I(element,t){l(element,t)}function M(element){if(3===element.nodeType)element.parentNode.removeChild(element);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(element.nodeName)>-1)for(var t=element.childNodes,i=t.length-1;i>=0;i--)M(t[i])}function N(element){for(var t;t=element.lastChild;)element.removeChild(t)}var P,H=/(<(.*)>|&(.*);)/;function D(element,content){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];H.test(content)?element.innerHTML=t?Object(d.sanitize)(content):content:L(element,content)}function L(element,content){var t=element.firstChild;t&&3===t.nodeType&&null===t.nextSibling?c.isTextContentSupported?t.textContent=content:t.data=content:(N(element),element.appendChild(element.ownerDocument.createTextNode(content)))}function B(element){for(var t=element.ownerDocument.documentElement,e=element;e!==t;){if(null===e)return!1;if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(e.host){if(e.host.impl)return B(e.host.impl);if(e.host)return B(e.host);throw new Error("Lost in Web Components world")}return!1}if(e.style&&"none"===e.style.display)return!1;e=e.parentNode}return!0}function V(element){var t,e,n,r,o=element.ownerDocument,l=o.defaultView,f=o.documentElement,d=element;if(Object(c.hasCaptionProblem)()&&d.firstChild&&"CAPTION"===d.firstChild.nodeName)return{top:(r=d.getBoundingClientRect()).top+(l.pageYOffset||f.scrollTop)-(f.clientTop||0),left:r.left+(l.pageXOffset||f.scrollLeft)-(f.clientLeft||0)};for(t=d.offsetLeft,e=d.offsetTop,n=d;(d=d.offsetParent)&&d!==o.body;)t+=d.offsetLeft,e+=d.offsetTop,n=d;return n&&"fixed"===n.style.position&&(t+=l.pageXOffset||f.scrollLeft,e+=l.pageYOffset||f.scrollTop),{left:t,top:e}}function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function W(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function U(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===t?F(t):element.scrollTop}function z(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===t?W(t):element.scrollLeft}function G(element){var t=element.ownerDocument,e=t?t.defaultView:void 0;t||(e=(t=element.document?element.document:element).defaultView);for(var n=["auto","scroll"],r=Object(c.isGetComputedStyleSupported)(),o=element.parentNode;o&&o.style&&t.body!==o;){var l=o.style,f=l.overflow,d=l.overflowX,h=l.overflowY;if([f,d,h].includes("scroll"))return o;if(r){var y=e.getComputedStyle(o);if(f=y.overflow,d=y.overflowX,h=y.overflowY,n.includes(f)||n.includes(d)||n.includes(h))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(h)||n.includes(f)))return o;if(o.clientWidth<=o.scrollWidth+1&&(n.includes(d)||n.includes(f)))return o;o=o.parentNode}return e}function X(base){for(var t=base.ownerDocument,e=t.defaultView,n=base.parentNode;n&&n.style&&t.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var r=$(n,e),o=["scroll","hidden","auto"],l=r.getPropertyValue("overflow"),c=r.getPropertyValue("overflow-y"),f=r.getPropertyValue("overflow-x");if(o.includes(l)||o.includes(c)||o.includes(f))return n;n=n.parentNode}return e}function K(element,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(element){if(element===e)return"width"===t?"".concat(e.innerWidth,"px"):"height"===t?"".concat(e.innerHeight,"px"):void 0;var n=element.style[t];if(""!==n&&void 0!==n)return n;var r=$(element,e);return""!==r[t]&&void 0!==r[t]?r[t]:void 0}}function Y(element,t){var e=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&e&&(element.msMatchesSelector?n=element.msMatchesSelector(e):element.matches&&(n=element.matches(e))),n}function $(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element.currentStyle||t.getComputedStyle(element)}function Q(element){return element.offsetWidth}function J(element){return Object(c.hasCaptionProblem)()&&element.firstChild&&"CAPTION"===element.firstChild.nodeName?element.offsetHeight+element.firstChild.offsetHeight:element.offsetHeight}function Z(element){return element.clientHeight||element.innerHeight}function tt(element){return element.clientWidth||element.innerWidth}function et(element,t,e){element.addEventListener(t,e,!1)}function nt(element,t,e){element.removeEventListener(t,e,!1)}function ot(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function it(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var n=e.selection.createRange();return null===n?0:t.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function at(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,text="";return t.getSelection?text=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(text=e.selection.createRange().text),text}function lt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function st(element,t,e){if(void 0===e&&(e=t),element.setSelectionRange){element.focus();try{element.setSelectionRange(t,e)}catch(o){var n=element.parentNode,r=n.style.display;n.style.display="block",element.setSelectionRange(t,e),n.style.display=r}}}function ut(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===P&&(P=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}(t)),P}function ct(element){return element.offsetWidth!==element.clientWidth}function ft(element){return element.offsetHeight!==element.clientHeight}function ht(t,e,n){Object(f.isIE9)()?(t.style.top=n,t.style.left=e):Object(f.isSafari)()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)"):t.style.transform="translate3d(".concat(e,",").concat(n,",0)")}function pt(element){var t;return element.style.transform&&""!==(t=element.style.transform)?["transform",t]:element.style["-webkit-transform"]&&""!==(t=element.style["-webkit-transform"])?["-webkit-transform",t]:-1}function yt(element){element.style.transform&&""!==element.style.transform?element.style.transform="":element.style["-webkit-transform"]&&""!==element.style["-webkit-transform"]&&(element.style["-webkit-transform"]="")}function bt(element){return element&&(["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||"true"===element.contentEditable)}function mt(element){return bt(element)&&!1===element.hasAttribute("data-hot-input")}function vt(element){mt(element.ownerDocument.activeElement)||element.select()}function gt(element){return!element.parentNode}function wt(t,e){new IntersectionObserver((function(n,r){n.forEach((function(n){n.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))}))}),{root:t.ownerDocument.body}).observe(t)}},665:function(t,e,n){"use strict";n.r(e),n.d(e,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return r})),n.d(e,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return l})),n.d(e,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return c})),n.d(e,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return f})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return d})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return h})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return y})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return m})),n.d(e,"CONTEXTMENU_ITEMS_UNDO",(function(){return v})),n.d(e,"CONTEXTMENU_ITEMS_REDO",(function(){return w})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return S})),n.d(e,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return O})),n.d(e,"CONTEXTMENU_ITEMS_COPY",(function(){return C})),n.d(e,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS",(function(){return E})),n.d(e,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS",(function(){return T})),n.d(e,"CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY",(function(){return R})),n.d(e,"CONTEXTMENU_ITEMS_CUT",(function(){return k})),n.d(e,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return j})),n.d(e,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return x})),n.d(e,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return A})),n.d(e,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return _})),n.d(e,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return I})),n.d(e,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return M})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return N})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return P})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return H})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return D})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return L})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return B})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return V})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return F})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return W})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return U})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS",(function(){return z})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return G})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return X})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return K})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return Y})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return $})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return Q})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return J})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return Z})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return tt})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return et})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return nt})),n.d(e,"FILTERS_NAMESPACE",(function(){return ot})),n.d(e,"FILTERS_CONDITIONS_NAMESPACE",(function(){return it})),n.d(e,"FILTERS_CONDITIONS_NONE",(function(){return at})),n.d(e,"FILTERS_CONDITIONS_EMPTY",(function(){return lt})),n.d(e,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return st})),n.d(e,"FILTERS_CONDITIONS_EQUAL",(function(){return ut})),n.d(e,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return ct})),n.d(e,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return ft})),n.d(e,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return ht})),n.d(e,"FILTERS_CONDITIONS_CONTAINS",(function(){return pt})),n.d(e,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return yt})),n.d(e,"FILTERS_CONDITIONS_BY_VALUE",(function(){return bt})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return mt})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return vt})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN",(function(){return gt})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return wt})),n.d(e,"FILTERS_CONDITIONS_BETWEEN",(function(){return St})),n.d(e,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return Ot})),n.d(e,"FILTERS_CONDITIONS_AFTER",(function(){return Ct})),n.d(e,"FILTERS_CONDITIONS_BEFORE",(function(){return Et})),n.d(e,"FILTERS_CONDITIONS_TODAY",(function(){return Tt})),n.d(e,"FILTERS_CONDITIONS_TOMORROW",(function(){return Rt})),n.d(e,"FILTERS_CONDITIONS_YESTERDAY",(function(){return kt})),n.d(e,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return jt})),n.d(e,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return xt})),n.d(e,"FILTERS_LABELS_CONJUNCTION",(function(){return At})),n.d(e,"FILTERS_LABELS_DISJUNCTION",(function(){return _t})),n.d(e,"FILTERS_VALUES_BLANK_CELLS",(function(){return It})),n.d(e,"FILTERS_BUTTONS_SELECT_ALL",(function(){return Mt})),n.d(e,"FILTERS_BUTTONS_CLEAR",(function(){return Nt})),n.d(e,"FILTERS_BUTTONS_OK",(function(){return Pt})),n.d(e,"FILTERS_BUTTONS_CANCEL",(function(){return Ht})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Dt})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return Lt})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return Bt}));var r="ContextMenu:items",o=r,l="".concat(o,".noItems"),c="".concat(o,".insertRowAbove"),f="".concat(o,".insertRowBelow"),d="".concat(o,".insertColumnOnTheLeft"),h="".concat(o,".insertColumnOnTheRight"),y="".concat(o,".removeRow"),m="".concat(o,".removeColumn"),v="".concat(o,".undo"),w="".concat(o,".redo"),S="".concat(o,".readOnly"),O="".concat(o,".clearColumn"),C="".concat(o,".copy"),E="".concat(o,".copyWithHeaders"),T="".concat(o,".copyWithGroupHeaders"),R="".concat(o,".copyHeadersOnly"),k="".concat(o,".cut"),j="".concat(o,".freezeColumn"),x="".concat(o,".unfreezeColumn"),A="".concat(o,".mergeCells"),_="".concat(o,".unmergeCells"),I="".concat(o,".addComment"),M="".concat(o,".editComment"),N="".concat(o,".removeComment"),P="".concat(o,".readOnlyComment"),H="".concat(o,".align"),D="".concat(o,".align.left"),L="".concat(o,".align.center"),B="".concat(o,".align.right"),V="".concat(o,".align.justify"),F="".concat(o,".align.top"),W="".concat(o,".align.middle"),U="".concat(o,".align.bottom"),z="".concat(o,".borders"),G="".concat(o,".borders.top"),X="".concat(o,".borders.right"),K="".concat(o,".borders.bottom"),Y="".concat(o,".borders.left"),$="".concat(o,".borders.remove"),Q="".concat(o,".nestedHeaders.insertChildRow"),J="".concat(o,".nestedHeaders.detachFromParent"),Z="".concat(o,".hideColumn"),tt="".concat(o,".showColumn"),et="".concat(o,".hideRow"),nt="".concat(o,".showRow"),ot="Filters:",it="".concat(ot,"conditions"),at="".concat(it,".none"),lt="".concat(it,".isEmpty"),st="".concat(it,".isNotEmpty"),ut="".concat(it,".isEqualTo"),ct="".concat(it,".isNotEqualTo"),ft="".concat(it,".beginsWith"),ht="".concat(it,".endsWith"),pt="".concat(it,".contains"),yt="".concat(it,".doesNotContain"),bt="".concat(it,".byValue"),mt="".concat(it,".greaterThan"),vt="".concat(it,".greaterThanOrEqualTo"),gt="".concat(it,".lessThan"),wt="".concat(it,".lessThanOrEqualTo"),St="".concat(it,".isBetween"),Ot="".concat(it,".isNotBetween"),Ct="".concat(it,".after"),Et="".concat(it,".before"),Tt="".concat(it,".today"),Rt="".concat(it,".tomorrow"),kt="".concat(it,".yesterday"),jt="".concat(ot,"labels.filterByCondition"),xt="".concat(ot,"labels.filterByValue"),At="".concat(ot,"labels.conjunction"),_t="".concat(ot,"labels.disjunction"),It="".concat(ot,"values.blankCells"),Mt="".concat(ot,"buttons.selectAll"),Nt="".concat(ot,"buttons.clear"),Pt="".concat(ot,"buttons.ok"),Ht="".concat(ot,"buttons.cancel"),Dt="".concat(ot,"buttons.placeholder.search"),Lt="".concat(ot,"buttons.placeholder.value"),Bt="".concat(ot,"buttons.placeholder.secondValue")},666:function(t,e,n){"use strict";var r=n(7),o=n(203),l=n(332).indexOf,c=n(248),f=o([].indexOf),d=!!f&&1/f([1],1,-0)<0;r({target:"Array",proto:!0,forced:d||!c("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return d?f(this,t,e)||0:l(this,t,e)}})},668:function(t,e,n){var r=n(7),o=n(38),l=n(46),c=n(37),f=n(928),d=n(104),h=n(204);r({target:"Reflect",stat:!0},{get:function t(e,n){var r,y,m=arguments.length<3?e:arguments[2];return c(e)===m?e[n]:(r=d.f(e,n))?f(r)?r.value:void 0===r.get?void 0:o(r.get,m):l(y=h(e))?t(y,n,m):void 0}})},671:function(t,e,n){"use strict";n.r(e),n.d(e,"stringify",(function(){return w})),n.d(e,"isDefined",(function(){return S})),n.d(e,"isUndefined",(function(){return O})),n.d(e,"isEmpty",(function(){return C})),n.d(e,"isRegExp",(function(){return E})),n.d(e,"_injectProductInfo",(function(){return H}));n(55),n(245),n(6),n(86),n(926),n(33),n(64),n(660),n(11),n(62),n(74),n(240),n(40),n(44);var r,o,l,c,f,d,h=n(247),y=n(687);function m(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function w(t){var e;switch(v(t)){case"string":case"number":e="".concat(t);break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function S(t){return void 0!==t}function O(t){return void 0===t}function C(t){return null===t||""===t||O(t)}function E(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var T="length",R=function(t){return parseInt(t,16)},k=function(t){return parseInt(t,10)},j=function(t,s,e){return t.substr(s,e)},x=function(t){return t.codePointAt(0)-65},A=function(t){return"".concat(t).replace(/\-/g,"")},_=function(t){return R(j(A(t),R("12"),x("F")))/(R(j(A(t),x("B"),~~![][T]))||9)},I=function(){return"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},M=!1,N={invalid:function(){return Object(y.a)(r||(r=m(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(y.a)(o||(o=m(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),e,n,e)},missing:function(){return Object(y.a)(l||(l=m(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},P={invalid:function(){return Object(y.a)(c||(c=m(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(y.a)(f||(f=m(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),e,n,e)},missing:function(){return Object(y.a)(d||(d=m(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function H(t,element){var e,n=!C(t),r="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),o="12.3.1",l="invalid",c="invalid",f=function(t){var e=[][T],p=e;if(t[T]!==x("Z"))return!1;for(var n="",i="B<H4P+".split(""),r=x(i.shift());r;r=x(i.shift()||"A"))--r<""[T]?p|=(k("".concat(k(R(n)+(R(j(t,Math.abs(r),2))+[]).padStart(2,"0"))))%97||2)>>1:n=j(t,r,r?1===i[T]?9:8:6);return p===e}(t=A(t||""));if(n||r||f)if(f){var d=h("06/02/2023","DD/MM/YYYY"),y=Math.floor(d.toDate().getTime()/864e5),m=_(t);e=h(864e5*(m+1),"x").format("MMMM DD, YYYY"),y>m?(l="expired",c="expired"):(l="valid",c="valid")}else r?(l="non_commercial",c="valid"):(l="invalid",c="invalid");else l="missing",c="missing";(I()&&(l="valid",c="valid"),M||"valid"===l)||(N[l]({keyValidityDate:e,hotVersion:o})&&console["non_commercial"===l?"info":"warn"](N[l]({keyValidityDate:e,hotVersion:o})),M=!0);if("valid"!==c&&element.parentNode&&P[c]({keyValidityDate:e,hotVersion:o})){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=P[c]({keyValidityDate:e,hotVersion:o}),element.parentNode.insertBefore(v,element.nextSibling)}}},675:function(t,e,n){"use strict";n.r(e),n.d(e,"isNumeric",(function(){return c})),n.d(e,"isNumericLike",(function(){return f})),n.d(e,"rangeEach",(function(){return d})),n.d(e,"rangeEachReverse",(function(){return h})),n.d(e,"valueAccordingPercent",(function(){return y}));n(33),n(115),n(84),n(56),n(40),n(240),n(6),n(679),n(44),n(36),n(246),n(86),n(85),n(64),n(11),n(62),n(74),n(55),n(34);function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=l(t);if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);var o=Array.from(new Set(["."].concat(r(e)))).map((function(t){return"\\".concat(t)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(o,")?\\d+((").concat(o,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}return"object"===n&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function f(t){return c(t,[","])}function d(t,e,n){var r=-1;for("function"==typeof e?(n=e,e=t):r=t-1;++r<=e&&!1!==n(r););}function h(t,e,n){var r=t+1;for("function"==typeof e&&(n=e,e=0);--r>=e&&!1!==n(r););}function y(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}},679:function(t,e,n){n(807)},681:function(t,e,n){"use strict";n.d(e,"b",(function(){return h}));n(196),n(654),n(655),n(11),n(62),n(6),n(26),n(74),n(240),n(40),n(44);var r=n(726),o=n(690);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}var f=0,d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}var e,n,l;return e=t,n=[{key:"addEventListener",value:function(element,t,e){var n=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function c(t){e.call(this,function(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Object(o.stopImmediatePropagation)(this)},t}(t))}return"boolean"==typeof l||Object(r.isPassiveEventSupported)()||(l=!1),this.context.eventListeners.push({element:element,event:t,callback:e,callbackProxy:c,options:l,eventManager:this}),element.addEventListener(t,c,l),f+=1,function(){n.removeEventListener(element,t,e)}}},{key:"removeEventListener",value:function(element,t,e){for(var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;o;)if(o-=1,(n=this.context.eventListeners[o]).event===t&&n.element===element){if(e&&e!==n.callback)continue;if(r&&n.eventManager!==this)continue;this.context.eventListeners.splice(o,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),f-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var e=this.context.eventListeners.length;e;){e-=1;var n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),f-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(element,t){var e=element.document,n=element;e||(n=(e=element.ownerDocument?element.ownerDocument:element).defaultView);var r,o={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};e.createEvent?(r=e.createEvent("MouseEvents")).initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||e.body.parentNode):r=e.createEventObject(),element.dispatchEvent?element.dispatchEvent(r):element.fireEvent("on".concat(t),r)}}],n&&c(e.prototype,n),l&&c(e,l),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(){return f}e.a=d},685:function(t,e,n){"use strict";n(55),n(245),n(654),n(655),n(11),n(62),n(26),n(74),n(240),n(243),n(6),n(40),n(44),n(666),n(196);var r,o=n(663),l=n(662),c=n(711),f=n(689),d=n(687),h=n(686);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==y(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===y(o)?o:String(o)),n)}var r,o}var v,w,S=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],O=Object(d.a)(r||(v=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],(w=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])||(w=v.slice(0)),r=Object.freeze(Object.defineProperties(v,{raw:{value:Object.freeze(w)}})))),C=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),E=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalBucket=this.createEmptyBucket()}var e,n,r;return e=t,n=[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return Object(o.arrayEach)(S,(function(e){return t[e]=[]})),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))Object(o.arrayEach)(e,(function(e){return n.add(t,e,r)}));else{C.has(t)&&Object(f.b)(Object(c.substitute)(O,{hookName:t,removedInVersion:C.get(t)})),E.has(t)&&Object(f.b)(E.get(t));var l=this.getBucket(r);if(void 0===l[t]&&(this.register(t),l[t]=[]),e.skip=!1,-1===l[t].indexOf(e)){var d=!1;e.initialHook&&Object(o.arrayEach)(l[t],(function(n,i){if(n.initialHook)return l[t][i]=e,d=!0,!1})),d||l[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?Object(o.arrayEach)(e,(function(e){return n.once(t,e,r)})):(e.runOnce=!0,this.add(t,e,r))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[t]&&r[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,r,o,l,c,f){var d=this.globalBucket[e],y=d?d.length:0,m=0;if(y)for(;m<y;)if(d[m]&&!d[m].skip){var v=Object(h.fastCall)(d[m],t,n,r,o,l,c,f);void 0!==v&&(n=v),d[m]&&d[m].runOnce&&this.remove(e,d[m]),m+=1}else m+=1;var w=this.getBucket(t)[e],S=w?w.length:0,O=0;if(S)for(;O<S;)if(w[O]&&!w[O].skip){var C=Object(h.fastCall)(w[O],t,n,r,o,l,c,f);void 0!==C&&(n=C),w[O]&&w[O].runOnce&&this.remove(e,w[O],t),O+=1}else O+=1;return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l.objectEach)(this.getBucket(t),(function(t,e,n){return n[e].length=0}))}},{key:"register",value:function(t){this.isRegistered(t)||S.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&S.splice(S.indexOf(t),1)}},{key:"isDeprecated",value:function(t){return E.has(t)||C.has(t)}},{key:"isRegistered",value:function(t){return S.indexOf(t)>=0}},{key:"getRegistered",value:function(){return S}}],r=[{key:"getSingleton",value:function(){return R}}],n&&m(e.prototype,n),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),R=new T;e.a=T},686:function(t,e,n){"use strict";n.r(e),n.d(e,"isFunction",(function(){return l})),n.d(e,"throttle",(function(){return c})),n.d(e,"throttleAfterHits",(function(){return f})),n.d(e,"debounce",(function(){return d})),n.d(e,"pipe",(function(){return h})),n.d(e,"partial",(function(){return y})),n.d(e,"curry",(function(){return m})),n.d(e,"curryRight",(function(){return v})),n.d(e,"fastCall",(function(){return w}));n(54),n(55),n(36),n(762);var r=n(663),o=n(671);function l(t){return"function"==typeof t}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;return function(){for(var l=this,c=arguments.length,f=new Array(c),d=0;d<c;d++)f[d]=arguments[d];var h=Date.now(),y=!1;r.lastCallThrottled=!0,n||(n=h,y=!0);var m=e-(h-n);return y?(r.lastCallThrottled=!1,t.apply(this,f)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,t.apply(l,f),n=0,o=void 0}),m)),r}}function f(t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=c(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:200),r=e;function o(){for(var e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];return r?(r-=1,t.apply(this,o)):n.apply(this,o)}return o.clearHits=function(){r=e},o}function d(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var o=this,l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return r&&clearTimeout(r),r=setTimeout((function(){e=t.apply(o,c)}),n),e}}function h(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],l=e.slice(1);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(r.arrayReduce)(l,(function(t,e){return e(t)}),o.apply(this,e))}}function y(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,n.concat(r))}}function m(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var f=r.concat(l);return f.length>=e?t.apply(this,f):n(f)}}([])}function v(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var f=r.concat(l.reverse());return f.length>=e?t.apply(this,f):n(f)}}([])}function w(t,e,n,r,l,c,f,d){return Object(o.isDefined)(d)?t.call(e,n,r,l,c,f,d):Object(o.isDefined)(f)?t.call(e,n,r,l,c,f):Object(o.isDefined)(c)?t.call(e,n,r,l,c):Object(o.isDefined)(l)?t.call(e,n,r,l):Object(o.isDefined)(r)?t.call(e,n,r):Object(o.isDefined)(n)?t.call(e,n):t.call(e)}},687:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n(33),n(64),n(85);var r=n(663);function o(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayReduce)(t,(function(t,e,r){return t+e.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"").trim()}},688:function(t,e,n){"use strict";n.d(e,"a",(function(){return H}));var r=n(840),o=n(163);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){m(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function y(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t,e,n){return(e=E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function S(t,p){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},S(t,p)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}(this,n)}}function E(t){var e=function(input,t){if("object"!=typeof input||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"==typeof e?e:String(e)}var T=Symbol("unassigned"),R=null;function k(source){var t=r.a.hooks.getRegistered(),e={};for(var n in Object.assign(e,r.a.DefaultSettings),e)e[n]={default:T};for(var i=0;i<t.length;i++)e[t[i]]={default:T};return e.settings={default:T},"HotTable"===source&&(e.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},e.wrapperRendererCacheSize={type:Number,default:3e3}),e}function j(t){var e={},n=t.settings;if(n!==T)for(var r in n)n.hasOwnProperty(r)&&n[r]!==T&&(e[r]=n[r]);for(var o in t)t.hasOwnProperty(o)&&"settings"!==o&&t[o]!==T&&(e[o]=t[o]);return e}function x(t,e){var n=j(t),r=t.settings?t.settings:n,o=t.settings?n:null,l={};for(var c in r)!r.hasOwnProperty(c)||void 0===r[c]||e&&"data"!==c&&I(e[c],r[c])||(l[c]=r[c]);for(var f in o)!o.hasOwnProperty(f)||"id"===f||"settings"===f||"wrapperRendererCacheSize"===f||void 0===o[f]||e&&"data"!==f&&I(e[f],o[f])||(l[f]=o[f]);return l}function A(t,e){var n=null;return t.every((function(slot,t){return!slot.data||!slot.data.attrs||void 0===slot.data.attrs[e]||(n=slot,!1)})),n}function _(t,e,n,data){var r=e.$el?e.$el.ownerDocument:document,o={propsData:n,parent:e,data:data};R||((R=r.createElement("DIV")).id="vueHotComponents",r.body.appendChild(R));var l=r.createElement("DIV");return R.appendChild(l),new t.componentOptions.Ctor(o).$mount(l)}function I(t,e){return JSON.stringify(t)===JSON.stringify(e)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var M=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){!function(t){var e=Symbol("newer"),n=Symbol("older");function r(t,e){"number"!=typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function o(t,r){this.key=t,this.value=r,this[e]=void 0,this[n]=void 0}t.LRUMap=r,r.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},r.prototype.assign=function(t){var r,l=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var c=t[Symbol.iterator](),f=c.next();!f.done;f=c.next()){var d=new o(f.value[0],f.value[1]);if(this._keymap.set(d.key,d),r?(r[e]=d,d[n]=r):this.oldest=d,r=d,0==l--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},r.prototype.set=function(t,r){var l=this._keymap.get(t);return l?(l.value=r,this._markEntryAsUsed(l),this):(this._keymap.set(t,l=new o(t,r)),this.newest?(this.newest[e]=l,l[n]=this.newest):this.oldest=l,this.newest=l,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]},r.prototype.has=function(t){return this._keymap.has(t)}}(e)})),N=M.LRUMap;function P(template,style,script,t,e,n,r,o,l,c){"boolean"!=typeof r&&(l=o,o=r,r=!1);const f="function"==typeof script?script.options:script;let d;if(template&&template.render&&(f.render=template.render,f.staticRenderFns=template.staticRenderFns,f._compiled=!0,e&&(f.functional=!0)),t&&(f._scopeId=t),n?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),style&&style.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(n)},f._ssrRegister=d):style&&(d=r?function(t){style.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){style.call(this,o(t))}),d)if(f.functional){const t=f.render;f.render=function(e,n){return d.call(n),t(e,n)}}else{const t=f.beforeCreate;f.beforeCreate=t?[].concat(t,d):[d]}return script}var H=P({render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{attrs:{id:t.id}},[t._t("default")],2)},staticRenderFns:[]},undefined,{name:"HotTable",props:k("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new N(this.wrapperRendererCacheSize);return e.shift=function(){var t=N.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return x(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var component,t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),n=x(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,e&&(n.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(n.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new r.a.Core(this.$el,n),this.hotInstance.init(),(component=this).hotInstance&&(component.hotInstance.addHook("beforeChange",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateCol",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveCol",(function(){component.__internalEdit=!0}))),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,data=this.hotInstance.getSourceData(),n=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),l=this.hotInstance.isColumnModificationAllowed(),c=0;if(data&&data.length!==o&&data.length<o)for(var f=data.length;f<o;f++)n.push(f);if(l)if(c=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),data&&data[0]&&(null===(e=data[0])||void 0===e?void 0:e.length)!==c&&data[0].length<c)for(var d=data[0].length;d<c;d++)r.push(d);this.hotInstance.batch((function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(o-1,data.length-o),l&&0!==data.length&&(r.length>0?t.hotInstance.columnIndexMapper.removeIndexes(r):t.hotInstance.columnIndexMapper.insertIndexes(c-1,data[0].length-c))}))}},getGlobalRendererVNode:function(){return A(this.$slots.default||[],"hot-renderer")},getGlobalEditorVNode:function(){return A(this.$slots.default||[],"hot-editor")},getColumnSettings:function(){var t=this.$children.filter((function(t){return"HotColumn"===t.$options.name})),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),c({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(r,o,l,col,c,f,d){if(o&&!o.getAttribute("ghost-table")){var h=n.rendererCache,y={hotInstance:r,TD:o,row:l,col:col,prop:c,value:f,cellProperties:d,isRenderer:!0};if(h&&!h.has("".concat(l,"-").concat(col))){var m=_(t,e,t.componentOptions.propsData,y);h.set("".concat(l,"-").concat(col),{component:m,lastUsedTD:null})}var v=h.get("".concat(l,"-").concat(col)),w=v.component,S=v.lastUsedTD;if(Object.assign(w.$data,y),!w.$el.parentElement||S!==o){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(w.$el),v.lastUsedTD=o}}return o}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,r=t.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,l=this.editorCache,c=null;return l.has(o)?c=l.get(o):(c=_(t,e,t.componentOptions.propsData,{isEditor:!0}),l.set(o,c)),c.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:"12.3.1"},undefined,false,undefined,!1,void 0,void 0,void 0);k("HotColumn");function D(t){return D="function"==typeof Symbol&&"symbol"===f(Symbol.iterator)?function(t){return f(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":f(t)},D(t)}function L(t){return function(t){if(Array.isArray(t)){for(var i=0,e=new Array(t.length);i<t.length;i++)e[i]=t[i];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function B(t,e,n){(n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e)).forEach((function(r){var o=n?Reflect.getOwnMetadata(r,e,n):Reflect.getOwnMetadata(r,e);n?Reflect.defineMetadata(r,o,t,n):Reflect.defineMetadata(r,o,t)}))}var V={__proto__:[]}instanceof Array;var F=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function W(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(F.indexOf(t)>-1)e[t]=n[t];else{var r=Object.getOwnPropertyDescriptor(n,t);void 0!==r.value?"function"==typeof r.value?(e.methods||(e.methods={}))[t]=r.value:(e.mixins||(e.mixins=[])).push({data:function(){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,r.value)}}):(r.get||r.set)&&((e.computed||(e.computed={}))[t]={get:r.get,set:r.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return function(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var r in t.$options.props)t.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var data=new e;e.prototype._init=n;var r={};return Object.keys(data).forEach((function(t){void 0!==data[t]&&(r[t]=data[t])})),r}(this,t)}});var r=t.__decorators__;r&&(r.forEach((function(t){return t(e)})),delete t.__decorators__);var l,c,f=Object.getPrototypeOf(t.prototype),d=f instanceof o?f.constructor:o,h=d.extend(e);return function(t,e,n){Object.getOwnPropertyNames(e).forEach((function(r){if(!U[r]){var o=Object.getOwnPropertyDescriptor(t,r);if(!o||o.configurable){var l,c,f=Object.getOwnPropertyDescriptor(e,r);if(!V){if("cid"===r)return;var d=Object.getOwnPropertyDescriptor(n,r);if(l=f.value,c=D(l),null!=l&&("object"===c||"function"===c)&&d&&d.value===f.value)return}Object.defineProperty(t,r,f)}}}))}(h,t,d),"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys&&(B(l=h,c=t),Object.getOwnPropertyNames(c.prototype).forEach((function(t){B(l.prototype,c.prototype,t)})),Object.getOwnPropertyNames(c).forEach((function(t){B(l,c,t)}))),h}var U={prototype:!0,arguments:!0,callee:!0,caller:!0};function z(t){return"function"==typeof t?W(t):function(e){return W(e,t)}}z.registerHooks=function(t){F.push.apply(F,L(t))};var G=function(t){v(n,t);var e=C(n);function n(){var t;return d(this,n),(t=e.apply(this,arguments)).name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return y(n,[{key:"mounted",value:function(){var t,e=this;this.$data.hotCustomEditorClass=(t=function(t){v(r,t);var n=C(r);function r(t){var o;return d(this,r),o=n.call(this,t),e.$data.hotCustomEditorInstance=O(o),o}return y(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(r.a.editors.BaseEditor),Object.getOwnPropertyNames(r.a.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(t=e[n]).call.apply(t,[this].concat(o))})})),t)}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];(t=r.a.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,col,e,n,o,l){return this.$data.hotInstance=l.instance,this.$data.row=t,this.$data.col=col,this.$data.prop=e,this.$data.TD=n,this.$data.originalValue=o,this.$data.cellProperties=l,r.a.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,col,e,n,o,l)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(o);G=function(t,e,n,desc){var r,o=arguments.length,l=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(l=(o<3?r(l):o>3?r(e,n,l):r(e,n))||l);return o>3&&l&&Object.defineProperty(e,n,l),l}([z({})],G)},689:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return l}));var r=n(671);function o(){var t;Object(r.isDefined)(console)&&(t=console).warn.apply(t,arguments)}function l(){var t;Object(r.isDefined)(console)&&(t=console).error.apply(t,arguments)}},690:function(t,e,n){"use strict";function r(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function o(t){return!1===t.isImmediatePropagationEnabled}function l(t){return 2===t.button}function c(t){return 0===t.button}n.r(e),n.d(e,"stopImmediatePropagation",(function(){return r})),n.d(e,"isImmediatePropagationStopped",(function(){return o})),n.d(e,"isRightClick",(function(){return l})),n.d(e,"isLeftClick",(function(){return c}))},691:function(t,e,n){n(7)({target:"Number",stat:!0},{isInteger:n(929)})},692:function(t,e,n){var content=n(938);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(19).default)("6a23fc8a",content,!0,{sourceMap:!1})},696:function(t,e,n){"use strict";n.d(e,"e",(function(){return S})),n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return v})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return y}));n(240),n(6),n(40),n(306),n(44);var r=n(685),o=n(725),l=new WeakMap,c=Object(o.a)("editors"),f=c.register,d=c.getItem,h=c.hasItem,y=c.getNames;c.getValues;function m(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},r.a.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function v(t,e){var n;if("function"==typeof t)l.get(t)||S(null,t),n=l.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=d(t)}if(!n)throw Error('No editor registered under name "'.concat(t,'"'));return n.getInstance(e)}function w(t){if("function"==typeof t)return t;if(!h(t))throw Error('No registered editor found under "'.concat(t,'" name'));return d(t).getConstructor()}function S(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);var n=new m(e);"string"==typeof t&&f(t,n),l.set(e,n)}},711:function(t,e,n){"use strict";n.r(e),n.d(e,"toUpperCaseFirst",(function(){return l})),n.d(e,"equalsIgnoreCase",(function(){return c})),n.d(e,"randomString",(function(){return f})),n.d(e,"isPercentValue",(function(){return d})),n.d(e,"substitute",(function(){return h})),n.d(e,"stripTags",(function(){return y})),n.d(e,"sanitize",(function(){return m}));n(666),n(6),n(86),n(33),n(64);var r=n(927),o=n(671);function l(t){return t[0].toUpperCase()+t.substr(1)}function c(){for(var t=[],e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var l=n.length;l;){l-=1;var c=Object(o.stringify)(n[l]).toLowerCase();-1===t.indexOf(c)&&t.push(c)}return 1===t.length}function f(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function d(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function h(template){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(template).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}function y(t){return m("".concat(t),{ALLOWED_TAGS:[]})}function m(t,e){return r.sanitize(t,e)}},712:function(t,e,n){"use strict";var r=n(662),o=n(686),l={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t,e,n,r,l,c,f){if(this._localHooks[t])for(var d=this._localHooks[t].length,i=0;i<d;i++)Object(o.fastCall)(this._localHooks[t][i],this,e,n,r,l,c,f)},clearLocalHooks:function(){return this._localHooks={},this}};Object(r.defineGetter)(l,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.a=l},719:function(t,e,n){"use strict";n.r(e),n.d(e,"setBrowserMeta",(function(){return f})),n.d(e,"setPlatformMeta",(function(){return d})),n.d(e,"isChrome",(function(){return h})),n.d(e,"isChromeWebKit",(function(){return y})),n.d(e,"isFirefox",(function(){return m})),n.d(e,"isFirefoxWebKit",(function(){return v})),n.d(e,"isSafari",(function(){return w})),n.d(e,"isEdge",(function(){return S})),n.d(e,"isEdgeWebKit",(function(){return O})),n.d(e,"isIE",(function(){return C})),n.d(e,"isIE9",(function(){return E})),n.d(e,"isMSBrowser",(function(){return T})),n.d(e,"isMobileBrowser",(function(){return R})),n.d(e,"isIOS",(function(){return k})),n.d(e,"isIpadOS",(function(){return j})),n.d(e,"isWindowsOS",(function(){return x})),n.d(e,"isMacOS",(function(){return A})),n.d(e,"isLinuxOS",(function(){return _}));n(33);var r=n(662),o=function(t){var e={value:!1,test:function(n,r){e.value=t(n,r)}};return e},l={chrome:o((function(t,e){return/Chrome/.test(t)&&/Google/.test(e)})),chromeWebKit:o((function(t){return/CriOS/.test(t)})),edge:o((function(t){return/Edge/.test(t)})),edgeWebKit:o((function(t){return/EdgiOS/.test(t)})),firefox:o((function(t){return/Firefox/.test(t)})),firefoxWebKit:o((function(t){return/FxiOS/.test(t)})),ie:o((function(t){return/Trident/.test(t)})),ie9:o((function(){return!!document.documentMode})),mobile:o((function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)})),safari:o((function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)}))},c={mac:o((function(t){return/^Mac/.test(t)})),win:o((function(t){return/^Win/.test(t)})),linux:o((function(t){return/^Linux/.test(t)})),ios:o((function(t){return/iPhone|iPad|iPod/i.test(t)}))};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,o=t.vendor,c=void 0===o?navigator.vendor:o;Object(r.objectEach)(l,(function(t){(0,t.test)(n,c)}))}function d(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).platform,e=void 0===t?navigator.platform:t;Object(r.objectEach)(c,(function(t){(0,t.test)(e)}))}function h(){return l.chrome.value}function y(){return l.chromeWebKit.value}function m(){return l.firefox.value}function v(){return l.firefoxWebKit.value}function w(){return l.safari.value}function S(){return l.edge.value}function O(){return l.edgeWebKit.value}function C(){return l.ie.value}function E(){return l.ie9.value}function T(){return l.ie.value||l.edge.value}function R(){return l.mobile.value}function k(){return c.ios.value}function j(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator).maxTouchPoints>2&&c.mac.value}function x(){return c.win.value}function A(){return c.mac.value}function _(){return c.linux.value}f(),d()},721:function(t,e,n){"use strict";n.d(e,"d",(function(){return w})),n.d(e,"a",(function(){return v})),n.d(e,"c",(function(){return y})),n.d(e,"b",(function(){return m}));var r=n(725),o=n(696),l=n(722),c=n(723),f=Object(r.a)("cellTypes"),d=f.register,h=f.getItem,y=f.hasItem,m=f.getNames;f.getValues;function v(t){if(!y(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return h(t)}function w(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);var n=e,r=n.editor,f=n.renderer,h=n.validator;r&&Object(o.e)(t,r),f&&Object(l.d)(t,f),h&&Object(c.d)(t,h),d(t,e)}},722:function(t,e,n){"use strict";n.d(e,"d",(function(){return y})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return d}));var r=n(725),o=Object(r.a)("renderers"),l=o.register,c=o.getItem,f=o.hasItem,d=o.getNames;o.getValues;function h(t){if("function"==typeof t)return t;if(!f(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return c(t)}function y(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),l(t,e)}},723:function(t,e,n){"use strict";n.d(e,"d",(function(){return y})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return d}));var r=n(725),o=Object(r.a)("validators"),l=o.register,c=o.getItem,f=o.hasItem,d=o.getNames;o.getValues;function h(t){if("function"==typeof t)return t;if(!f(t))throw Error('No registered validator found under "'.concat(t,'" name'));return c(t)}function y(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),l(t,e)}},725:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(240),n(243),n(6),n(40),n(44),n(11),n(62),n(74),n(56),n(55),n(34),n(33);function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var l=new Map;function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";l.has(t)||l.set(t,new Map);var e=l.get(t);return{register:function(t,n){e.set(t,n)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return r(e.keys())},getValues:function(){return r(e.values())}}}},726:function(t,e,n){"use strict";n.r(e),n.d(e,"requestAnimationFrame",(function(){return f})),n.d(e,"isClassListSupported",(function(){return d})),n.d(e,"isTextContentSupported",(function(){return h})),n.d(e,"isGetComputedStyleSupported",(function(){return y})),n.d(e,"cancelAnimationFrame",(function(){return m})),n.d(e,"isTouchSupported",(function(){return v})),n.d(e,"hasCaptionProblem",(function(){return w})),n.d(e,"getComparisonFunction",(function(){return S})),n.d(e,"isPassiveEventSupported",(function(){return O}));var r,o,l;n(11),n(62),n(6),n(74),n(240),n(40),n(44);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t){return window.requestAnimationFrame(t)}function d(){return!!document.documentElement.classList}function h(){return!!document.createTextNode("test").textContent}function y(){return!!window.getComputedStyle}function m(t){window.cancelAnimationFrame(t)}function v(){return"ontouchstart"in window}function w(){return void 0===r&&function(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",t.insertBefore(n,e),document.body.appendChild(t),r=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}(),r}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o||(o="object"===("undefined"==typeof Intl?"undefined":c(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(a,b){return"".concat(a).localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1})}function O(){if(void 0!==l)return l;try{var t={get passive(){l=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){l=!1}return l}},727:function(t,e,n){"use strict";n.r(e),n.d(e,"KEY_CODES",(function(){return l})),n.d(e,"isPrintableChar",(function(){return f})),n.d(e,"isFunctionKey",(function(){return d})),n.d(e,"isCtrlKey",(function(){return h})),n.d(e,"isCtrlMetaKey",(function(){return y})),n.d(e,"isKey",(function(){return m}));n(48),n(63);var r=n(663),o=n(719),l={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Object(o.isFirefox)()?182:174,AUDIO_MUTE:Object(o.isFirefox)()?181:173,AUDIO_UP:Object(o.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},c=[l.ALT,l.ARROW_DOWN,l.ARROW_LEFT,l.ARROW_RIGHT,l.ARROW_UP,l.AUDIO_DOWN,l.AUDIO_MUTE,l.AUDIO_UP,l.BACKSPACE,l.CAPS_LOCK,l.DELETE,l.END,l.ENTER,l.ESCAPE,l.F1,l.F2,l.F3,l.F4,l.F5,l.F6,l.F7,l.F8,l.F9,l.F10,l.F11,l.F12,l.F13,l.F14,l.F15,l.F16,l.F17,l.F18,l.F19,l.HOME,l.INSERT,l.MEDIA_NEXT,l.MEDIA_PLAY_PAUSE,l.MEDIA_PREV,l.MEDIA_STOP,l.NULL,l.NUM_LOCK,l.PAGE_DOWN,l.PAGE_UP,l.PAUSE,l.SCROLL_LOCK,l.SHIFT,l.TAB];function f(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function d(t){return c.includes(t)}function h(t){var e=[];return Object(o.isMacOS)()?e.push(l.COMMAND_LEFT,l.COMMAND_RIGHT,l.COMMAND_FIREFOX):e.push(l.CONTROL),e.includes(t)}function y(t){return[l.CONTROL,l.COMMAND_LEFT,l.COMMAND_RIGHT,l.COMMAND_FIREFOX].includes(t)}function m(t,e){var n=e.split("|"),o=!1;return Object(r.arrayEach)(n,(function(e){if(t===l[e])return o=!0,!1})),o}},728:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return f})),n.d(e,"d",(function(){return d}));var r="active-header",o="area",l="cell",c="fill",f="header",d="custom-selection"},735:function(t,e,n){"use strict";n.d(e,"b",(function(){return M})),n.d(e,"a",(function(){return N})),n.d(e,"c",(function(){return P})),n.d(e,"d",(function(){return H}));n(36),n(11),n(62),n(6),n(74),n(240),n(40),n(44),n(56),n(55),n(34),n(33);var r=n(711),o=(n(243),n(84),n(308),n(675)),l=n(686);function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||d(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var y="asc",m=new Map([[y,[-1,1]],["desc",[1,-1]]]),v=function(t){return"The priority '".concat(t,"' is already declared in a map.")},w=function(t){return"The priority '".concat(t,"' is not a number.")};var S=n(779);n(679);function O(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var E=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function T(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||k(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t){return function(t){if(Array.isArray(t))return j(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){if(t){if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(t,e):void 0}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var x=function(t){return'There is already registered "'.concat(t,'" plugin.')},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorPriorityExists,n=t.errorPriorityNaN,r=new Map;return e=Object(l.isFunction)(e)?e:v,n=Object(l.isFunction)(n)?n:w,{addItem:function(t,l){if(!Object(o.isNumeric)(t))throw new Error(n(t));if(r.has(t))throw new Error(e(t));r.set(t,l)},getItems:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=f(m.get(t)||m.get(y),2),n=e[0],o=e[1];return c(r).sort((function(a,b){return a[0]<b[0]?n:o})).map((function(t){return t[1]}))}}}({errorPriorityExists:function(t){return'There is already registered plugin on priority "'.concat(t,'".')},errorPriorityNaN:function(t){return'The priority "'.concat(t,'" is not a number.')}}),_=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).errorItemExists,e=new Set;return t=Object(l.isFunction)(t)?t:E,{addItem:function(n){if(e.has(n))throw new Error(t(n));e.add(n)},clear:function(){e.clear()},getItems:function(){return O(e)}}}({errorItemExists:x}),I=Object(S.a)({errorIdExists:x});function M(){return[].concat(R(A.getItems()),R(_.getItems()))}function N(t){var e=Object(r.toUpperCaseFirst)(t);return I.getItem(e)}function P(t){return!!N(t)}function H(t,e,n){var o=function(t,e,n){"function"==typeof t&&(t=(e=t).PLUGIN_KEY,n=e.PLUGIN_PRIORITY);return[t,e,n]}(t,e,n),l=T(o,3);t=l[0],e=l[1],n=l[2],void 0===N(t)&&function(t,e,n){var o=Object(r.toUpperCaseFirst)(t);if(I.hasItem(o))throw new Error(x(o));void 0===n?_.addItem(o):A.addItem(n,o);I.addItem(o,e)}(t,e,n)}},737:function(t,e,n){"use strict";n.r(e),n.d(e,"spreadsheetColumnLabel",(function(){return f})),n.d(e,"spreadsheetColumnIndex",(function(){return d})),n.d(e,"createSpreadsheetData",(function(){return h})),n.d(e,"createSpreadsheetObjectData",(function(){return y})),n.d(e,"createEmptySpreadsheetData",(function(){return m})),n.d(e,"dataRowToChangesArray",(function(){return v})),n.d(e,"countFirstRowKeys",(function(){return w})),n.d(e,"isArrayOfArrays",(function(){return S})),n.d(e,"isArrayOfObjects",(function(){return O}));n(6),n(12),n(14),n(11),n(62),n(74),n(240),n(40),n(44);var r=n(662);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=l.length;function f(t){for(var e,n=t+1,r="";n>0;)e=(n-1)%c,r=String.fromCharCode(65+e)+r,n=parseInt((n-e)/c,10);return r}function d(label){var t=0;if(label)for(var i=0,e=label.length-1;i<label.length;i+=1,e-=1)t+=Math.pow(c,e)*(l.indexOf(label[i])+1);return t-=1}function h(){var i,t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(i=0;i<e;i++){var o=[];for(t=0;t<n;t++)o.push(f(t)+(i+1));r.push(o)}return r}function y(){var i,t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(i=0;i<e;i++){var o={};for(t=0;t<n;t++)o["prop".concat(t)]=f(t)+(i+1);r.push(o)}return r}function m(t,e){for(var n,data=[],i=0;i<t;i++){n=[];for(var r=0;r<e;r++)n.push("");data.push(n)}return data}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach((function(t,n){Array.isArray(t)?t.forEach((function(t,o){r.push([n+e,o,t])})):Object.keys(t).forEach((function(o){r.push([n+e,o,t[o]])}))})),r}function w(data){var t=0;return Array.isArray(data)&&(data[0]&&Array.isArray(data[0])?t=data[0].length:data[0]&&Object(r.isObject)(data[0])&&(t=Object(r.deepObjectSize)(data[0]))),t}function S(data){return!!(Array.isArray(data)&&data.length&&data.every((function(t){return Array.isArray(t)})))}function O(data){return!!(Array.isArray(data)&&data.length&&data.every((function(t){return"object"===o(t)&&!Array.isArray(t)&&null!==t})))}},762:function(t,e,n){"use strict";var r=n(7),o=n(22),l=n(142),c=o([].reverse),f=[1,2];r({target:"Array",proto:!0,forced:String(f)===String(f.reverse())},{reverse:function(){return l(this)&&(this.length=this.length),c(this)}})},763:function(t,e,n){"use strict";n.d(e,"b",(function(){return w})),n.d(e,"a",(function(){return S}));n(48),n(63),n(240),n(6),n(40),n(306),n(44),n(654),n(655),n(11),n(62),n(26),n(74),n(55),n(34),n(56),n(33);var r=n(727),o=n(690),l=n(664),c=n(696),f=n(681),d=n(671);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function y(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==h(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===h(o)?o:String(o)),n)}var r,o}var w="editorManager.navigation",S="editorManager.handlingEditor",O=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.tableMeta=n,this.selection=r,this.eventManager=new f.a(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(t){return o.onAfterDocumentKeyDown(t)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(t){!o.destroyed&&o.instance.isListening()&&o.openEditor("",t)})),this.instance.view._wt.update("onCellDblClick",(function(t,e,n){return o.onCellDblClick(t,e,n)}))}var e,n,h;return e=t,n=[{key:"registerShortcuts",value:function(){var t=this,e=this.instance.getShortcutManager(),n=e.getContext("grid"),r=e.getContext("editor"),l={group:S};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){t.closeEditorAndSaveChanges(e.isCtrlPressed()),t.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){t.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),t.activeEditor.focus()}}],l),n.addShortcuts([{keys:[["F2"]],callback:function(e){t.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){t.instance.emptySelectedCells(),t.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(e,n){t.instance.getSettings().enterBeginsEditing?t.cellProperties.readOnly?t.moveSelectionAfterEnter():t.openEditor(null,e,!0):t.moveSelectionAfterEnter(n.includes("shift")),Object(o.stopImmediatePropagation)(e)}}],l)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&t.prepareEditor()}));else{var e=this.instance.getSelectedRangeLast().highlight,n=e.row,col=e.col,r=this.instance.runHooks("modifyGetCellCoords",n,col),o=n,f=col;if(Array.isArray(r)){var d=y(r,2);o=d[0],f=d[1]}this.cellProperties=this.instance.getCellMeta(o,f);var h=this.instance.rootDocument.activeElement;if(h&&Object(l.isOutsideInput)(h)&&h.blur(),this.isCellEditable()){var td=this.instance.getCell(n,col,!0);if(td){var m=this.instance.getCellEditor(this.cellProperties),v=this.instance.colToProp(f),w=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),f);this.activeEditor=Object(c.b)(m,this.instance),this.activeEditor.prepare(n,col,v,td,w,this.cellProperties)}}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,o=r.row,col=r.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),c=this.instance.columnIndexMapper.getRenderableFromVisualIndex(col);this.instance.view.scrollViewport(this.instance._createCellCoords(l,c)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}else this.clearActiveEditor()}},{key:"closeEditor",value:function(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var t=this.instance.getCellEditor(this.cellProperties),e=this.instance.getSelectedRangeLast().highlight,n=e.row,col=e.col,r=this.instance,o=r.rowIndexMapper,l=r.columnIndexMapper,c=o.isHidden(this.instance.toPhysicalRow(n))||l.isHidden(this.instance.toPhysicalColumn(col));return!(this.cellProperties.readOnly||!t||c)}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=this;if(this.instance.isListening()){var n=t.keyCode;if(this.selection.isSelected()){var o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(Object(r.isFunctionKey)(n)||Object(r.isCtrlMetaKey)(n)||o||this.isEditorOpened())){var l=this.instance.getShortcutManager().getContext("editor"),c={runOnlyIf:function(){return Object(d.isDefined)(e.instance.getSelected())},group:w};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){e.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){e.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){e.instance.selection.transformStart(0,-1*e.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){e.instance.selection.transformStart(0,e.instance.getDirectionFactor())}}],c),this.openEditor("",t)}}}}},{key:"onCellDblClick",value:function(t,e,n){"TD"===n.nodeName&&this.openEditor(null,t,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}],n&&v(e.prototype,n),h&&v(e,h),Object.defineProperty(e,"prototype",{writable:!1}),t}(),C=new WeakMap;O.getInstance=function(t,e,n){var r=C.get(t);return r||(r=new O(t,e,n),C.set(t,r)),r},e.c=O},764:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));n(36),n(55),n(48),n(63),n(11),n(62),n(6),n(74),n(240),n(40),n(44),n(56),n(34),n(33);var r=n(663);function o(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function c(t,e,n){return[].concat(o(t.slice(0,e)),o(n),o(t.slice(e)))}function f(t,e){return Object(r.arrayFilter)(t,(function(t){return!1===e.includes(t)}))}},765:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n(55),n(654),n(655),n(11),n(62),n(6),n(26),n(74),n(240),n(40),n(44);var r=n(675),o=n(662),l=n(686),c=n(712);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==f(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===f(o)?o:String(o)),n)}var r,o}var h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.indexedValues=[],this.initValueOrFn=e}var e,n,o;return e=t,n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(t){var e=this.indexedValues;if(t<e.length)return e[t]}},{key:"setValues",value:function(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(l.isFunction)(this.initValueOrFn)?Object(r.rangeEach)(e-1,(function(e){return t.indexedValues.push(t.initValueOrFn(e))})):Object(r.rangeEach)(e-1,(function(){return t.indexedValues.push(t.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}],n&&d(e.prototype,n),o&&d(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(o.mixin)(h,c.a)},779:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n(240),n(243),n(6),n(40),n(44),n(102),n(11),n(62),n(74),n(55),n(34),n(56),n(33);var r=n(686);function o(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||c(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var d=function(t){return"The id '".concat(t,"' is already declared in a map.")};function h(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).errorIdExists,e=new Map;function n(){return o(e)}function c(t){return e.has(t)}return t=Object(r.isFunction)(t)?t:d,{addItem:function(n,r){if(c(n))throw new Error(t(n));e.set(n,r)},clear:function(){e.clear()},getId:function(t){var e=n().find((function(e){var n=l(e,2),r=n[0],element=n[1];return t===element&&r}))||[null];return l(e,1)[0]},getItem:function(t){return e.get(t)},getItems:n,hasItem:c,removeItem:function(t){return e.delete(t)}}}},780:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return l}));n(13),n(6);var r=n(663);function o(t,e){return Object(r.arrayMap)(t,(function(t){return t-e.filter((function(e){return e<t})).length}))}function l(t,e){var n=e[0],o=e.length;return Object(r.arrayMap)(t,(function(t){return t>=n?t+o:t}))}},781:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));n(417),n(418),n(6),n(130),n(668),n(16),n(654),n(655),n(11),n(62),n(26),n(74),n(240),n(40),n(44);var r=n(765),o=n(809);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=y(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},f.apply(this,arguments)}function d(t,p){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},d(t,p)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(m,t);var e,n,r,l=h(m);function m(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),l.apply(this,arguments)}return e=m,(n=[{key:"insert",value:function(t,e){this.indexedValues=Object(o.a)(this.indexedValues,t,e,this.initValueOrFn),f(y(m.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Object(o.b)(this.indexedValues,t),f(y(m.prototype),"remove",this).call(this,t)}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),m}(r.a)},782:function(t,e,n){"use strict";var r=n(7),o=n(937).left,l=n(248),c=n(166);r({target:"Array",proto:!0,forced:!n(205)&&c>79&&c<83||!l("reduce")},{reduce:function(t){var e=arguments.length;return o(this,t,e,e>1?arguments[1]:void 0)}})},807:function(t,e,n){"use strict";n(312)("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(425))},808:function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));n(240),n(6),n(40),n(306),n(44),n(11),n(62);var r=new WeakMap,o=Symbol("rootInstance");function l(object){r.set(object,!0)}function c(t){return t===o}function f(object){return r.has(object)}},809:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return d}));n(36),n(55),n(84),n(48),n(63),n(11),n(62),n(6),n(74),n(240),n(40),n(44),n(56),n(34),n(33);var r=n(686),o=n(663);function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function f(t,e,n,o){var c=n.length?n[0]:void 0;return[].concat(l(t.slice(0,c)),l(n.map((function(t,e){return Object(r.isFunction)(o)?o(t,e):o}))),l(void 0===c?[]:t.slice(c)))}function d(t,e){return Object(o.arrayFilter)(t,(function(t,n){return!1===e.includes(n)}))}},810:function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return y})),n.d(e,"c",(function(){return E})),n.d(e,"e",(function(){return T})),n.d(e,"f",(function(){return R})),n.d(e,"g",(function(){return k})),n.d(e,"d",(function(){return j}));n(11),n(62),n(6),n(48),n(63),n(240),n(679),n(40),n(44),n(56),n(308),n(74),n(55),n(34),n(33);var r=n(846),o=n(663),l=n(671);function c(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}var h=0,y=1,m=2,v=3,w=[v,m],S=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],O=Symbol("root"),C=Symbol("child");function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O;if(e!==O&&e!==C)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),o=e===O,l=h;if(n){var c=t[0];if(0===t.length)l=y;else if(o&&c instanceof r.a)l=v;else if(o&&Array.isArray(c))l=E(c,C);else if(t.length>=2&&t.length<=4){!t.some((function(t,e){return!S[e].includes(d(t))}))&&(l=m)}}return l}function T(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.keepDirection,r=void 0!==n&&n,o=e.propToCol;if(!w.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(e){var n=t===v,c=n?e.from.row:e[0],f=n?e.from.col:e[1],d=n?e.to.row:e[2],h=n?e.to.col:e[3];if("function"==typeof o&&("string"==typeof f&&(f=o(f)),"string"==typeof h&&(h=o(h))),Object(l.isUndefined)(d)&&(d=c),Object(l.isUndefined)(h)&&(h=f),!r){var y=c,m=f,w=d,S=h;c=Math.min(y,w),f=Math.min(m,S),d=Math.max(y,w),h=Math.max(m,S)}return[c,f,d,h]}}function R(t){var e=E(t);if(e===h||e===y)return[];var n=T(e),r=new Set;Object(o.arrayEach)(t,(function(t){var e=c(n(t),4),l=e[1],f=e[3],d=Math.max(l,0),h=f-d+1;Object(o.arrayEach)(Array.from(new Array(h),(function(t,i){return d+i})),(function(t){r.has(t)||r.add(t)}))}));var l=Array.from(r).sort((function(a,b){return a-b}));return Object(o.arrayReduce)(l,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[])}function k(t){var e=E(t);if(e===h||e===y)return[];var n=T(e),r=new Set;Object(o.arrayEach)(t,(function(t){var e=c(n(t),3),l=e[0],f=e[2],d=Math.max(l,0),h=f-d+1;Object(o.arrayEach)(Array.from(new Array(h),(function(t,i){return d+i})),(function(t){r.has(t)||r.add(t)}))}));var l=Array.from(r).sort((function(a,b){return a-b}));return Object(o.arrayReduce)(l,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[])}function j(t){return"number"==typeof t&&t>=0&&t<(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0)}},811:function(t,e,n){"use strict";n(240),n(6),n(40),n(306),n(44),n(654),n(655),n(11),n(62),n(26),n(74);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function l(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function c(t,e,n){return(e=f(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){var e=function(input,t){if("object"!==r(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===r(e)?e:String(e)}function d(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,y(t,e,"get"))}function h(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,y(t,e,"set"),n),n}function y(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var m=new WeakMap,v=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"row",null),c(this,"col",null),l(this,m,{writable:!0,value:!1}),h(this,m,r),void 0!==e&&void 0!==n&&(this.row=e,this.col=n)}var e,n,r;return e=t,(n=[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&(d(this,m)?this.col<=t.col:this.col>=t.col)}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&(d(this,m)?this.col>=t.col:this.col<=t.col)}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&(d(this,m)?this.col>=t.col:this.col<=t.col)}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&(d(this,m)?this.col<=t.col:this.col>=t.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,d(this,m))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&o(e.prototype,n),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=v},812:function(t,e,n){"use strict";n.r(e),n.d(e,"instanceToHTML",(function(){return d})),n.d(e,"_dataToHTML",(function(){return h})),n.d(e,"htmlToGridSettings",(function(){return y}));n(246),n(33),n(86),n(115),n(84),n(14),n(64),n(6),n(36),n(196),n(165),n(935),n(782),n(56),n(40),n(13),n(195),n(48),n(63),n(11),n(62),n(74),n(240),n(44),n(55),n(34);var r=n(671);function o(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var c={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},f=new RegExp(Object.keys(c).map((function(t){return"(".concat(t,")")})).join("|"),"gi");function d(t){for(var e=t.hasColHeaders(),n=t.hasRowHeaders(),o=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],data=t.getData.apply(t,o),l=data.length,c=l>0?data[0].length:0,f=["<table>","</table>"],d=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],y=n?1:0,m=e?1:0,v=0;v<l;v+=1){for(var w=e&&0===v,S=[],O=0;O<c;O+=1){var C=!w&&n&&0===O,E="";if(w)E="<th>".concat(t.getColHeader(O-y),"</th>");else if(C)E="<th>".concat(t.getRowHeader(v-m),"</th>");else{var T=data[v][O],R=t.getCellMeta(v-m,O-y),k=R.hidden,j=R.rowspan,x=R.colspan;if(!k){var A=[];if(j&&A.push('rowspan="'.concat(j,'"')),x&&A.push('colspan="'.concat(x,'"')),Object(r.isEmpty)(T))E="<td ".concat(A.join(" "),"></td>");else{var _=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");E="<td ".concat(A.join(" "),">").concat(_,"</td>")}}}S.push(E)}var I=["<tr>"].concat(S,["</tr>"]).join("");w?d.splice(1,0,I):h.splice(-1,0,I)}return f.splice(1,0,d.join(""),h.join("")),f.join("")}function h(input){for(var t=input.length,e=["<table>"],n=0;n<t;n+=1){var o=input[n],l=o.length,c=[];0===n&&e.push("<tbody>");for(var f=0;f<l;f+=1){var d=o[f],h=Object(r.isEmpty)(d)?"":d.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");c.push("<td>".concat(h,"</td>"))}e.push.apply(e,["<tr>"].concat(c,["</tr>"])),n+1===t&&e.push("</tbody>")}return e.push("</table>"),e.join("")}function y(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,e={},n=t.createDocumentFragment(),r=t.createElement("div");n.appendChild(r);var l=element;if("string"==typeof l){var d=l.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(t){var e=t.match(/<td\b[^>]*?>/g)[0],n=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(e).concat(n).concat("</td>")}));r.insertAdjacentHTML("afterbegin","".concat(d)),l=r.querySelector("table")}if(l&&function(element){return"TABLE"===(element&&element.nodeName||"")}(l)){var h,y=r.querySelector('meta[name$="enerator"]'),m=null!==l.querySelector("tbody th"),v=l.querySelector("tr"),w=v?Array.from(v.cells).reduce((function(t,e){return t+e.colSpan}),0)-(m?1:0):0,S=l.tFoot&&Array.from(l.tFoot.rows)||[],O=[],C=!1,E=0;if(l.tHead){var T=Array.from(l.tHead.rows).filter((function(tr){var t=null!==tr.querySelector("td");return t&&O.push(tr),!t}));C=(E=T.length)>0,E>1?e.nestedHeaders=Array.from(T).reduce((function(t,e){var n=Array.from(e.cells).reduce((function(t,header,e){if(m&&0===e)return t;var n=header.colSpan,r=header.innerHTML,o=n>1?{label:r,colspan:n}:r;return t.push(o),t}),[]);return t.push(n),t}),[]):C&&(e.colHeaders=Array.from(T[0].children).reduce((function(t,header,e){return m&&0===e||t.push(header.innerHTML),t}),[]))}O.length&&(e.fixedRowsTop=O.length),S.length&&(e.fixedRowsBottom=S.length);var R=[].concat(O,o(Array.from(l.tBodies).reduce((function(t,section){return t.push.apply(t,o(Array.from(section.rows))),t}),[])),o(S));h=R.length;for(var k=new Array(h),j=0;j<h;j++)k[j]=new Array(w);for(var x=[],A=[],_=0;_<h;_++)for(var tr=R[_],I=Array.from(tr.cells),M=I.length,N=0;N<M;N++){var P=I[N],H=P.nodeName,D=P.innerHTML,L=P.rowSpan,B=P.colSpan,col=k[_].findIndex((function(t){return void 0===t}));if("TD"===H){if(L>1||B>1){for(var V=_;V<_+L;V++)if(V<h)for(var F=col;F<col+B;F++)k[V][F]=null;var W=P.getAttribute("style");W&&W.includes("mso-ignore:colspan")||x.push({col:col,row:_,rowspan:L,colspan:B})}var U="";U=y&&/excel/gi.test(y.content)?D.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):D.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),k[_][col]=U.replace(f,(function(t){return c[t]}))}else A.push(D)}return x.length&&(e.mergeCells=x),A.length&&(e.rowHeaders=A),k.length&&(e.data=k),e}}},840:function(t,e,n){"use strict";var r=n(852),o=n(808),l=n(933),c=n(685),f=n(862),d=n(721),h=n(1047),y=n(996),m=n(811),v=n(846);function w(t,e){var n=new r.a(t,e||{},o.d);return n.init(),n}Object(d.d)(h.a),w.editors={BaseEditor:y.a},w.Core=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r.a(t,e,o.d)},w.DefaultSettings=Object(l.a)(),w.hooks=c.a.getSingleton(),w.CellCoords=m.a,w.CellRange=v.a,w.packageName="handsontable",w.buildDate="06/02/2023 12:34:58",w.version="12.3.1",w.languages={dictionaryKeys:f.a,getLanguageDictionary:f.b,getLanguagesDictionaries:f.c,registerLanguageDictionary:f.g,getTranslatedPhrase:f.d},e.a=w},841:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return y}));n(36),n(33),n(55),n(245);var r,o=n(671),l=n(662),c=n(689),f=n(687);function d(t,e){return Object(l.objectEach)(e,(function(e,n){Object(o.isUndefined)(t[n])&&(t[n]=e)})),t}function h(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?"".concat(e[1].toLowerCase(),"-").concat(e[2].toUpperCase()):t}function y(t){var e,n;Object(o.isDefined)(t)&&Object(c.a)(Object(f.a)(r||(e=['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],(n=['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])||(n=e.slice(0)),r=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))),t))}},842:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));n(417),n(418),n(6),n(130),n(668),n(16),n(654),n(655),n(11),n(62),n(26),n(74),n(240),n(40),n(44);var r=n(765),o=n(764),l=n(780);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==c(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=m(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},d.apply(this,arguments)}function h(t,p){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},h(t,p)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m(t);if(e){var o=m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(v,t);var e,n,r,c=y(v);function v(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),c.call(this,(function(t){return t}))}return e=v,(n=[{key:"insert",value:function(t,e){var n=Object(l.b)(this.indexedValues,e);this.indexedValues=Object(o.a)(n,t,e),d(m(v.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=Object(o.b)(this.indexedValues,t);this.indexedValues=Object(l.a)(e,t),d(m(v.prototype),"remove",this).call(this,t)}}])&&f(e.prototype,n),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),v}(r.a)},843:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));n(417),n(418),n(6),n(130),n(654),n(655),n(11),n(62),n(26),n(74),n(240),n(40),n(44);var r=n(781),o=n(663);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}function f(t,p){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},f(t,p)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(h,t);var e,n,r,l=d(h);function h(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),l.call(this,t)}return e=h,(n=[{key:"getHiddenIndexes",value:function(){return Object(o.arrayReduce)(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(r.a)},844:function(t,e,n){"use strict";n.d(e,"a",(function(){return T}));n(36),n(84),n(240),n(6),n(44),n(48),n(63),n(196),n(654),n(655),n(11),n(62),n(26),n(417),n(418),n(130),n(668),n(16),n(74),n(40),n(56),n(55),n(34),n(33);var r=n(765),o=n(809),l=n(764),c=n(780),f=n(686);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function h(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=C(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},v.apply(this,arguments)}function w(t,p){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},w(t,p)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=C(t);if(e){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}(this,n)}}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},C(t)}function E(t){var e=function(input,t){if("object"!==d(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===d(e)?e:String(e)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(y,t);var e,n,r,d=S(y);function y(){var t,e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return t=d.call.apply(d,[this].concat(l)),e=O(t),r=[],(n=E(n="orderOfIndexes"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return e=y,n=[{key:"getValues",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return t.indexedValues[e]}))}},{key:"setValues",value:function(t){this.orderOfIndexes=h(Array(t.length).keys()),v(C(y.prototype),"setValues",this).call(this,t)}},{key:"setValueAtIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(t){this.orderOfIndexes=Object(l.b)(this.orderOfIndexes,[t]),Object(f.isFunction)(this.initValueOrFn)?v(C(y.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn(t)):v(C(y.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,v(C(y.prototype),"setDefaultValues",this).call(this,t)}},{key:"insert",value:function(t,e){this.indexedValues=Object(o.a)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=Object(c.b)(this.orderOfIndexes,e),v(C(y.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Object(o.b)(this.indexedValues,t),this.orderOfIndexes=Object(l.b)(this.orderOfIndexes,t),this.orderOfIndexes=Object(c.a)(this.orderOfIndexes,t),v(C(y.prototype),"remove",this).call(this,t)}},{key:"getEntries",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return[e,t.getValueAtIndex(e)]}))}}],n&&m(e.prototype,n),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),y}(r.a)},845:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));n(417),n(418),n(6),n(130),n(654),n(655),n(11),n(62),n(26),n(74),n(240),n(40),n(44);var r=n(781),o=n(663);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}function f(t,p){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},f(t,p)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(h,t);var e,n,r,l=d(h);function h(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),l.call(this,t)}return e=h,(n=[{key:"getTrimmedIndexes",value:function(){return Object(o.arrayReduce)(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(r.a)},846:function(t,e,n){"use strict";n(48),n(63),n(666),n(240),n(6),n(40),n(306),n(44),n(654),n(655),n(11),n(62),n(26),n(74);var r=n(811);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function c(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function f(t,e,n){return(e=d(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){var e=function(input,t){if("object"!==o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===o(e)?e:String(e)}function h(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,m(t,e,"get"))}function y(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,m(t,e,"set"),n),n}function m(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var v=new WeakMap,w=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"highlight",null),f(this,"from",null),f(this,"to",null),c(this,v,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=n.clone(),this.to=r.clone(),y(this,v,o)}var e,n,o;return e=t,(n=[{key:"setHighlight",value:function(t){return this.highlight=t.clone().normalize(),this}},{key:"setFrom",value:function(t){return this.from=t.clone(),this}},{key:"setTo",value:function(t){return this.to=t.clone(),this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(t){var e=t.row,col=t.col,n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return n.row<=e&&r.row>=e&&n.col<=col&&r.col>=col}},{key:"includesRange",value:function(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=t.getOuterTopStartCorner(),l=t.getOuterBottomEndCorner(),c=Math.min(e.row,o.row),f=Math.min(e.col,o.col),d=Math.max(n.row,l.row),h=Math.max(n.col,l.col),y=this._createCellCoords(c,f),m=this._createCellCoords(d,h);return this.from=y,this.to=m,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return h(this,v)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return h(this,v)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return h(this,v)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return h(this,v)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return h(this,v)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return h(this,v)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return h(this,v)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return h(this,v)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof r.a))return!1;if(e){var n=e.from,o=e.to;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),l=Math.min(t.from.row,t.to.row),c=Math.max(t.from.row,t.to.row),f=Math.min(t.from.col,t.to.col),d=Math.max(t.from.col,t.to.col),h=[];return e===l&&h.push("top"),o===d&&h.push("right"),n===c&&h.push("bottom"),r===f&&h.push("left"),h}},{key:"getInner",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)t.row===r&&t.col===o?n.push(t):e.row===r&&e.col===o?n.push(e):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(t){for(var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++)if(!1===t(r,o))return}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,h(this,v))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(t,e){return new r.a(t,e,h(this,v))}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=w},847:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var r=1,o=2},852:function(t,e,n){"use strict";n.d(e,"a",(function(){return Xs}));n(11),n(62),n(74),n(34),n(245),n(240),n(6),n(679),n(40),n(44),n(48),n(308),n(196),n(691),n(26),n(55),n(36),n(420),n(84),n(33),n(64),n(56),n(666),n(762),n(12),n(54),n(930),n(243);var r=n(664),o=n(686),l=n(671),c=n(719),f=n(689),d=n(687),h=n(763),y=n(681),object=n(662),m=n(663),v=n(812),w=n(735),S=n(722),O=n(696),C=n(723),E=n(711),T=n(675),R=(n(306),n(654),n(655),n(690)),k=(n(417),n(418),n(130),n(726));function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function x(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==j(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===j(o)?o:String(o)),n)}var r,o}var A=new WeakMap,_=function(){function t(e,n,r,o,l,c){var f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wtSettings=r,this.domBindings=n,this.wtTable=l,this.selections=c,this.parent=f,this.eventManager=o,this.facadeGetter=e,A.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var e,n,f;return e=t,(n=[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(e){return t.onContextMenu(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(e){return t.onMouseOut(e)}));var e=function(){t.eventManager.addEventListener(t.wtTable.holder,"touchstart",(function(e){return t.onTouchStart(e)})),t.eventManager.addEventListener(t.wtTable.holder,"touchend",(function(e){return t.onTouchEnd(e)})),t.momentumScrolling||(t.momentumScrolling={}),t.eventManager.addEventListener(t.wtTable.holder,"scroll",(function(){clearTimeout(t.momentumScrolling._timeout),t.momentumScrolling.ongoing||t.wtSettings.getSetting("onBeforeTouchScroll"),t.momentumScrolling.ongoing=!0,t.momentumScrolling._timeout=setTimeout((function(){t.touchApplied||(t.momentumScrolling.ongoing=!1,t.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))};Object(c.isMobileBrowser)()?e():(Object(k.isTouchSupported)()&&e(),t.eventManager.addEventListener(t.wtTable.holder,"mouseup",(function(e){return t.onMouseUp(e)})),t.eventManager.addEventListener(t.wtTable.holder,"mousedown",(function(e){return t.onMouseDown(e)})))}},{key:"selectedCellWasTouched",value:function(t){var e=A.get(this),n=this.parentCell(t).coords;if(e.selectedCellBeforeTouchEnd&&n){var r=[n.row,e.selectedCellBeforeTouchEnd.from.row],o=r[0],l=r[1],c=[n.col,e.selectedCellBeforeTouchEnd.from.col];return o===l&&c[0]===c[1]}return!1}},{key:"parentCell",value:function(t){var e={},n=this.wtTable.TABLE,o=Object(r.closestDown)(t,["TD","TH"],n);return o?(e.coords=this.wtTable.getCoords(o),e.TD=o):Object(r.hasClass)(t,"wtBorder")&&Object(r.hasClass)(t,"current")?(e.coords=this.selections.getCell().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):Object(r.hasClass)(t,"wtBorder")&&Object(r.hasClass)(t,"area")&&this.selections.createOrGetArea().cellRange&&(e.coords=this.selections.createOrGetArea().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=A.get(this),n=this.domBindings.rootDocument.activeElement,l=Object(o.partial)(r.getParent,t.target),c=t.target;if(c!==n&&l(0)!==n&&l(1)!==n){var f=this.parentCell(c);Object(r.hasClass)(c,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,c):f.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,f.coords,f.TD),(0===t.button||this.touchApplied)&&f.TD&&(e.dblClickOrigin[0]=f.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((function(){e.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(t){if(this.wtSettings.has("onCellContextMenu")){var e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}},{key:"onMouseOver",value:function(t){if(this.wtSettings.has("onCellMouseOver")){var table=this.wtTable.TABLE,td=Object(r.closestDown)(t.target,["TD","TH"],table),e=this.parent||this;td&&td!==e.lastMouseOver&&Object(r.isChildOf)(td,table)&&(e.lastMouseOver=td,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(td),td))}}},{key:"onMouseOut",value:function(t){if(this.wtSettings.has("onCellMouseOut")){var table=this.wtTable.TABLE,e=Object(r.closestDown)(t.target,["TD","TH"],table),n=Object(r.closestDown)(t.relatedTarget,["TD","TH"],table);e&&e!==n&&Object(r.isChildOf)(e,table)&&this.callListener("onCellMouseOut",t,this.wtTable.getCoords(e),e)}}},{key:"onMouseUp",value:function(t){var e=A.get(this),n=this.parentCell(t.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,n.coords,n.TD),(0===t.button||this.touchApplied)&&(n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(Object(r.hasClass)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,n.coords,n.TD):this.callListener("onCellDblClick",t,n.coords,n.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((function(){e.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(t){A.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e,n=t.target,r=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,o=Object(l.isDefined)(r)&&r.row>=0&&r.col>=0;t.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")&&(Object(c.isIOS)()&&(Object(c.isChromeWebKit)()||Object(c.isFirefoxWebKit)())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}},{key:"callListener",value:function(t,e,n,r){var o=this.wtSettings.getSettingPure(t);o&&o(e,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var t=A.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}])&&x(e.prototype,n),f&&x(e,f),Object.defineProperty(e,"prototype",{writable:!1}),t}(),I=_,M=n(727);function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function P(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==N(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===N(o)?o:String(o)),n)}var r,o}var H=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&P(e.prototype,n),r&&P(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function L(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==D(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===D(o)?o:String(o)),n)}var r,o}var B=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&L(e.prototype,n),r&&L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),V=0;function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function W(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==F(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===F(o)?o:String(o)),n)}var r,o}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}])&&W(e.prototype,n),r&&W(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function G(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==z(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===z(o)?o:String(o)),n)}var r,o}var X=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.size=new U,this.workingSpace=V,this.sharedSize=null}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof U}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}])&&G(e.prototype,n),r&&G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Y(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==K(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===K(o)?o:String(o)),n)}var r,o}var $=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=e,this.nodesPool=n,this.sizeSet=new X,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,e=this.sizeSet,n=0;if(this.isSharedViewSet())for(var element=t.firstElementChild;element;){if(element.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(1))break;element=element.nextElementSibling}else n=t.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var t=this.rootNode,e=this.sizeSet,n=this.isSharedViewSet(),r=e.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var l=this.nodesPool();!n||n&&e.isPlaceOn(2)?t.appendChild(l):t.insertBefore(l,t.firstChild),o+=1}for(var c=n&&e.isPlaceOn(1);o>r;)t.removeChild(c?t.firstChild:t.lastChild),o-=1}},{key:"render",value:function(){var t=this.rootNode,e=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(n+=e.sharedSize.nextSize);var r=t.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();t.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}])&&Y(e.prototype,n),r&&Y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function J(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Q(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Q(o)?o:String(o)),n)}var r,o}function Z(t,p){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Z(t,p)}function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=et(t);if(e){var o=et(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function et(t){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},et(t)}var nt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z(t,e)}(l,t);var e,n,r,o=tt(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,(n=[{key:"prependView",value:function(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}])&&J(e.prototype,n),r&&J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}($);function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ot(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ot(o)?o:String(o)),n)}var r,o}var at=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodeType=e.toUpperCase()}var e,n,r;return e=t,(n=[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&it(e.prototype,n),r&&it(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function st(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==lt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===lt(o)?o:String(o)),n)}var r,o}var ut=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodesPool="string"==typeof e?new at(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}var e,n,r;return e=t,(n=[{key:"setTable",value:function(table){this.nodesPool&&this.nodesPool.setRootDocument(table.rootDocument),this.table=table}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&st(e.prototype,n),r&&st(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ft(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ct(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ct(o)?o:String(o)),n)}var r,o}function ht(t,p){return ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ht(t,p)}function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=yt(t);if(e){var o=yt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}var bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ht(t,e)}(l,t);var e,n,r,o=pt(l);function l(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,"TH")).orderViews=new WeakMap,t.sourceRowIndex=0,t}return e=l,(n=[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new nt(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.rowHeaderFunctions,r=t.rowHeadersCount,o=t.rows,l=t.cells,c=0;c<e;c++){var f=this.table.renderedRowToSource(c),d=o.getRenderedNode(c);this.sourceRowIndex=f;var h=this.obtainOrderView(d),y=l.obtainOrderView(d);h.appendView(y).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var m=0;m<r;m++){h.render();var v=h.getCurrentNode();v.className="",v.removeAttribute("style"),n[m](f,v,m)}h.end()}}}])&&ft(e.prototype,n),r&&ft(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ut);function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function vt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==mt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===mt(o)?o:String(o)),n)}var r,o}function gt(t,p){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},gt(t,p)}function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=St(t);if(e){var o=St(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}var Ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gt(t,e)}(c,t);var e,n,o,l=wt(c);function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,null,t)}return e=c,(n=[{key:"adjust",value:function(){var t=this.table,e=t.columnHeadersCount,n=t.rowHeadersCount,o=this.rootNode.firstChild;if(e){for(var l=this.table.columnsToRender+n,i=0,c=e;i<c;i++){for((o=this.rootNode.childNodes[i])||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<l;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>l;)o.removeChild(o.lastChild),this.renderedNodes-=1}var f=this.rootNode.childNodes.length;if(f>e)for(var d=e;d<f;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&Object(r.empty)(o)}},{key:"render",value:function(){for(var t=this.table.columnHeadersCount,e=0;e<t;e+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,l=n.rowHeadersCount,c=this.rootNode.childNodes[e],f=-1*l;f<o;f+=1){var d=this.table.renderedColumnToSource(f),h=c.childNodes[f+l];h.className="",h.removeAttribute("style"),r[e](d,h,e)}}}])&&vt(e.prototype,n),o&&vt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ut);function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function Et(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ct(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ct(o)?o:String(o)),n)}var r,o}function Tt(t,p){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Tt(t,p)}function Rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=kt(t);if(e){var o=kt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function kt(t){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kt(t)}var jt,xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tt(t,e)}(c,t);var e,n,o,l=Rt(c);function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,null,t)}return e=c,(n=[{key:"adjust",value:function(){for(var t=this.table,e=t.columnsToRender+t.rowHeadersCount;this.renderedNodes<e;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>e;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,o=0;o<n;o++){var l=this.table.renderedColumnToSource(o),c=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[o].style.width="".concat(c,"px")}for(var f=0;f<e;f++){var d=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(d);this.rootNode.childNodes[f+n].style.width="".concat(h,"px")}var y=this.rootNode.firstChild;y&&Object(r.addClass)(y,"rowHeader")}}])&&Et(e.prototype,n),o&&Et(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ut);function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function _t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==At(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===At(o)?o:String(o)),n)}var r,o}function It(t,p){return It=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},It(t,p)}function Mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Nt(t);if(e){var o=Nt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===At(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Nt(t){return Nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nt(t)}var Pt=!1,Ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&It(t,e)}(l,t);var e,n,r,o=Mt(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,"TR",t)).orderView=new $(t,(function(t){return e.nodesPool.obtain(t)}),e.nodeType),e}return e=l,(n=[{key:"getRenderedNode",value:function(t){return this.orderView.getNode(t)}},{key:"render",value:function(){var t,e,n=this.table.rowsToRender;!Pt&&n>1e3&&(Pt=!0,Object(f.b)(Object(d.a)(jt||(t=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],(e=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'])||(e=t.slice(0)),jt=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}})))))),this.orderView.setSize(n).setOffset(this.table.renderedRowToSource(0)).start();for(var r=0;r<n;r++)this.orderView.render();this.orderView.end()}}])&&_t(e.prototype,n),r&&_t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ut);function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Lt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Dt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Dt(o)?o:String(o)),n)}var r,o}function Bt(t,p){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Bt(t,p)}function Vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ft(t);if(e){var o=Ft(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}var Wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}(c,t);var e,n,o,l=Vt(c);function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this,"TD")).orderViews=new WeakMap,t.sourceRowIndex=0,t}return e=c,(n=[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new nt(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.columnsToRender,o=t.rows,l=t.rowHeaders,c=0;c<e;c++){var f=this.table.renderedRowToSource(c),d=o.getRenderedNode(c);this.sourceRowIndex=f;var h=this.obtainOrderView(d),y=l.obtainOrderView(d);h.prependView(y).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var m=0;m<n;m++){h.render();var v=h.getCurrentNode(),w=this.table.renderedColumnToSource(m);Object(r.hasClass)(v,"hide")||(v.className=""),v.removeAttribute("style"),v.removeAttribute("dir"),this.table.cellRenderer(f,w,v)}h.end()}}}])&&Lt(e.prototype,n),o&&Lt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ut);function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ut(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ut(o)?o:String(o)),n)}var r,o}var Gt=function(){function t(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cellRenderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}var e,n,r;return e=t,n=[{key:"setAxisUtils",value:function(t,e){this.rowUtils=t,this.columnUtils=e}},{key:"setViewportSize",value:function(t,e){this.rowsToRender=t,this.columnsToRender=e}},{key:"setFilters",value:function(t,e){this.rowFilter=t,this.columnFilter=e}},{key:"setHeaderContentRenderers",value:function(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.rowHeaders,n=t.columnHeaders,r=t.colGroup,o=t.rows,l=t.cells;e.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),l.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=l}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,e=this.rows,n=0;n<t;n++){var r=e.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),l=this.rowUtils.getHeight(o);r.firstChild.style.height=l?"".concat(l-1,"px"):""}}}}],n&&zt(e.prototype,n),r&&zt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Kt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Xt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Xt(o)?o:String(o)),n)}var r,o}var Yt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.TABLE,r=e.THEAD,o=e.COLGROUP,l=e.TBODY,c=e.rowUtils,f=e.columnUtils,d=e.cellRenderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=new Gt(n,{cellRenderer:d}),this.renderer.setRenderers({rowHeaders:new bt,columnHeaders:new Ot(r),colGroup:new xt(o),rows:new Ht(l),cells:new Wt}),this.renderer.setAxisUtils(c,f)}var e,n,r;return e=t,(n=[{key:"setFilters",value:function(t,e){return this.renderer.setFilters(t,e),this}},{key:"setViewportSize",value:function(t,e){return this.renderer.setViewportSize(t,e),this}},{key:"setHeaderContentRenderers",value:function(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&Kt(e.prototype,n),r&&Kt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function $t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==qt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===qt(o)?o:String(o)),n)}var r,o}var Qt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataAccessObject=e,this.wtSettings=n,this.headerWidths=new Map}var e,n,o;return e=t,(n=[{key:"getWidth",value:function(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(t){var e=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(t);if(e){var r=e.getStretchedColumnWidth(t,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(t){var e=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wtSettings,e=this.dataAccessObject,n=e.wtTable,o=e.wtViewport,l=e.cloneSource,c=l?l.wtTable.holder:n.holder,f=c.offsetHeight<c.scrollHeight?Object(r.getScrollbarWidth)():0,d=t.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-f),null!=(d=t.getSetting("onModifyRowHeaderWidth",d)))for(var h=t.getSetting("rowHeaders").length,y=t.getSetting("defaultColumnWidth"),m=0;m<h;m++){var v=Array.isArray(d)?d[m]:d;v=null==v?y:v,this.headerWidths.set(m,v)}}}])&&$t(e.prototype,n),o&&$t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Jt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Jt(o)?o:String(o)),n)}var r,o}var te=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataAccessObject=e,this.wtSettings=n}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){var e=this.wtSettings.getSetting("rowHeight",t),n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}}])&&Zt(e.prototype,n),r&&Zt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ee="top",ne="bottom",re="inline_start",oe="top_inline_start_corner",ie="bottom_inline_start_corner",ae=[ee,ne,re,oe,ie],le=new Map([[ee,"ht_clone_".concat(ee)],[ne,"ht_clone_".concat(ne)],[re,"ht_clone_".concat(re," ht_clone_left")],[oe,"ht_clone_".concat(oe," ht_clone_top_left_corner")],[ie,"ht_clone_".concat(ie," ht_clone_bottom_left_corner")]]);function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function ue(t){return function(t){if(Array.isArray(t))return de(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||fe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||fe(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(t,e){if(t){if("string"==typeof t)return de(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(t,e):void 0}}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function he(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ye(n.key),n)}}function pe(t,e,n){return(e=ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ye(t){var e=function(input,t){if("object"!==se(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===se(e)?e:String(e)}var be=function(){function t(e,n,o,l,c){var f=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pe(this,"wtSettings",null),pe(this,"domBindings",void 0),pe(this,"TBODY",null),pe(this,"THEAD",null),pe(this,"COLGROUP",null),pe(this,"hasTableHeight",!0),pe(this,"hasTableWidth",!0),pe(this,"isTableVisible",!1),pe(this,"tableOffset",0),pe(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===c,this.name=c,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=l,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,Object(r.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var d=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return f._modifyRowHeaderWidth(d)})),this.rowUtils=new te(this.dataAccessObject,this.wtSettings),this.columnUtils=new Qt(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Yt({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}var e,n,l;return e=t,n=[{key:"is",value:function(t){return this.name===t}},{key:"fixTableDomTree",value:function(){var t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(table){var t,e=table.parentNode;return e&&e.nodeType===Node.ELEMENT_NODE&&Object(r.hasClass)(e,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",e&&e.insertBefore(t,table),t.appendChild(table)),t.style.position="relative",t}},{key:"createHider",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r.hasClass)(n,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r.hasClass)(n,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),e.appendChild(t)),e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wtSettings,n=this.dataAccessObject,o=n.wtOverlays,l=n.wtViewport,c=e.getSetting("totalRows"),f=e.getSetting("totalColumns"),d=e.getSetting("rowHeaders"),h=d.length,y=e.getSetting("columnHeaders"),m=y.length,v=!1,w=t;if(this.isMaster&&(this.holderOffset=Object(r.offset)(this.holder),w=l.createRenderCalculators(w),h&&!e.getSetting("fixedColumnsStart"))){var S=o.inlineStartOverlay.getScrollPosition(),O=this.correctHeaderWidth;this.correctHeaderWidth=0!==S,O!==this.correctHeaderWidth&&(w=!1)}if(this.isMaster&&(v=o.updateStateOfRendering()),w)this.isMaster&&l.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Object(r.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var C=c>0?this.getFirstRenderedRow():0,E=f>0?this.getFirstRenderedColumn():0;this.rowFilter=new B(C,c,m),this.columnFilter=new H(E,f,h);var T,R=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),R=!0!==k.skipRender}if(R)if(this.tableRenderer.setHeaderContentRenderers(d,y),(this.is(ne)||this.is(ie))&&this.tableRenderer.setHeaderContentRenderers(d,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(T=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ne))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var j=Object(r.outerWidth)(this.hider),x=Object(r.outerWidth)(this.TABLE);0!==j&&x!==j&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),T!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ne)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}var A=!1;return this.isMaster&&(A=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(A=o.bottomOverlay.resetFixedPosition()||A),A=o.inlineStartOverlay.resetFixedPosition()||A,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),A?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(w),v&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(col){for(var t,e,n,o=this.columnFilter.renderedToSource(col),l=this.wtSettings.getSetting("columnHeaders").length,c=this.wtSettings.getSetting("defaultRowHeight"),f=this.wtSettings.getSetting("columnHeaderHeight")||[];l;)l-=1,t=this.getColumnHeaderHeight(l),(e=this.getColumnHeader(o,l))&&(n=Object(r.innerHeight)(e),(!t&&c<n||t<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=n),Array.isArray(f)?null!==f[l]&&void 0!==f[l]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=f[l]):isNaN(f)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=f),this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]<(f[l]||f)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=f[l]||f))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wtSettings,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=0,r=t.getSetting("columnHeaders").length;i<r;i++)if(n[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(ne))&&!t.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);e.oversizedRows&&e.oversizedRows[o]&&(e.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),i=0,n=e.length;i<n;i++)Object(r.removeClass)(e[i],t)}},{key:"refreshSelections",value:function(t){var e=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(t){for(var l=[],i=0;i<o;i++){for(var c=r[i].settings,f=c.highlightHeaderClassName,d=c.highlightRowClassName,h=c.highlightColumnClassName,y=r[i].classNames,m=y.length,v=0;v<m;v++)l.includes(y[v])||l.push(y[v]);f&&!l.includes(f)&&l.push(f),d&&!l.includes(d)&&l.push(d),h&&!l.includes(h)&&l.push(h)}var w=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(w))for(var S=0;S<w.length;S++)l.push(w[S]);for(var O=l.length,C=0;C<O;C++)this.removeClassFromCells(l[C])}for(var E=0;E<o;E++)r[E].draw(this.facadeGetter(),t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var o=ce(r,2);e=o[0],n=o[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var l=this.getRow(e);if(!l&&e>=0)throw new Error("TR was expected to be rendered but is not");var c=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!c&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return c}},{key:"getRow",value:function(t){var e,n,r=null,o=null;return t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(r=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceToRendered(t),o=this.TBODY),void 0!==r&&void 0!==o&&!(o.childNodes.length<r+1)&&o.childNodes[r]}},{key:"getColumnHeader",value:function(col){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=this.THEAD.childNodes[t];return null==e?void 0:e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}},{key:"getColumnHeaders",value:function(t){var e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((function(t){var r=t.childNodes[n];r&&e.push(r)})),e}},{key:"getRowHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)&&!(e>=this.wtSettings.getSetting("rowHeaders").length)){var n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return null==n?void 0:n.childNodes[e]}}},{key:"getRowHeaders",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var e=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],l=null==o?void 0:o.childNodes[r];l&&e.push(l)}return e}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Object(r.closest)(e,["TD","TH"])),null===e)return null;var n=e.parentNode,o=n.parentNode,l=Object(r.index)(n),col=e.cellIndex;return Object(r.overlayContainsElement)(oe,e,this.wtRootElement)||Object(r.overlayContainsElement)(ee,e,this.wtRootElement)?"THEAD"===o.nodeName&&(l-=o.childNodes.length):l=Object(r.overlayContainsElement)(ie,e,this.wtRootElement)||Object(r.overlayContainsElement)(ne,e,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-o.childNodes.length+l:o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(l):this.rowFilter.renderedToSource(l),col=Object(r.overlayContainsElement)(oe,e,this.wtRootElement)||Object(r.overlayContainsElement)(re,e,this.wtRootElement)||Object(r.overlayContainsElement)(ie,e,this.wtRootElement)?this.columnFilter.offsettedTH(col):this.columnFilter.visibleRowHeadedColumnToSourceColumn(col),this.wot.createCellCoords(l,col)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var t,e,n,o,l,c=this.TBODY.childNodes.length;if(c*this.wtSettings.getSetting("defaultRowHeight")!=Object(r.innerHeight)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;c;)c-=1,n=this.rowFilter.renderedToSource(c),t=this.getRowHeight(n),e=(l=(o=this.getTrForRow(n)).querySelector("th"))?Object(r.innerHeight)(l):Object(r.innerHeight)(o)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=e)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(t)<=e}},{key:"isRowHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(t)<=e}},{key:"isRowBeforeRenderedRows",value:function(t){var e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}},{key:"isRowAfterRenderedRows",value:function(t){return t>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(t){var e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Object(r.outerWidth)(this.TABLE)}},{key:"getHeight",value:function(){return Object(r.outerHeight)(this.TABLE)}},{key:"getTotalWidth",value:function(){var t=Object(r.outerWidth)(this.hider);return 0!==t?t:this.getWidth()}},{key:"getTotalHeight",value:function(){var t=Object(r.outerHeight)(this.hider);return 0!==t?t:this.getHeight()}},{key:"isVisible",value:function(){return Object(r.isVisible)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var e=Object(o.isFunction)(t)?t():null;return Array.isArray(e)?(e=ue(e))[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}],n&&he(e.prototype,n),l&&he(e,l),Object.defineProperty(e,"prototype",{writable:!1}),t}(),me=be,ve={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(object.defineGetter)(ve,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var ge=ve,we={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Object(object.defineGetter)(we,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var Se=we;function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function Ce(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Oe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Oe(o)?o:String(o)),n)}var r,o}function Ee(t,p){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ee(t,p)}function Te(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Re(t);if(e){var o=Re(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Re(t){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Re(t)}var ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ee(t,e)}(l,t);var e,n,r,o=Te(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,ee)}return e=l,n&&Ce(e.prototype,n),r&&Ce(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(me);Object(object.mixin)(ke,ge),Object(object.mixin)(ke,Se);var je=ke;function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Ae(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ie(n.key),n)}}function _e(t,e,n){return(e=Ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ie(t){var e=function(input,t){if("object"!==xe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===xe(e)?e:String(e)}var Me=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_e(this,"dataAccessObject",void 0),_e(this,"lastScrolledColumnPos",-1),_e(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}var e,n,o;return e=t,(n=[{key:"scrollViewport",value:function(t,e,n,r,o){var l=this.scrollViewportHorizontally(t.col,n,o),c=this.scrollViewportVertically(t.row,e,r);return l||c}},{key:"scrollViewportHorizontally",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,l=r.totalColumns;if(!o||!Number.isInteger(t)||t<0||t>l)return!1;var c=this.getFirstVisibleColumn(),f=this.getLastVisibleColumn(),d=void 0===e&&void 0===n,h=this.dataAccessObject,y=h.fixedColumnsStart,m=h.inlineStartOverlay;if(d&&t<y)return!1;var v=!1;return-1===c?v=m.scrollTo(t,d?t>this.lastScrolledColumnPos:e):(d&&(t<c||t>f)||!d)&&(v=m.scrollTo(t,d?t>f:e)),v&&(this.lastScrolledColumnPos=t),v}},{key:"scrollViewportVertically",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,l=r.totalRows;if(!o||!Number.isInteger(t)||t<0||t>l)return!1;var c=this.getFirstVisibleRow(),f=this.getLastVisibleRow(),d=void 0===e&&void 0===n,h=this.dataAccessObject,y=h.fixedRowsBottom,m=h.fixedRowsTop,v=h.topOverlay;if(d&&(t<m||t>l-y-1))return!1;var w=!1;return-1===c?w=v.scrollTo(t,d?t>this.lastScrolledRowPos:n):(d&&(t<c||t>f)||!d)&&(w=v.scrollTo(t,d?t>f:n)),w&&(this.lastScrolledRowPos=t),w}},{key:"getFirstVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalRows,c=t.fixedRowsTop,f=t.rootWindow,d=n.getFirstVisibleRow();if(e.mainTableScrollableElement===f){var h=Object(r.offset)(n.wtRootElement),y=Object(r.innerHeight)(n.hider),m=Object(r.innerHeight)(f),v=Object(r.getScrollTop)(f,f);if(h.top+y-m<=v){var w=o.getColumnHeaderHeight();w+=e.sumCellSizes(0,c);for(var S=l;S>0;S--)if(w+=e.sumCellSizes(S-1,S),h.top+y-w<=v){d=S;break}}}return d}},{key:"getLastVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalRows,c=t.rootWindow,f=n.getLastVisibleRow();if(e.mainTableScrollableElement===c){var d=Object(r.offset)(n.wtRootElement),h=Object(r.getScrollTop)(c,c);if(d.top>h)for(var y=Object(r.innerHeight)(c),m=o.getColumnHeaderHeight(),v=1;v<=l;v++)if(m+=e.sumCellSizes(v-1,v),d.top+m-h>=y){f=v-2;break}}return f}},{key:"getFirstVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalColumns,c=t.rootWindow,f=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===c){var d=Object(r.offset)(n.wtRootElement),h=Object(r.innerWidth)(n.hider),y=Object(r.innerWidth)(c),m=Math.abs(Object(r.getScrollLeft)(c,c));if(d.left+h-y<=m)for(var v=o.getRowHeaderWidth(),w=l;w>0;w--)if(v+=e.sumCellSizes(w-1,w),d.left+h-v<=m){f=w;break}}return f}},{key:"getLastVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalColumns,c=t.rootWindow,f=n.getLastVisibleColumn();if(e.mainTableScrollableElement===c){var d=Object(r.offset)(n.wtRootElement),h=Math.abs(Object(r.getScrollLeft)(c,c));if(d.left>h)for(var y=Object(r.innerWidth)(c),m=o.getRowHeaderWidth(),v=1;v<=l;v++)if(m+=e.sumCellSizes(v-1,v),d.left+m-h>=y){f=v-2;break}}return f}}])&&Ae(e.prototype,n),o&&Ae(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ne=n(811),Pe=n(846);function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function De(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Be(n.key),n)}}function Le(t,e,n){return(e=Be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Be(t){var e=function(input,t){if("object"!==He(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===He(e)?e:String(e)}var Ve=function(){function t(table,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Le(this,"wtTable",void 0),Le(this,"wtScroll",void 0),Le(this,"wtViewport",void 0),Le(this,"wtOverlays",void 0),Le(this,"selections",void 0),Le(this,"wtEvent",void 0),Le(this,"guid","wt_".concat(Object(E.randomString)())),Le(this,"drawInterrupted",!1),Le(this,"drawn",!1),Le(this,"domBindings",void 0),Le(this,"wtSettings",void 0),this.domBindings={rootTable:table,rootDocument:table.ownerDocument,rootWindow:table.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new Me(this.createScrollDao())}var e,n,o;return e=t,n=[{key:"eventManager",get:function(){return new y.a(this)}},{key:"findOriginalHeaders",value:function(){var t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Object(r.fastInnerText)(n,t[e])}])}}},{key:"createCellCoords",value:function(t,e){return new Ne.a(t,e,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(t,e,n){return new Pe.a(t,e,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);var e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=e-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>=e-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"scrollViewport",value:function(t,e,n,r,o){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}],n&&De(e.prototype,n),o&&De(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Fe(t){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fe(t)}function We(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ye(n.key),n)}}function Ue(t,p){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ue(t,p)}function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Xe(t);if(e){var o=Xe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Fe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ge(t)}(this,n)}}function Ge(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xe(t){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xe(t)}function Ke(t,e,n){return(e=Ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ye(t){var e=function(input,t){if("object"!==Fe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Fe(e)?e:String(e)}var qe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(l,t);var e,n,r,o=ze(l);function l(table,t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),Ke(Ge(n=o.call(this,table,t)),"cloneSource",void 0),Ke(Ge(n),"cloneOverlay",void 0);var r=n.wtSettings.getSetting("facade",Ge(n));return n.cloneSource=e.source,n.cloneOverlay=e.overlay,n.wtTable=n.cloneOverlay.createTable(n.getTableDao(),r,n.domBindings,n.wtSettings),n.wtViewport=e.viewport,n.selections=e.selections,n.wtEvent=new I(r,n.domBindings,n.wtSettings,n.eventManager,n.wtTable,n.selections,e.event),n.findOriginalHeaders(),n}return e=l,n&&We(e.prototype,n),r&&We(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ve);function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function Qe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Je(n.key),n)}}function Je(t){var e=function(input,t){if("object"!==$e(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===$e(e)?e:String(e)}var Ze=function(){function t(e,n,o,l,c){var f,d,h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f=this,h=null,(d=Je(d="wtSettings"))in f?Object.defineProperty(f,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):f[d]=h,Object(object.defineGetter)(this,"wot",e,{writable:!1}),this.domBindings=c,this.facadeGetter=n,this.wtSettings=l;var y=this.wot.wtTable,m=y.TABLE,v=y.hider,w=y.spreader,S=y.holder,O=y.wtRootElement;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=m,this.hider=v,this.spreader=w,this.holder=S,this.wtRootElement=O,this.trimmingContainer=Object(r.getTrimmingContainer)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}var e,n,o;return e=t,n=[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(r.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(r.getScrollableElement)(t.TABLE)}},{key:"getRelativeCellPosition",value:function(element,t,e){if(!1!==this.clone.wtTable.holder.contains(element)){var n=this.mainTableScrollableElement===this.domBindings.rootWindow,r=e<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(c),top:c.offsetTop},h={start:this.getRelativeStartPosition(element),top:element.offsetTop};return n?this.getRelativeCellPositionWithinWindow(o,r,h,d):this.getRelativeCellPositionWithinHolder(o,l,r,h,d)}Object(f.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,n,o){var l=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=0,f=0;if(e){var d=l.left;this.isRtl()&&(d=this.domBindings.rootWindow.innerWidth-(l.left+l.width+Object(r.getScrollbarWidth)())),c=d<=0?-1*d:0}else c=o.start;return f=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-l.top:o.top,{start:n.start+c,top:n.top+f}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,n,r,o){var l=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),c=this.wot.wtOverlays.topOverlay.getScrollPosition(),f=0,d=0;if(n||(f=l-o.start),e){var h=this.wot.wtTable.wtRootElement.getBoundingClientRect();d=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+h.top}else t||(d=c-o.top);return{start:r.start-f,top:r.top-d}}},{key:"makeClone",value:function(){if(-1===ae.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,o=e.rootWindow,l=n.createElement("DIV"),c=n.createElement("TABLE"),f=t.wtRootElement.parentNode;l.className="".concat(le.get(this.type)," handsontable"),l.setAttribute("dir",this.isRtl()?"rtl":"ltr"),l.style.position="absolute",l.style.top=0,l.style.overflow="visible",this.isRtl()?l.style.right=0:l.style.left=0,c.className=t.TABLE.className,l.appendChild(c),f.appendChild(l);var d=this.wtSettings.getSetting("preventOverflow");return!0===d||"horizontal"===d&&this.type===ee||"vertical"===d&&this.type===re?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(f).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=Object(r.getScrollableElement)(t.TABLE),new qe(c,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,o=t.parentNode.style;Object(m.arrayEach)([n,r,o],(function(style){style.width="",style.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}],n&&Qe(e.prototype,n),o&&Qe(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e,n){return en=ln()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&rn(r,n.prototype),r},en.apply(null,arguments)}function nn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,un(n.key),n)}}function rn(t,p){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},rn(t,p)}function on(t){var e=ln();return function(){var n,r=sn(t);if(e){var o=sn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return an(t)}(this,n)}}function an(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ln(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function sn(t){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sn(t)}function un(t){var e=function(input,t){if("object"!==tn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===tn(e)?e:String(e)}var cn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rn(t,e)}(c,t);var e,n,o,l=on(c);function c(t,e,n,r){var o,f,d,h;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o=l.call(this,t,e,ee,n,r),f=an(o),h=-1,(d=un(d="cachedFixedRowsTop"))in f?Object.defineProperty(f,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):f[d]=h,o.cachedFixedRowsTop=o.wtSettings.getSetting("fixedRowsTop"),o}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return en(je,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode,e=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),o=0,l=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)o=this.getScrollPosition(),Object(r.resetCssTransform)(t);else{var c=this.wot.wtTable.hider.getBoundingClientRect();l=Math.ceil(c.bottom)===t.offsetHeight,o=this.getOverlayOffset(),Object(r.setOverlayPosition)(t,"0px","".concat(o,"px"))}var f=this.adjustHeaderBordersPosition(o,l);return this.adjustElementsSize(),f}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Object(r.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wtSettings.getSetting("defaultRowHeight"),r=t,o=0;r<e;){var l=this.wot.wtTable.getRowHeight(r);o+=void 0===l?n:l,r+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,o=e.rootWindow,l=Object(r.getScrollbarWidth)(n),c=this.clone.wtTable.holder.parentNode.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===f){var d=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=l),d=Math.min(d,t.wtRootElement.scrollWidth),c.width="".concat(d,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var h=Object(r.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),c.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height="".concat(parseInt(e.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.wot,o=this.wtSettings,l=(n.cloneSource?n.cloneSource:n).wtTable.holder,c=this.getTableParentOffset(),f=0;if(e&&this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1),e&&l.offsetHeight!==l.clientHeight&&(f=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),e){var d=o.getSetting("fixedRowsBottom"),h=o.getSetting("totalRows");c+=this.sumCellSizes(0,t+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(h-d,h),c+=1}else c+=this.sumCellSizes(o.getSetting("fixedRowsTop"),t);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Object(r.removeClass)(n,"emptyColumns"):Object(r.addClass)(n,"emptyColumns");var o=!1;if(!e){var l=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,f=this.wtSettings.getSetting("columnHeaders");if((c||0===l)&&f.length>0){var d=Object(r.hasClass)(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(Object(r.addClass)(n,"innerBorderTop"),o=!d):(Object(r.removeClass)(n,"innerBorderTop"),o=d)}}return o}}],n&&nn(e.prototype,n),o&&nn(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze),fn={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(object.defineGetter)(fn,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var dn=fn;function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function pn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==hn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===hn(o)?o:String(o)),n)}var r,o}function yn(t,p){return yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},yn(t,p)}function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mn(t);if(e){var o=mn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===hn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function mn(t){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mn(t)}var vn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yn(t,e)}(l,t);var e,n,r,o=bn(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,ne)}return e=l,n&&pn(e.prototype,n),r&&pn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(me);Object(object.mixin)(vn,dn),Object(object.mixin)(vn,Se);var gn=vn;function wn(t){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(t)}function Sn(t,e,n){return Sn=Rn()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&Cn(r,n.prototype),r},Sn.apply(null,arguments)}function On(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jn(n.key),n)}}function Cn(t,p){return Cn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Cn(t,p)}function En(t){var e=Rn();return function(){var n,r=kn(t);if(e){var o=kn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===wn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Tn(t)}(this,n)}}function Tn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function kn(t){return kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kn(t)}function jn(t){var e=function(input,t){if("object"!==wn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==wn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===wn(e)?e:String(e)}var xn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cn(t,e)}(c,t);var e,n,o,l=En(c);function c(t,e,n,r){var o,f,d,h;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o=l.call(this,t,e,ne,n,r),f=Tn(o),h=-1,(d=jn(d="cachedFixedRowsBottom"))in f?Object.defineProperty(f,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):f[d]=h,o.cachedFixedRowsBottom=o.wtSettings.getSetting("fixedRowsBottom"),o}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Sn(gn,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.domBindings.rootWindow,e=this.clone.wtTable.holder.parentNode;e.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,o=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,c=0;n.hasVerticalScroll()||(c+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(c+=Object(r.getScrollbarWidth)(o)),l.style.bottom="".concat(c,"px")}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Object(r.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.getSetting("defaultRowHeight"),l=t,c=0;l<e;){var f=r.getRowHeight(l);c+=void 0===f?o:f,l+=1}return c}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,o=this.domBindings,l=o.rootDocument,c=o.rootWindow,f=Object(r.getScrollbarWidth)(l),d=this.clone.wtTable.holder.parentNode.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==c||"horizontal"===h){var y=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(y-=f),y=Math.min(y,e.wtRootElement.scrollWidth),d.width="".concat(y,"px")}else d.width="";this.clone.wtTable.holder.style.width=d.width;var m=Object(r.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(m=0),d.height="".concat(m,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=0;e&&o.offsetHeight!==o.clientHeight&&(l=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=l,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight(),o=r-this.clone.wtTable.getTotalHeight(),l=this.domBindings.rootDocument.documentElement.clientHeight;(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+r,0))>o&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,o=this.wtSettings.getSetting("columnHeaders"),l=!1;if((n||0===e)&&o.length>0){var c=this.wot.wtTable.holder.parentNode,f=Object(r.hasClass)(c,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Object(r.addClass)(c,"innerBorderBottom"),l=!f):(Object(r.removeClass)(c,"innerBorderBottom"),l=f)}return l}}],n&&On(e.prototype,n),o&&On(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze),An={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Object(object.defineGetter)(An,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var _n=An,In={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Object(object.defineGetter)(In,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var Mn=In;function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function Pn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Nn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Nn(o)?o:String(o)),n)}var r,o}function Hn(t,p){return Hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Hn(t,p)}function Dn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ln(t);if(e){var o=Ln(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Nn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ln(t){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ln(t)}var Bn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hn(t,e)}(l,t);var e,n,r,o=Dn(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,re)}return e=l,n&&Pn(e.prototype,n),r&&Pn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(me);Object(object.mixin)(Bn,_n),Object(object.mixin)(Bn,Mn);var Vn=Bn;function Fn(t){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(t)}function Wn(t,e,n){return Wn=Xn()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&zn(r,n.prototype),r},Wn.apply(null,arguments)}function Un(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Fn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Fn(o)?o:String(o)),n)}var r,o}function zn(t,p){return zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},zn(t,p)}function Gn(t){var e=Xn();return function(){var n,r=Kn(t);if(e){var o=Kn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Fn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Xn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Kn(t){return Kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kn(t)}var Yn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zn(t,e)}(c,t);var e,n,o,l=Gn(c);function c(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,t,e,re,n,r)}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Wn(Vn,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(!this.needFullRender||!t.holder.parentNode)return!1;var e=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer!==e||o&&"horizontal"===o?(l=this.getScrollPosition(),Object(r.resetCssTransform)(n)):(l=this.getOverlayOffset()*(this.isRtl()?-1:1),Object(r.setOverlayPosition)(n,"".concat(l,"px"),"0px"));var c=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),c}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Object(r.getWindowScrollTop)(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wtSettings.getSetting("defaultColumnWidth"),r=t,o=0;r<e;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,o=e.rootWindow,l=Object(r.getScrollbarWidth)(n),c=this.clone.wtTable.holder.parentNode.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===f){var d=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(d-=l),d=Math.min(d,t.wtRootElement.scrollHeight),c.height="".concat(d,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var h=Object(r.outerWidth)(this.clone.wtTable.TABLE);c.width="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width="".concat(parseInt(e.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=0;return e&&this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1),e&&o.offsetWidth!==o.clientWidth&&(l=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),n+=l,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Math.abs(Object(r.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;return this.trimmingContainer!==t||e&&"horizontal"===e||(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0),n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Object(r.removeClass)(e,"emptyRows"):Object(r.addClass)(e,"emptyRows");var l=!1;if(o&&!n.length)Object(r.addClass)(e,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){var c=Object(r.hasClass)(e,"innerBorderInlineStart");t?(Object(r.addClass)(e,"innerBorderLeft innerBorderInlineStart"),l=!c):(Object(r.removeClass)(e,"innerBorderLeft innerBorderInlineStart"),l=c)}return l}}],n&&Un(e.prototype,n),o&&Un(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze);function qn(t){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qn(t)}function $n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==qn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===qn(o)?o:String(o)),n)}var r,o}function Qn(t,p){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Qn(t,p)}function Jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zn(t);if(e){var o=Zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===qn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Zn(t){return Zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zn(t)}var er=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qn(t,e)}(l,t);var e,n,r,o=Jn(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,oe)}return e=l,n&&$n(e.prototype,n),r&&$n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(me);Object(object.mixin)(er,ge),Object(object.mixin)(er,Mn);var nr=er;function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function or(t,e,n){return or=ur()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&ar(r,n.prototype),r},or.apply(null,arguments)}function ir(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dr(n.key),n)}}function ar(t,p){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ar(t,p)}function lr(t){var e=ur();return function(){var n,r=cr(t);if(e){var o=cr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return sr(t)}(this,n)}}function sr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ur(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cr(t)}function fr(t,e,n){return(e=dr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dr(t){var e=function(input,t){if("object"!==rr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===rr(e)?e:String(e)}var pr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e)}(c,t);var e,n,o,l=lr(c);function c(t,e,n,r,o,f){var d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),fr(sr(d=l.call(this,t,e,oe,n,r)),"topOverlay",void 0),fr(sr(d),"inlineStartOverlay",void 0),d.topOverlay=o,d.inlineStartOverlay=f,d}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return or(nr,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();Object(r.setOverlayPosition)(t,"".concat(e,"px"),"".concat(n,"px"))}else Object(r.resetCssTransform)(t);var o=Object(r.outerHeight)(this.clone.wtTable.TABLE),l=Object(r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),t.style.height="".concat(o,"px"),t.style.width="".concat(l,"px"),!1}}],n&&ir(e.prototype,n),o&&ir(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze);function yr(t){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(t)}function mr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==yr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===yr(o)?o:String(o)),n)}var r,o}function vr(t,p){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},vr(t,p)}function gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wr(t);if(e){var o=wr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===yr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function wr(t){return wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wr(t)}var Sr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vr(t,e)}(l,t);var e,n,r,o=gr(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,ie)}return e=l,n&&mr(e.prototype,n),r&&mr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(me);Object(object.mixin)(Sr,dn),Object(object.mixin)(Sr,Mn);var Or=Sr;function Cr(t){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(t)}function Er(t,e,n){return Er=jr()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&Rr(r,n.prototype),r},Er.apply(null,arguments)}function Tr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Cr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Cr(o)?o:String(o)),n)}var r,o}function Rr(t,p){return Rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Rr(t,p)}function kr(t){var e=jr();return function(){var n,r=xr(t);if(e){var o=xr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function jr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function xr(t){return xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xr(t)}var Ar=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rr(t,e)}(c,t);var e,n,o,l=kr(c);function c(t,e,n,r,o,f){var d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(d=l.call(this,t,e,ie,n,r)).bottomOverlay=o,d.inlineStartOverlay=f,d}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Er(Or,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]="".concat(n,"px"),e.style.bottom="".concat(o,"px")}else Object(r.resetCssTransform)(e),this.repositionOverlay();var l=Object(r.outerHeight)(this.clone.wtTable.TABLE),c=Object(r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),e.style.height="".concat(l,"px"),e.style.width="".concat(c,"px"),!1}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,o=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,c=0;n.hasVerticalScroll()||(c+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(c+=Object(r.getScrollbarWidth)(o)),l.style.bottom="".concat(c,"px")}}],n&&Tr(e.prototype,n),o&&Tr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze);function _r(t){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(t)}function Ir(t,e,n){return Ir=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&Mr(r,n.prototype),r},Ir.apply(null,arguments)}function Mr(t,p){return Mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Mr(t,p)}function Nr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hr(n.key),n)}}function Pr(t,e,n){return(e=Hr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hr(t){var e=function(input,t){if("object"!==_r(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===_r(e)?e:String(e)}var Dr=function(){function t(e,n,o,l,c,f){var d=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Pr(this,"wot",null),Pr(this,"topOverlay",null),Pr(this,"bottomOverlay",null),Pr(this,"inlineStartOverlay",null),Pr(this,"topInlineStartCornerOverlay",null),Pr(this,"bottomInlineStartCornerOverlay",null),Pr(this,"browserLineHeight",void 0),Pr(this,"wtSettings",null),Pr(this,"resizeObserver",new ResizeObserver((function(t){Object(k.requestAnimationFrame)((function(){Array.isArray(t)&&t.length&&d.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=e,this.wtSettings=l,this.domBindings=o,this.facadeGetter=n,this.wtTable=f;var h=this.domBindings,y=h.rootDocument,m=h.rootWindow;this.instance=this.wot,this.eventManager=c,this.scrollbarSize=Object(r.getScrollbarWidth)(y);var v="hidden"===m.getComputedStyle(f.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=v?f.holder:Object(r.getScrollableElement)(f.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=m.scrollX,this.lastScrollY=m.scrollY}var e,n,o;return e=t,n=[{key:"getOverlays",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}},{key:"initBrowserLineHeight",value:function(){var t=this.domBindings,e=t.rootWindow,n=t.rootDocument,r=e.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),l=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||l}},{key:"initOverlays",value:function(){var t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Ir(cn,t),this.bottomOverlay=Ir(xn,t),this.inlineStartOverlay=Ir(Yn,t),this.topInlineStartCornerOverlay=Ir(pr,t.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Ir(Ar,t.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var t=this,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(e){return t.onKeyDown(e)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0}),o!==l&&this.eventManager.addEventListener(l,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0});var f,d=r.devicePixelRatio&&r.devicePixelRatio>1,h=this.scrollableElement===r,y=this.wtSettings.getSetting("preventWheel"),m={passive:h};(y||d||!Object(c.isChrome)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(e){return t.onCloneWheel(e,y)}),m),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((function(e){if(e&&e.needFullRender){var n=e.clone.wtTable.holder;t.eventManager.addEventListener(n,"wheel",(function(e){return t.onCloneWheel(e,y)}),m)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(f),f=setTimeout((function(){t.wtSettings.getSetting("onWindowResize")}),200)})),h||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(r!==e&&o!==e&&!t.target.contains(r)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,e){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,l=t.target,c=o!==n&&l!==n&&!l.contains(o),f=r!==n&&l!==n&&!l.contains(r);if(!this.keyPressed||!c&&!f){var d=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&d)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=Object(M.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);var r=this.scrollVertically(e),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(t){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.domBindings.rootWindow,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],l=r[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==l||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var c=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;c&&(c.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=Object(r.getScrollableElement)(t.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}},{key:"updateLastSpreaderSize",value:function(){var t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,r=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),r}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight(),f=n.hider.style;if(f.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,r),"px"),f.height="".concat(c+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var d=n.wtRootElement,h=d.scrollHeight,y=d.scrollWidth,m=n.holder,v=m.scrollHeight,w=m.scrollWidth;this.hasScrollbarRight=h<v,this.hasScrollbarBottom=y<w,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>y?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>h&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(element){if(!element)return null;var t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],e=null;return Object(m.arrayEach)(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(element)&&(e=t.clone)})),e}},{key:"syncOverlayTableClassNames",value:function(){var t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Object(m.arrayEach)(e,(function(e){e&&(e.clone.wtTable.TABLE.className=t.className)}))}}],n&&Nr(e.prototype,n),o&&Nr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Lr=Dr;function Br(t){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Br(t)}function Vr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wr(n.key),n)}}function Fr(t,e,n){return(e=Wr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wr(t){var e=function(input,t){if("object"!==Br(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Br(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Br(e)?e:String(e)}var Ur=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Fr(this,"settings",{}),Fr(this,"defaults",Object.freeze(this.getDefaults())),Object(object.objectEach)(this.defaults,(function(t,r){if(void 0!==e[r])n.settings[r]=e[r];else{if(void 0===t)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=t}}))}var e,n,o;return e=t,(n=[{key:"getDefaults",value:function(){var t=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return t.getSetting("fixedColumnsStart")>0||t.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return t.getSetting("fixedRowsTop")>0||t.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return t.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,n,o){var l=t.getSetting("data",e,n);Object(r.fastInnerText)(o,null==l?"":l)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(t){return t},onBeforeHighlightingColumnHeader:function(t){return t},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(t,e){var n=this;return void 0===e?Object(object.objectEach)(t,(function(t,e){n.settings[e]=t})):this.settings[t]=e,this}},{key:"getSetting",value:function(t,e,n,r,o){return"function"==typeof this.settings[t]?this.settings[t](e,n,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"getSettingPure",value:function(t){return this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}])&&Vr(e.prototype,n),o&&Vr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function zr(t){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zr(t)}function Gr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==zr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===zr(o)?o:String(o)),n)}var r,o}function Xr(t,p){return Xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Xr(t,p)}function Kr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yr(t);if(e){var o=Yr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===zr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Yr(t){return Yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yr(t)}var qr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xr(t,e)}(c,t);var e,n,o,l=Kr(c);function c(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,t,e,n,r,"master")}return e=c,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=Object(r.getTrimmingContainer)(this.wtRootElement),e=this.domBindings.rootWindow;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=t.parentElement,o=Object(r.getStyle)(t,"height",e),l=Object(r.getStyle)(t,"overflow",e),c=this.holder.style,f=t.scrollWidth,d=t.scrollHeight,h=t.getBoundingClientRect(),y=h.width,m=h.height;if(n&&["auto","hidden","scroll"].includes(l)){var v=t.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",t.nextElementSibling?n.insertBefore(v,t.nextElementSibling):n.appendChild(v);var w=parseInt(Object(r.getComputedStyle)(v,e).height,10);n.removeChild(v),0===w&&(m=0)}m=Math.min(m,d),c.height="auto"===o?"auto":"".concat(m,"px"),y=Math.min(y,f),c.width="".concat(y,"px"),c.overflow="",this.hasTableHeight="auto"===c.height||m>0,this.hasTableWidth=y>0}this.isTableVisible=Object(r.isVisible)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport,n="master",r=t.getSetting("columnHeaders").length;if(r&&!e.hasOversizedColumnHeadersMarked[n]){for(var o=t.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount(),i=0;i<r;i++)for(var c=-1*o;c<l;c++)this.markIfOversizedColumnHeader(c);e.hasOversizedColumnHeadersMarked[n]=!0}}}])&&Gr(e.prototype,n),o&&Gr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(me);Object(object.mixin)(qr,_n),Object(object.mixin)(qr,Se);var $r=qr,Qr=n(847),Jr=n(1050),Zr=n(1051);function to(t){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},to(t)}function eo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==to(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==to(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===to(o)?o:String(o)),n)}var r,o}var no=function(){function t(e,n,r,o,l){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=l,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){c.clientHeight=c.getWorkspaceHeight()}))}var e,n,o;return e=t,n=[{key:"getWorkspaceHeight",value:function(){var t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;return e===this.domBindings.rootWindow?t.documentElement.clientHeight:Object(r.outerHeight)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var t,e,n=this.wtSettings,o=this.domBindings,l=o.rootDocument,c=o.rootWindow,f=this.dataAccessObject.inlineStartOverlayTrimmingContainer,d=l.documentElement.offsetWidth,h=n.getSetting("totalColumns"),y=n.getSetting("preventOverflow"),m=n.getSetting("rtlMode"),v=this.wtTable.TABLE.getBoundingClientRect(),w=d-(m?v.right-d:v.left);if(y)return Object(r.outerWidth)(this.wtTable.wtRootElement);if(t=n.getSetting("freezeOverlays")?Math.min(w,d):Math.min(this.getContainerFillWidth(),w,d),f===c&&h>0&&this.sumColumnWidths(0,h-1)>t)return l.documentElement.clientWidth;if(f!==c&&("scroll"===(e=Object(r.getStyle)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",c))||"hidden"===e||"auto"===e))return Math.max(t,f.clientWidth);var S=n.getSetting("stretchH");return"none"!==S&&S?t:Math.max(t,Object(r.outerWidth)(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=0,r=t;r<e;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return Object(r.offset)(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(r.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var i=0,n=e.length;i<n;i++)this.rowHeaderWidth+=t[i]||t}if(isNaN(this.rowHeaderWidth))if(e.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,c=e.length;l<c;l++)o?(this.rowHeaderWidth+=Object(r.outerWidth)(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qr.b,l=this.wtSettings,c=this.wtTable;this.rowHeaderWidth=NaN,t=l.getSetting("renderAllRows")&&o===Qr.b?1/0:this.getViewportHeight();var f=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;f<0&&(f=0);var d=l.getSetting("fixedRowsTop"),h=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");return d&&(f+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,d),t-=n),h&&this.dataAccessObject.bottomOverlay.clone&&(t-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(y-h,y)),e=c.holder.clientHeight===c.holder.offsetHeight?0:Object(r.getScrollbarWidth)(this.domBindings.rootDocument),new Jr.a({viewportSize:t,scrollOffset:f,totalItems:l.getSetting("totalRows"),itemSizeFn:function(t){return c.getRowHeight(t)},overrideFn:l.getSettingPure("viewportRowCalculatorOverride"),calculationType:o,scrollbarHeight:e})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qr.b,e=this.wtSettings,n=this.wtTable,o=this.getViewportWidth(),l=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,l<0&&(l=0);var c=e.getSetting("fixedColumnsStart");if(c){var f=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,c);l+=f,o-=f}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),new Zr.a({viewportSize:o,scrollOffset:Math.abs(l),totalItems:e.getSetting("totalColumns"),itemSizeFn:function(t){return n.getColumnWidth(t)},overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:function(t,n){return e.getSetting("onBeforeStretchingColumnWidth",t,n)}})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){var e=this.createRowsCalculator(Qr.a),n=this.createColumnsCalculator(Qr.a);this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(Qr.b),this.columnsRenderCalculator=this.createColumnsCalculator(Qr.b)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Qr.a),this.columnsVisibleCalculator=this.createColumnsCalculator(Qr.a)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var e=t.startRow,n=t.endRow;if(null===e&&null===n)return!1;var r=this.rowsRenderCalculator,o=r.startRow,l=r.endRow;return!(e<o||e===o&&e>0||n>l||n===l&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var e=t.startColumn,n=t.endColumn;if(null===e&&null===n)return!1;var r=this.columnsRenderCalculator,o=r.startColumn,l=r.endColumn;return!(e<o||e===o&&e>0||n>l||n===l&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(object.objectEach)(this.hasOversizedColumnHeadersMarked,(function(t,e,object){object[e]=void 0}))}}],n&&eo(e.prototype,n),o&&eo(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ro=no;function oo(t){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oo(t)}function io(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==oo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==oo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===oo(o)?o:String(o)),n)}var r,o}function ao(t,p){return ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ao(t,p)}function lo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=uo(t);if(e){var o=uo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===oo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return so(t)}(this,n)}}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(t)}var co=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ao(t,e)}(c,t);var e,n,o,l=lo(c);function c(table,t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var n=(e=l.call(this,table,new Ur(t))).wtSettings.getSetting("facade",so(e));return e.wtTable=new $r(e.getTableDao(),n,e.domBindings,e.wtSettings),e.wtViewport=new ro(e.getViewportDao(),e.domBindings,e.wtSettings,e.eventManager,e.wtTable),e.selections=e.wtSettings.getSetting("selections"),e.wtEvent=new I(n,e.domBindings,e.wtSettings,e.eventManager,e.wtTable,e.selections),e.wtOverlays=new Lr(so(e),n,e.domBindings,e.wtSettings,e.eventManager,e.wtTable),e.exportSettingsAsClassNames(),e.findOriginalHeaders(),e}return e=c,(n=[{key:"exportSettingsAsClassNames",value:function(){var t=this,e=[],n=[];Object(object.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,o){t.wtSettings.getSetting(o).length&&n.push(r),e.push(r)})),Object(r.removeClass)(this.wtTable.wtRootElement.parentNode,e),Object(r.addClass)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getViewportDao",value:function(){var t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}])&&io(e.prototype,n),o&&io(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ve);function fo(t){return fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(t)}function ho(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==fo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==fo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===fo(o)?o:String(o)),n)}var r,o}var po=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e instanceof Ve?this._wot=e:this._initFromSettings(e)}var e,n,r;return e=t,n=[{key:"_initFromSettings",value:function(e){e.facade=function(e){var n=new t(e);return function(){return n}},this._wot=new co(e.table,e)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(t){this._wot.drawn=t}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(t){this._wot.drawInterrupted=t}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(t){this._wot.lastMouseOver=t}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(t){this._wot.momentumScrolling=t}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(t){this._wot.touchApplied=t}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(t){this._wot.eventListeners=t}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(t,e){return this._wot.createCellCoords(t,e)}},{key:"createCellRange",value:function(t,e,n){return this._wot.createCellRange(t,e,n)}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wot.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(t,e){return this._wot.wtSettings.update(t,e),this}},{key:"getSetting",value:function(t,e,n,r,o){return this._wot.wtSettings.getSetting(t,e,n,r,o)}},{key:"hasSetting",value:function(t){return this._wot.wtSettings.hasSetting(t)}},{key:"destroy",value:function(){this._wot.destroy()}}],n&&ho(e.prototype,n),r&&ho(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function yo(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,o=t.coords,l=t.selection,c=t.controller,f=t.cellCoordsFactory,d=l.isSelected()?l.getSelectedRange().current():null,h=l.isSelectedByCorner(),y=l.isSelectedByRowHeader();if(e&&d)o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(o):(h||y)&&o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(f(o.row,o.col)):h&&o.row<0&&!c.column?l.setRangeEnd(f(d.to.row,o.col)):y&&o.col<0&&!c.row?l.setRangeEnd(f(o.row,d.to.col)):(!h&&!y&&o.col<0||h&&o.col<0)&&!c.row?l.selectRows(Math.max(d.from.row,0),o.row,o.col):(!h&&!y&&o.row<0||y&&o.row<0)&&!c.column&&l.selectColumns(Math.max(d.from.col,0),o.col,o.row);else{var m=!l.inInSelection(o),v=n||r&&m;o.row<0&&o.col>=0&&!c.column?v&&l.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!c.row?v&&l.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!c.cell?v&&l.setRangeStart(o):o.col<0&&o.row<0&&l.selectAll(!0,!0)}}var bo=new Map([["mousedown",yo],["mouseover",function(t){var e=t.isLeftClick,n=t.coords,r=t.selection,o=t.controller,l=t.cellCoordsFactory;if(e){var c=r.isSelectedByRowHeader(),f=r.isSelectedByColumnHeader(),d=r.tableProps.countCols(),h=r.tableProps.countRows();f&&!o.column?r.setRangeEnd(l(h-1,n.col)):c&&!o.row?r.setRangeEnd(l(n.row,d-1)):o.cell||r.setRangeEnd(n)}}],["touchstart",yo]]);function mo(t,e){var n=e.coords,r=e.selection,o=e.controller,l=e.cellCoordsFactory;bo.get(t.type)({coords:n,selection:r,controller:o,cellCoordsFactory:l,isShiftKey:t.shiftKey,isLeftClick:Object(R.isLeftClick)(t)||"touchstart"===t.type,isRightClick:Object(R.isRightClick)(t)})}var vo=n(808);function go(t){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(t)}function wo(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||Oo(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function So(t){return function(t){if(Array.isArray(t))return Co(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Oo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oo(t,e){if(t){if("string"==typeof t)return Co(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Co(t,e):void 0}}function Co(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Eo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ko(n.key),n)}}function To(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Ro(t,e,n){return(e=ko(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ko(t){var e=function(input,t){if("object"!==go(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===go(e)?e:String(e)}function jo(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ao(t,e,"get"))}function xo(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Ao(t,e,"set"),n),n}function Ao(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var _o=new WeakMap,Io=new WeakMap,Mo=new WeakMap,No=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ro(this,"instance",void 0),Ro(this,"eventManager",void 0),Ro(this,"settings",void 0),Ro(this,"THEAD",void 0),Ro(this,"TBODY",void 0),Ro(this,"_wt",void 0),Ro(this,"activeWt",void 0),To(this,Io,{writable:!0,value:0}),To(this,Mo,{writable:!0,value:0}),Ro(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new y.a(this.instance),this.settings=this.instance.getSettings(),_o.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var e,n,o;return e=t,n=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}},{key:"getCellAtCoords",value:function(t,e){var td=this._wt.getCell(t,e);return td<0?null:td}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wt.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}},{key:"createElements",value:function(){var t=_o.get(this),e=this.instance,n=e.rootElement,o=e.rootDocument,l=n.getAttribute("style");l&&n.setAttribute("data-originalstyle",l),Object(r.addClass)(n,"handsontable"),t.table=o.createElement("TABLE"),Object(r.addClass)(t.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r.addClass)(t.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=_o.get(this),n=this.instance,o=n.rootElement,l=n.rootDocument,c=n.selection,f=l.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(n.target)){var o=t.instance.rootWindow;Object(r.clearTextSelection)(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){e.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){e.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(t.settings.fragmentSelection&&Object(r.clearTextSelection)(t.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(f,"keyup",(function(t){c.isInProgress()&&!t.shiftKey&&c.finish()})),this.eventManager.addEventListener(f,"mouseup",(function(n){c.isInProgress()&&Object(R.isLeftClick)(n)&&c.finish(),e.mouseDown=!1,!Object(r.isOutsideInput)(l.activeElement)&&(c.isSelected()||c.isSelectedByAnyHeader()||o.contains(n.target)||Object(R.isRightClick)(n))||t.instance.unlisten()})),this.eventManager.addEventListener(f,"contextmenu",(function(t){c.isInProgress()&&Object(R.isRightClick)(t)&&(c.finish(),e.mouseDown=!1)})),this.eventManager.addEventListener(f,"touchend",(function(){c.isInProgress()&&c.finish(),e.mouseDown=!1})),this.eventManager.addEventListener(f,"mousedown",(function(n){var c=n.target,d=n.x||n.clientX,h=n.y||n.clientY,y=n.target;if(!e.mouseDown&&o&&t.instance.view){var m=t.instance.view._wt.wtTable.holder;if(y===m){var v=Object(r.getScrollbarWidth)(l);if(l.elementFromPoint(d+v,h)!==m||l.elementFromPoint(d,h+v)!==m)return}else for(;y!==f;){if(null===y){if(n.isTargetWebComponent)break;return}if(y===o)return;y=y.parentNode}("function"==typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(c):t.settings.outsideClickDeselects)?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(e.table,"selectstart",(function(e){t.settings.fragmentSelection||Object(r.isInput)(e.target)||e.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(t){var e,n=t.row,col=t.col;return(e=this.instance)._createCellCoords.apply(e,So(this.translateFromRenderableToVisualIndex(n,col)))}},{key:"translateFromRenderableToVisualIndex",value:function(t,e){var n=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===r&&(r=e),[n,r]}},{key:"countRenderableIndexes",value:function(t,e){var n=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(n-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(t,e,n,r){if(isNaN(t)||t<0)return 0;var o=n.getNearestNotHiddenIndex(t,e),l=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(l))return 0;var c=0;return e<0?c=l+1:e>0&&(c=r-l),c}},{key:"countNotHiddenFixedColumnsStart",value:function(){var t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var t=this.instance.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}},{key:"initializeWalkontable",value:function(){var t=this,e=_o.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:function(){return Object(vo.b)(t.instance)},preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:function(e,n){var r;return(r=t.instance).getDataAtCell.apply(r,So(t.translateFromRenderableToVisualIndex(e,n)))},totalRows:function(){return t.countRenderableRows()},totalColumns:function(){return t.countRenderableColumns()},fixedColumnsStart:function(){return t.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return t.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return t.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return t.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return t.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return t.settings.fixedRowsBottom>0},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;t.appendRowHeader(r,n)})),t.instance.runHooks("afterGetRowHeaderRenderers",e),xo(t,Mo,e.length),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;t.appendColHeader(r,n)})),t.instance.runHooks("afterGetColumnHeaderRenderers",e),xo(t,Io,e.length),e},columnWidth:function(e){var n=t.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getColWidth(null===n?e:n)},rowHeight:function(e){var n=t.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getRowHeight(null===n?e:n)},cellRenderer:function(e,n,r){var o=wo(t.translateFromRenderableToVisualIndex(e,n),2),l=o[0],c=o[1],f=t.instance.runHooks("modifyGetCellCoords",l,c),d=l,h=c;if(Array.isArray(f)){var y=wo(f,2);d=y[0],h=y[1]}var m=t.instance.getCellMeta(d,h),v=t.instance.colToProp(h),w=t.instance.getDataAtRowProp(d,v);t.instance.hasHook("beforeValueRender")&&(w=t.instance.runHooks("beforeValueRender",w,m)),t.instance.runHooks("beforeRenderer",r,l,c,v,w,m),t.instance.getCellRenderer(m)(t.instance,r,l,c,v,w,m),t.instance.runHooks("afterRenderer",r,l,c,v,w,m)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onContainerElementResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,l){var c=t.translateFromRenderableToVisualCoords(r),f={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=l,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",n,c,o,f),Object(R.isImmediatePropagationStopped)(n)||(mo(n,{coords:c,selection:t.instance.selection,controller:f,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseDown",n,c,o),t.activeWt=t._wt)},onCellContextMenu:function(n,r,o,l){var c=t.translateFromRenderableToVisualCoords(r);t.activeWt=l,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",n,c,o),Object(R.isImmediatePropagationStopped)(n)||(t.instance.runHooks("afterOnCellContextMenu",n,c,o),t.activeWt=t._wt)},onCellMouseOut:function(e,n,r,o){var l=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,l,r),Object(R.isImmediatePropagationStopped)(e)||(t.instance.runHooks("afterOnCellMouseOut",e,l,r),t.activeWt=t._wt)},onCellMouseOver:function(n,r,o,l){var c=t.translateFromRenderableToVisualCoords(r),f={row:!1,column:!1,cell:!1};t.activeWt=l,t.instance.runHooks("beforeOnCellMouseOver",n,c,o,f),Object(R.isImmediatePropagationStopped)(n)||(e.mouseDown&&mo(n,{coords:c,selection:t.instance.selection,controller:f,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseOver",n,c,o),t.activeWt=t._wt)},onCellMouseUp:function(e,n,r,o){var l=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,l,r),Object(R.isImmediatePropagationStopped)(e)||t.instance.isDestroyed||(t.instance.runHooks("afterOnCellMouseUp",e,l,r),t.activeWt=t._wt)},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,n){return t.beforeRender(e,n)},onDraw:function(e){return t.afterRender(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(e,n,r){var o=t.instance.rowIndexMapper,l=o.getVisualFromRenderableIndex(e),c=t.instance.runHooks("beforeHighlightingRowHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:function(e,n,r){var o=t.instance.columnIndexMapper,l=o.getVisualFromRenderableIndex(e),c=t.instance.runHooks("beforeHighlightingColumnHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:function(e,n,r){var o,l=wo(t.translateFromRenderableToVisualIndex(e,n),2),c=l[0],f=l[1],d=t.instance.selection.getSelectedRange(),h=d.size();if(h>0){var y=(null!=r?r:0)+1-h,m=d.peekByIndex(y);o=[m.from.row,m.from.col,m.to.row,m.to.col]}return t.instance.runHooks("afterDrawSelection",c,f,o,r)},onBeforeDrawBorders:function(e,n){var r=wo(e,4),o=r[0],l=r[1],c=r[2],f=r[3],d=[t.instance.rowIndexMapper.getVisualFromRenderableIndex(o),t.instance.columnIndexMapper.getVisualFromRenderableIndex(l),t.instance.rowIndexMapper.getVisualFromRenderableIndex(c),t.instance.columnIndexMapper.getVisualFromRenderableIndex(f)];return t.instance.runHooks("beforeDrawBorders",d,n)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){var r=t.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return t.instance.runHooks("beforeStretchingColumnWidth",e,r)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,r){var o=t.instance.rowIndexMapper,l=t.instance.columnIndexMapper,c=n>=0?l.getVisualFromRenderableIndex(n):n,f=e>=0?o.getVisualFromRenderableIndex(e):e,d=t.instance.runHooks("modifyGetCellCoords",f,c,r);if(Array.isArray(d)){var h=wo(d,4),y=h[0],m=h[1],v=h[2],w=h[3];return[y>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,1)):y,m>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(m,1)):m,v>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(v,-1)):v,w>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:function(e){var n=t.settings.viewportRowRenderingOffset;if("auto"===n&&t.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=t.countRenderableRows(),o=e.startRow,l=e.endRow;if("number"==typeof n)e.startRow=Math.max(o-n,0),e.endRow=Math.min(l+n,r-1);else if("auto"===n){var c=Math.ceil(l/r*12);e.startRow=Math.max(o-c,0),e.endRow=Math.min(l+c,r-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var n=t.settings.viewportColumnRenderingOffset;if("auto"===n&&t.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=t.countRenderableColumns(),o=e.startColumn,l=e.endColumn;if("number"==typeof n&&(e.startColumn=Math.max(o-n,0),e.endColumn=Math.min(l+n,r-1)),"auto"===n){var c=Math.ceil(l/r*6);e.startColumn=Math.max(o-c,0),e.endColumn=Math.min(l+c,r-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new po(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),l=o.width,c=o.height;this.setLastSize(l,c),this.eventManager.addEventListener(r,"mousedown",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){t.settings.observeDOMVisibility&&t._wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())}))}},{key:"isTextSelectionAllowed",value:function(t){if(Object(r.isInput)(t))return!0;var e=Object(r.isChildOf)(t,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return _o.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&void 0!==t&&t}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}},{key:"afterRender",value:function(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;if(!Object(r.hasClass)(n,"relative"))return Object(r.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var o=this.instance,l=o.rootDocument,c=o.getRowHeader,div=l.createElement("div"),span=l.createElement("span");div.className="relative",span.className="rowHeader",this.updateCellHeader(span,t,c),div.appendChild(span),e.appendChild(div)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){var label=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){var o=e.firstChild;Object(r.hasClass)(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,label,n):(Object(r.empty)(e),this.appendColHeader(t,e,label,n))}else{var l=this.instance.rootDocument,div=l.createElement("div"),span=l.createElement("span");div.className="relative",span.className="colHeader",this.updateCellHeader(span,t,label,n),div.appendChild(span),e.appendChild(div)}this.instance.runHooks("afterGetColHeader",t,e,n)}},{key:"updateCellHeader",value:function(element,t,content){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=t,o=this._wt.wtOverlays.getParentOverlay(element)||this._wt;element.parentNode&&(Object(r.hasClass)(element,"colHeader")?n=o.wtTable.columnFilter.sourceToRendered(t):Object(r.hasClass)(element,"rowHeader")&&(n=o.wtTable.rowFilter.sourceToRendered(t))),n>-1?Object(r.fastInnerHTML)(element,content(t,e)):(Object(r.fastInnerText)(element,String.fromCharCode(160)),Object(r.addClass)(element,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}},{key:"setLastSize",value:function(t,e){var n=_o.get(this),r=[t,e];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var t=_o.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return jo(this,Io)}},{key:"getRowHeadersCount",value:function(){return jo(this,Mo)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}],n&&Eo(e.prototype,n),o&&Eo(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Po=No,Ho=n(737);function Do(t){return Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(t)}function Lo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Do(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Do(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Do(o)?o:String(o)),n)}var r,o}var Bo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var e,n,r;return e=t,n=[{key:"modifyRowData",value:function(t){var e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}},{key:"setData",value:function(data){this.data=data}},{key:"getAtColumn",value:function(t){var e=this,n=[];return Object(m.arrayEach)(this.data,(function(r,o){var l=e.getAtCell(o,t);n.push(l)})),n}},{key:"getAtRow",value:function(t,e,n){var r=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=void 0===e&&void 0===n,f=null,d=null;if(f=this.modifyRowData(t),Array.isArray(f))d=[],c?f.forEach((function(e,n){d[n]=r.getAtPhysicalCell(t,n,f)})):Object(T.rangeEach)(e,n,(function(n){d[n-e]=r.getAtPhysicalCell(t,n,f)}));else if(Object(object.isObject)(f)||Object(o.isFunction)(f))if(d=l?[]:{},!c||l){var h=this.countFirstRowKeys()-1;Object(T.rangeEach)(0,h,(function(o){var c=r.colToProp(o);if(o>=(e||0)&&o<=(n||h)&&!Number.isInteger(c)){var y=r.getAtPhysicalCell(t,c,f);l?d.push(y):Object(object.setProperty)(d,c,y)}}))}else Object(object.objectEach)(f,(function(e,n){Object(object.setProperty)(d,n,r.getAtPhysicalCell(t,n,f))}));return d}},{key:"setAtCell",value:function(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=Object(object.createObjectPropListener)(n);this.hot.runHooks("modifySourceData",t,this.propToCol(e),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(e)?this.data[t][e]=n:Object(object.setProperty)(this.data[t],e,n)}}},{key:"getAtPhysicalCell",value:function(t,e,n){var r=null;if(n&&(r="string"==typeof e?Object(object.getProperty)(n,e):"function"==typeof e?e(n):n[e]),this.hot.hasHook("modifySourceData")){var o=Object(object.createObjectPropListener)(r);this.hot.runHooks("modifySourceData",t,this.colToProp(e),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(t,e){var n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}},{key:"getByRange",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,l=null,c=null,f=null,d=null;null===e||null===n?(o=!0,l=0,f=this.countRows()-1):(l=Math.min(e.row,n.row),c=Math.min(e.col,n.col),f=Math.max(e.row,n.row),d=Math.max(e.col,n.col));var h=[];return Object(T.rangeEach)(l,f,(function(e){h.push(o?t.getAtRow(e,void 0,void 0,r):t.getAtRow(e,c,d,r))})),h}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Object(Ho.countFirstRowKeys)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],n&&Lo(e.prototype,n),r&&Lo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Vo=Bo,Fo=(n(195),n(13),n(63),n(842)),Wo=n(843),Uo=n(765),zo=n(844),Go=n(781),Xo=n(845),Ko=new Map([["hiding",Wo.a],["index",Uo.a],["linkedPhysicalIndexToValue",zo.a],["physicalIndexToValue",Go.a],["trimming",Xo.a]]);var Yo=n(764),qo=n(934);function $o(t){return $o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o(t)}function Qo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==$o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===$o(o)?o:String(o)),n)}var r,o}function Jo(t,p){return Jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Jo(t,p)}function Zo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ti(t);if(e){var o=ti(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===$o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function ti(t){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ti(t)}var ei=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jo(t,e)}(c,t);var e,n,r,o=Zo(c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=o.call(this)).mergedValuesCache=[],n.aggregationFunction=t,n.fallbackValue=e,n}return e=c,n=[{key:"getMergedValues",value:function(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=Object(m.arrayMap)(this.get(),(function(map){return map.getValues()})),e=[],n=Object(l.isDefined)(t[0])&&t[0].length||0,r=0;r<n;r+=1){for(var o=[],c=0;c<this.getLength();c+=1)o.push(t[c][r]);e.push(o)}return Object(m.arrayMap)(e,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(t,e){var n=this.getMergedValues(e)[t];return Object(l.isDefined)(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],n&&Qo(e.prototype,n),r&&Qo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(qo.a),ni=n(712);function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function oi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ri(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ri(o)?o:String(o)),n)}var r,o}function ii(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function ai(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,si(t,e,"set"),n),n}function si(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var ui=new WeakMap,ci=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ii(this,ui,{writable:!0,value:[]})}var e,n,r;return e=t,(n=[{key:"subscribe",value:function(t){var e;return this.addLocalHook("change",t),this._write(function(t,e){return e.get?e.get.call(t):e.value}(e=this,si(e,ui,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(t){return t.length>0&&this.runLocalHooks("change",t),this}},{key:"_writeInitialChanges",value:function(t){ai(this,ui,t)}}])&&oi(e.prototype,n),r&&oi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fi(t,e){for(var n=[],i=0,r=0;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function di(t){return di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},di(t)}function hi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==di(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==di(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===di(o)?o:String(o)),n)}var r,o}function pi(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function yi(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,mi(t,e,"get"))}function bi(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,mi(t,e,"set"),n),n}function mi(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}Object(object.mixin)(ci,ni.a);var vi,gi=new WeakMap,wi=new WeakMap,Si=new WeakMap,Oi=new WeakMap,Ci=new WeakMap,Ei=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).initialIndexValue;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pi(this,gi,{writable:!0,value:new Set}),pi(this,wi,{writable:!0,value:[]}),pi(this,Si,{writable:!0,value:[]}),pi(this,Oi,{writable:!0,value:!1}),pi(this,Ci,{writable:!0,value:!1}),bi(this,Ci,null!=e&&e)}var e,n,r;return e=t,(n=[{key:"createObserver",value:function(){var t=this,e=new ci;return yi(this,gi).add(e),e.addLocalHook("unsubscribe",(function(){yi(t,gi).delete(e)})),e._writeInitialChanges(fi(yi(this,wi),yi(this,Si))),e}},{key:"emit",value:function(t){var e=yi(this,Si);yi(this,Oi)&&yi(this,wi).length===t.length||(0===t.length?t=new Array(e.length).fill(yi(this,Ci)):bi(this,wi,new Array(t.length).fill(yi(this,Ci))),yi(this,Oi)||(bi(this,Oi,!0),e=yi(this,wi)));var n=fi(e,t);yi(this,gi).forEach((function(t){return t._write(n)})),bi(this,Si,t)}}])&&hi(e.prototype,n),r&&hi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ti(t){return Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ti(t)}function Ri(t){return function(t){if(Array.isArray(t))return ki(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ki(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ki(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ji(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ti(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ti(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ti(o)?o:String(o)),n)}var r,o}var xi=new Set(["getFirstNotHiddenIndex"]),Ai=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.indexesSequence=new Fo.a,this.trimmingMapsCollection=new ei((function(t){return t.some((function(t){return!0===t}))}),!1),this.hidingMapsCollection=new ei((function(t){return t.some((function(t){return!0===t}))}),!1),this.variousMapsCollection=new qo.a,this.hidingChangesObservable=new Ei({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("change",e.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(t){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(t){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(t){e.runLocalHooks("change",t,e.variousMapsCollection)}))}var e,n,r;return e=t,n=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(t){if("hiding"!==t)throw new Error('Unsupported index map type "'.concat(t,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(t,e,n){return this.registerMap(t,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Ko.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(Ko.get(t))(e)}(e,n))}},{key:"registerMap",value:function(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error('Map with name "'.concat(t,'" has been already registered.'));e instanceof Xo.a?this.trimmingMapsCollection.register(t,e):e instanceof Wo.a?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);var n=this.getNumberOfIndexes();return n>0&&e.init(n),e}},{key:"unregisterMap",value:function(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(t){var e=this.notTrimmedIndexesCache[t];return Object(l.isDefined)(e)?e:null}},{key:"getPhysicalFromRenderableIndex",value:function(t){var e=this.renderablePhysicalIndexesCache[t];return Object(l.isDefined)(e)?e:null}},{key:"getVisualFromPhysicalIndex",value:function(t){var e=this.fromPhysicalToVisualIndexesCache.get(t);return Object(l.isDefined)(e)?e:null}},{key:"getVisualFromRenderableIndex",value:function(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}},{key:"getRenderableFromVisualIndex",value:function(t){var e=this.fromVisualToRenderableIndexesCache.get(t);return Object(l.isDefined)(e)?e:null}},{key:"getFirstNotHiddenIndex",value:function(t,e){var n,r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t-e;xi.has("getFirstNotHiddenIndex")&&(xi.delete("getFirstNotHiddenIndex"),Object(f.b)(Object(d.a)(vi||(n=['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],(r=['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])||(r=n.slice(0)),vi=Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))))));var c=this.getPhysicalFromVisualIndex(t);return null===c?!0===o&&l!==t-e?this.getFirstNotHiddenIndex(l,-e,!1,l):null:!1===this.isHidden(c)?t:this.getFirstNotHiddenIndex(t+e,e,o,l)}},{key:"getNearestNotHiddenIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return-1===(o=e>0?r.findIndex((function(e){return e>t})):r.reverse().findIndex((function(e){return e<t})))?n?this.getNearestNotHiddenIndex(t,-e,!1):null:r[o]}},{key:"initToLength",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Ri(new Array(t).keys()),this.notHiddenIndexesCache=Ri(new Array(t).keys()),this.suspendOperations(),this.indexesSequence.init(t),this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(t){var e=this.getNumberOfIndexes();if(t<e){var n=Ri(Array(this.getNumberOfIndexes()-t).keys()).map((function(i){return i+t}));this.removeIndexes(n)}else this.insertIndexes(e,t-e)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(t){this.indexesSequence.setValues(t)}},{key:"getNotTrimmedIndexes",value:function(){var t=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter((function(e){return!1===t.isTrimmed(e)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var t=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter((function(e){return!1===t.isHidden(e)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var t=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter((function(e){return!1===t.isHidden(e)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(t,e){var n=this;"number"==typeof t&&(t=[t]);var r=Object(m.arrayMap)(t,(function(t){return n.getPhysicalFromVisualIndex(t)})),o=this.getNotTrimmedIndexesLength(),l=t.length,c=Object(Yo.b)(this.getIndexesSequence(),r),f=o-l;if(e+l<o){var d=c.filter((function(t){return!1===n.isTrimmed(t)}))[e];f=c.indexOf(d)}this.setIndexesSequence(Object(Yo.a)(c,f,r))}},{key:"isTrimmed",value:function(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}},{key:"isHidden",value:function(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}},{key:"insertIndexes",value:function(t,e){var n=this.getNotTrimmedIndexes()[t],r=Object(l.isDefined)(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),c=Object(m.arrayMap)(new Array(e).fill(r),(function(t,e){return t+e}));this.suspendOperations(),this.indexesSequence.insert(o,c),this.trimmingMapsCollection.insertToEvery(o,c),this.hidingMapsCollection.insertToEvery(o,c),this.variousMapsCollection.insertToEvery(o,c),this.resumeOperations()}},{key:"removeIndexes",value:function(t){this.suspendOperations(),this.indexesSequence.remove(t),this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}},{key:"updateCache",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(n,e)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromRenderableIndex(e),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,e)}}}],n&&ji(e.prototype,n),r&&ji(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(object.mixin)(Ai,ni.a);var _i=n(685),Ii=n(862),Mi=n(841),Ni=(n(14),n(16),n(17),n(725)),Pi=n(728);n(668),n(305),n(115);function Hi(t){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(t)}function Di(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Li(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Li(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Li(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Bi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Hi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Hi(o)?o:String(o)),n)}var r,o}var Vi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var e,n,o;return e=t,n=[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(function(){return t.onMouseDown()})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}));for(var n=function(e){var element=t.main.childNodes[e];t.eventManager.addEventListener(element,"mouseenter",(function(n){return t.onMouseEnter(n,t.main.childNodes[e])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Object(R.stopImmediatePropagation)(t);var n=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function t(l){var c;((c=l).clientY<Math.floor(o.top)||c.clientY>Math.ceil(o.top+o.height)||c.clientX<Math.floor(o.left)||c.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")}))}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var n=["top","start","bottom","end","corner"],style=this.main.style;style.position="absolute",style.top=0,style.left=0;for(var i=0;i<5;i++){var r=n[i],div=e.createElement("div");div.className="wtBorder ".concat(this.settings.className||""),this.settings[r]&&this.settings[r].hide&&(div.className+=" hidden"),(style=div.style).backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:t.border.color,style.height=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(t.border.width,"px"),style.width=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(div)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(c.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var o=this.wot.wtTable,l=o.bordersHolder;l||((l=e.createElement("div")).className="htBorders",o.bordersHolder=l,o.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(object.objectEach)(n,(function(e,n){t.selectionHandles.styles.bottomHitArea[n]=e,t.selectionHandles.styles.topHitArea[n]=e}));var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Object(object.objectEach)(r,(function(e,n){t.selectionHandles.styles.bottom[n]=e,t.selectionHandles.styles.top[n]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(t,col){var e=this.wot.selections.createOrGetArea();return!(!e.cellRange||t===e.cellRange.to.row&&col===e.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,col,e,n,r,o){var l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",c=this.selectionHandles.styles,f=c.top,d=c.topHitArea,h=c.bottom,y=c.bottomHitArea,m=parseInt(f.borderWidth,10),v=parseInt(f.width,10),w=parseInt(d.width,10),S=this.wot.wtTable.getWidth(),O=this.wot.wtTable.getHeight();f.top="".concat(parseInt(e-v-1,10),"px"),f[l]="".concat(parseInt(n-v-1,10),"px"),d.top="".concat(parseInt(e-w/4*3,10),"px"),d[l]="".concat(parseInt(n-w/4*3,10),"px");var C=Math.min(parseInt(n+r,10),S-v-2*m),E=Math.min(parseInt(n+r-w/4,10),S-w-2*m);h[l]="".concat(C,"px"),y[l]="".concat(E,"px");var T=Math.min(parseInt(e+o,10),O-v-2*m),R=Math.min(parseInt(e+o-w/4,10),O-w-2*m);h.top="".concat(T,"px"),y.top="".concat(R,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",d.display="block",this.isPartRange(t,col)?(h.display="none",y.display="none"):(h.display="block",y.display="block")):(f.display="none",h.display="none",d.display="none",y.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||col===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",d.zIndex="9999"):(f.zIndex="",d.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,n,o,l,f,d,h=this.wot,y=h.wtTable,m=h.rootDocument,v=h.rootWindow,w=y.getRenderedRowsCount(),i=0;i<w;i+=1){var s=y.rowFilter.renderedToSource(i);if(s>=t[0]&&s<=t[2]){e=s,f=t[0];break}}for(var S=w-1;S>=0;S-=1){var O=y.rowFilter.renderedToSource(S);if(O>=t[0]&&O<=t[2]){n=O;break}}for(var C=y.getRenderedColumnsCount(),E=0;E<C;E+=1){var T=y.columnFilter.renderedToSource(E);if(T>=t[1]&&T<=t[3]){o=T,d=t[1];break}}for(var R=C-1;R>=0;R-=1){var k=y.columnFilter.renderedToSource(R);if(k>=t[1]&&k<=t[3]){l=k;break}}if(void 0!==e&&void 0!==o){var j=y.getCell(this.wot.createCellCoords(e,o)),x=e!==n||o!==l,A=x?y.getCell(this.wot.createCellCoords(n,l)):j,_=Object(r.offset)(j),I=x?Object(r.offset)(A):_,M=Object(r.offset)(y.TABLE),N=Object(r.outerWidth)(y.TABLE),P=_.top,H=_.left,D=this.wot.wtSettings.getSetting("rtlMode"),L=0,B=0;if(D){var V=Object(r.outerWidth)(j),F=v.innerWidth-M.left-N;B=H+V-I.left,L=v.innerWidth-H-V-F-1}else B=I.left+Object(r.outerWidth)(A)-H,L=H-M.left-1;if(this.isEntireColumnSelected(e,n)){var W=this.getDimensionsFromHeader("columns",o,l,f,M),U=null;if(W){var z=Di(W,3);U=z[0],L=z[1],B=z[2]}U&&(j=U)}var G=P-M.top-1,X=I.top+Object(r.outerHeight)(A)-P;if(this.isEntireRowSelected(o,l)){var K=this.getDimensionsFromHeader("rows",e,n,d,M),Y=null;if(K){var $=Di(K,3);Y=$[0],G=$[1],X=$[2]}Y&&(j=Y)}var style=Object(r.getComputedStyle)(j,v);parseInt(style.borderTopWidth,10)>0&&(G+=1,X=X>0?X-1:0),parseInt(style[D?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,B=B>0?B-1:0);var Q=D?"right":"left";this.topStyle.top="".concat(G,"px"),this.topStyle[Q]="".concat(L,"px"),this.topStyle.width="".concat(B,"px"),this.topStyle.display="block",this.startStyle.top="".concat(G,"px"),this.startStyle[Q]="".concat(L,"px"),this.startStyle.height="".concat(X,"px"),this.startStyle.display="block";var J=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(G+X-J,"px"),this.bottomStyle[Q]="".concat(L,"px"),this.bottomStyle.width="".concat(B,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(G,"px"),this.endStyle[Q]="".concat(L+B-J,"px"),this.endStyle.height="".concat(X+1,"px"),this.endStyle.display="block";var Z=this.settings.border.cornerVisible;Z="function"==typeof Z?Z(this.settings.layerLevel):Z;var tt=this.wot.getSetting("onModifyGetCellCoords",n,l),et=n,nt=l;if(tt&&Array.isArray(tt)){var ot=Di(tt,4);et=ot[2],nt=ot[3]}if(Object(c.isMobileBrowser)()||!Z||this.isPartRange(et,nt))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(G+X+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[Q]="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var it=Object(r.getTrimmingContainer)(y.TABLE),at=it===v;at&&(it=m.documentElement);var lt=parseInt(this.cornerDefaultStyle.width,10)/2,st=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){var ut=at?A.getBoundingClientRect().left:A.offsetLeft;(D?ut-parseInt(this.cornerDefaultStyle.width,10)/2<0:ut+Object(r.outerWidth)(A)+parseInt(this.cornerDefaultStyle.width,10)/2>=Object(r.innerWidth)(it))&&(this.cornerStyle[Q]="".concat(Math.floor(L+B+this.cornerCenterPointOffset-lt),"px"),this.cornerStyle[D?"borderLeftWidth":"borderRightWidth"]=0)}n===this.wot.getSetting("totalRows")-1&&(at?A.getBoundingClientRect().top:A.offsetTop)+Object(r.outerHeight)(A)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(r.innerHeight)(it)&&(this.cornerStyle.top="".concat(Math.floor(G+X+this.cornerCenterPointOffset-st),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(c.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,l,G,L,B,X)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,o,l){var c=this.wot.wtTable,f=c.wtRootElement.parentNode,d=null,h=null,y=null,m=null,v=null,w=null,S=null,O=null;switch(t){case"rows":d=function(){return c.getRowHeader.apply(c,arguments)},h=function(){return r.outerHeight.apply(void 0,arguments)},y="ht__selection--rows",w="top";break;case"columns":d=function(){return c.getColumnHeader.apply(c,arguments)},h=function(){return r.outerWidth.apply(void 0,arguments)},y="ht__selection--columns",w="left"}if(f.classList.contains(y)){var C=this.wot.getSetting("columnHeaders").length;if(S=d(e,C-o),O=d(n,C-o),!S||!O)return!1;var E=Object(r.offset)(S),T=Object(r.offset)(O);return S&&O&&(m=E[w]-l[w]-1,v=T[w]+h(O)-E[w]),[S,m,v]}return!1}},{key:"changeBorderStyle",value:function(t,e){var style=this[t].style,n=e[t];!n||n.hide?Object(r.addClass)(this[t],"hidden"):(Object(r.hasClass)(this[t],"hidden")&&Object(r.removeClass)(this[t],"hidden"),style.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(style.height="".concat(n.width,"px")),"start"!==t&&"end"!==t||(style.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e=1,n="#000",style=this[t].style;style.backgroundColor=n,style.width="".concat(e,"px"),style.height="".concat(e,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?Object(r.addClass)(this[t],"hidden"):Object(r.removeClass)(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Object(c.isMobileBrowser)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],n&&Bi(e.prototype,n),o&&Bi(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Fi=Vi;function Wi(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ui(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function zi(t){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zi(t)}function Gi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==zi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===zi(o)?o:String(o)),n)}var r,o}var Xi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var e,n,o;return e=t,n=[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new Fi(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,o){var l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=t.wtTable.getCell(this.settings.createCellCoords(e,n));if("object"===zi(c)){var f=o;l&&(f=this.classNameGenerator(c),this.classNames.includes(f)||this.classNames.push(f)),Object(r.addClass)(c,f)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(element){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var l=o>=0?o:e,c=t,f=0==(l-=1)?t:"".concat(t,"-").concat(l);if(Object(r.hasClass)(element,f)){var d=l+1;c="".concat(t,"-").concat(d)}else c=n(element,l);return c}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),o=this.getCorners(),l=Wi(o,4),c=l[0],f=l[1],d=l[2],h=l[3],y=this.settings,m=y.highlightHeaderClassName,v=y.highlightColumnClassName,w=y.highlightRowClassName,S=y.highlightOnlyClosestHeader,O=y.selectionType,C=void 0===O||["active-header","header"].includes(O);if(C&&null!==f&&null!==h)for(var E=0,T=0;T<n;T+=1){var R=t.wtTable.columnFilter.renderedToSource(T);if(R>=f&&R<=h){var k=t.wtTable.getColumnHeaders(R),j=k.length-1;S&&k.length>1&&(k=[k[j]]);for(var x=0;x<k.length;x+=1){var A=[],_=k[x];m&&A.push(m),v&&A.push(v),x=S?j:x;var I=t.getSetting("onBeforeHighlightingColumnHeader",R,x,{selectionType:O,columnCursor:E,selectionWidth:h-f+1,classNames:A});I!==R&&(_=t.wtTable.getColumnHeader(I,x)),Object(r.addClass)(_,A)}E+=1}}if(null!==c&&null!==d)for(var M=0,N=0;N<e;N+=1){var P=t.wtTable.rowFilter.renderedToSource(N);if(C&&P>=c&&P<=d){var H=t.wtTable.getRowHeaders(P),D=H.length-1;S&&H.length>1&&(H=[H[D]]);for(var L=0;L<H.length;L+=1){var B=[],V=H[L];m&&B.push(m),w&&B.push(w),L=S?D:L;var F=t.getSetting("onBeforeHighlightingRowHeader",P,L,{selectionType:O,rowCursor:M,selectionHeight:d-c+1,classNames:B});F!==P&&(V=t.wtTable.getRowHeader(F,L)),Object(r.addClass)(V,B)}M+=1}if(null!==f&&null!==h)for(var W=0;W<n;W+=1){var U=t.wtTable.columnFilter.renderedToSource(W);P>=c&&P<=d&&U>=f&&U<=h?this.settings.className&&this.addClassAtCoords(t,P,U,this.settings.className,this.settings.markIntersections):P>=c&&P<=d?w&&this.addClassAtCoords(t,P,U,w):U>=f&&U<=h&&v&&this.addClassAtCoords(t,P,U,v);var z=t.getSetting("onAfterDrawSelection",P,U,this.settings.layerLevel);"string"==typeof z&&this.addClassAtCoords(t,P,U,z)}}t.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(t).appear(o)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(t){return t.destroy()}))}}],n&&Gi(e.prototype,n),o&&Gi(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ki(t){return Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ki(t)}function Yi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ta(n.key),n)}}function qi(){return qi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Zi(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},qi.apply(this,arguments)}function $i(t,p){return $i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},$i(t,p)}function Qi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zi(t);if(e){var o=Zi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ki(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ji(t)}(this,n)}}function Ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zi(t){return Zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zi(t)}function ta(t){var e=function(input,t){if("object"!==Ki(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ki(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ki(e)?e:String(e)}var ea=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$i(t,e)}(l,t);var e,n,r,o=Qi(l);function l(t,e){var n,r,c,f;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,t,null),r=Ji(n),f=null,(c=ta(c="visualCellRange"))in r?Object.defineProperty(r,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):r[c]=f,n.visualCellRange=e||null,n.commit(),n}return e=l,n=[{key:"add",value:function(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}},{key:"clear",value:function(){return this.visualCellRange=null,qi(Zi(l.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(t){var e=t.from,n=t.to,r=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){if("header"!==this.settings.type&&"active-header"!==this.settings.type)return null;r=e,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),t.row,e);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),t.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(t,e,n){if(e<0)return e;var r=t.getNearestNotHiddenIndex(e,n);return"header"!==this.settings.type&&"active-header"!==this.settings.type||null!==r?r:-1}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}},{key:"syncWith",value:function(t){var e="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(t.from.clone().normalize(),e,n);if(null!==r&&t.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return t.setHighlight(r),this}return t.setHighlight(t.from),this}},{key:"getCorners",value:function(){var t=this.cellRange,e=t.from,n=t.to,r=null===e.row||null===n.row,o=null===e.col||null===n.col,l=this.settings.createCellCoords(r?null:Math.min(e.row,n.row),o?null:Math.min(e.col,n.col)),c=this.settings.createCellCoords(r?null:Math.max(e.row,n.row),o?null:Math.max(e.col,n.col));return[l.row,l.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}},{key:"createRenderableCellRange",value:function(t,e){var n=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return this.settings.createCellRange(n,n,r)}}],n&&Yi(e.prototype,n),r&&Yi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Xi),na=ea;function ra(t){return ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ra(t)}var oa=["activeHeaderClassName"];function ia(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function aa(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ia(Object(source),!0).forEach((function(e){la(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ia(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function la(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==ra(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ra(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ra(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var ua=function(t){var e=t.activeHeaderClassName,n=sa(t,oa);return new na(aa(aa({highlightHeaderClassName:e},n),{},{selectionType:Pi.a}))};function ca(t){return ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ca(t)}var fa=["layerLevel","areaCornerVisible"];function da(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function ha(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?da(Object(source),!0).forEach((function(e){pa(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):da(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function pa(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==ca(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ca(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ca(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ya(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var ba=function(t){var e=t.layerLevel,n=t.areaCornerVisible,r=ya(t,fa);return new na(ha(ha({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:Pi.b}))};function ma(t){return ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ma(t)}var va=["cellCornerVisible"];function ga(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function wa(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ga(Object(source),!0).forEach((function(e){Sa(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ga(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Sa(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==ma(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ma(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ma(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var Ca=function(t){var e=t.cellCornerVisible,n=Oa(t,va);return new na(wa(wa({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{},{selectionType:Pi.c}))};function Ea(t){return Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ea(t)}var Ta=["border","visualCellRange"];function Ra(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function ka(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Ra(Object(source),!0).forEach((function(e){ja(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Ra(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function ja(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ea(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ea(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ea(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var Aa=function(t){var e=t.border,n=t.visualCellRange,r=xa(t,Ta);return new na(ka(ka(ka({},e),r),{},{selectionType:Pi.d}),n)};n(422);function _a(t){return _a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_a(t)}function Ia(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ma(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Ia(Object(source),!0).forEach((function(e){Na(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Ia(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Na(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==_a(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==_a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===_a(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Pa=function(t){var e=Object.assign({},(function(t){if(null==t)throw new TypeError("Cannot destructure "+t)}(t),t));return new na(Ma(Ma({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:Pi.e}))};function Ha(t){return Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(t)}var Da=["headerClassName","rowClassName","columnClassName"];function La(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ba(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?La(Object(source),!0).forEach((function(e){Va(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):La(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Va(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ha(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ha(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ha(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var Wa=function(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName,o=Fa(t,Da);return new na(Ba(Ba({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:Pi.f}))};function Ua(t){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(t)}function za(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ga(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ua(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ua(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Xa=Object(Ni.a)("highlight/types"),Ka=Xa.register,Ya=Xa.getItem;function qa(t,e){return Ya(t)(function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?za(Object(source),!0).forEach((function(e){Ga(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):za(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({type:t},e))}function $a(t){return $a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$a(t)}function Qa(t){return function(t){if(Array.isArray(t))return Ja(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ja(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ja(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ja(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Za(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function tl(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Za(Object(source),!0).forEach((function(e){el(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Za(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function el(t,e,n){return(e=rl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rl(n.key),n)}}function rl(t){var e=function(input,t){if("object"!==$a(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===$a(e)?e:String(e)}Ka(Pi.a,ua),Ka(Pi.b,ba),Ka(Pi.c,Ca),Ka(Pi.d,Aa),Ka(Pi.e,Pa),Ka(Pi.f,Wa);var il=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.layerLevel=0,this.cell=qa(Pi.c,t),this.fill=qa(Pi.e,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var n,r,o;return n=e,r=[{key:"isEnabledFor",value:function(t,e){var n=t;t===Pi.c&&(n="current");var r=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var area,t=this.layerLevel;return this.areas.has(t)?area=this.areas.get(t):(area=qa(Pi.b,tl({layerLevel:t},this.options)),this.areas.set(t,area)),area}},{key:"getAreas",value:function(){return Qa(this.areas.values())}},{key:"createOrGetHeader",value:function(){var header,t=this.layerLevel;return this.headers.has(t)?header=this.headers.get(t):(header=qa(Pi.f,tl({},this.options)),this.headers.set(t,header)),header}},{key:"getHeaders",value:function(){return Qa(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var header,t=this.layerLevel;return this.activeHeaders.has(t)?header=this.activeHeaders.get(t):(header=qa(Pi.a,tl({},this.options)),this.activeHeaders.set(t,header)),header}},{key:"getActiveHeaders",value:function(){return Qa(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Qa(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(qa(Pi.d,tl(tl({},this.options),t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(m.arrayEach)(this.areas.values(),(function(t){t.clear()})),Object(m.arrayEach)(this.headers.values(),(function(t){t.clear()})),Object(m.arrayEach)(this.activeHeaders.values(),(function(t){t.clear()}))}},{key:t,value:function(){return[this.cell,this.fill].concat(Qa(this.areas.values()),Qa(this.headers.values()),Qa(this.activeHeaders.values()),Qa(this.customSelections))[Symbol.iterator]()}}],r&&nl(n.prototype,r),o&&nl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}(Symbol.iterator),al=il;function ll(t){return ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(t)}function sl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ll(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ll(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ll(o)?o:String(o)),n)}var r,o}var cl=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.ranges=[],this.createCellRange=t}var n,r,o;return n=e,r=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}},{key:"add",value:function(t){return this.ranges.push(this.createCellRange(t)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some((function(e){return e.includes(t)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+e-1;return n>=0&&(t=this.ranges[n]),t}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}],r&&sl(n.prototype,r),o&&sl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}(Symbol.iterator),fl=cl;function hl(t){return hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(t)}function pl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==hl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==hl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===hl(o)?o:String(o)),n)}var r,o}var yl=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=e,this.options=n}var e,n,r;return e=t,n=[{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(t,e),o=this.range.current().highlight,l=this.options.visualToRenderableCoords(o),c=l.row,f=l.col,d=o,h=0,y=0;if(this.runLocalHooks("beforeTransformStart",r),null!==c&&null!==f){var m=this.options.countRows(),v=this.options.countCols(),w=this.options.fixedRowsBottom(),S=this.options.minSpareRows(),O=this.options.minSpareCols(),C=this.options.autoWrapRow(),E=this.options.autoWrapCol();c+t>m-1?n&&S>0&&!(w&&c>=m-w-1)?(this.runLocalHooks("insertRowRequire",m),m=this.options.countRows()):E&&(r.row=1-m,r.col=f+r.col===v-1?1-v:1):E&&c+r.row<0&&f+r.col>=0&&(r.row=m-1,r.col=f+r.col===0?v-1:-1),f+r.col>v-1?n&&O>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):C&&(r.row=c+r.row===m-1?1-m:1,r.col=1-v):C&&f+r.col<0&&c+r.row>=0&&(r.row=c+r.row===0?m-1:-1,r.col=v-1);var T=this.options.createCellCoords(c+r.row,f+r.col);h=0,y=0,T.row<0?(h=-1,T.row=0):T.row>0&&T.row>=m&&(h=1,T.row=m-1),T.col<0?(y=-1,T.col=0):T.col>0&&T.col>=v&&(y=1,T.col=v-1),d=this.options.renderableToVisualCoords(T)}return this.runLocalHooks("afterTransformStart",d,h,y),d}},{key:"transformEnd",value:function(t,e){var n=this.options.createCellCoords(t,e),r=this.range.current(),o=r.to,l=0,c=0;this.runLocalHooks("beforeTransformEnd",n);var f=this.options.visualToRenderableCoords(r.highlight),d=f.row,h=f.col;if(null!==d&&null!==h){var y=this.options.countRows(),m=this.options.countCols(),v=this.options.visualToRenderableCoords(r.to),w=v.row,S=v.col,O=this.options.createCellCoords(w+n.row,S+n.col);l=0,c=0,O.row<0?(l=-1,O.row=0):O.row>0&&O.row>=y&&(l=1,O.row=y-1),O.col<0?(c=-1,O.col=0):O.col>0&&O.col>=m&&(c=1,O.col=m-1),o=this.options.renderableToVisualCoords(O)}return this.runLocalHooks("afterTransformEnd",o,l,c),o}}],n&&pl(e.prototype,n),r&&pl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(object.mixin)(yl,ni.a);var bl,ml=yl,vl=n(810);function gl(t){return gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(t)}function wl(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Sl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sl(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ol(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==gl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==gl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===gl(o)?o:String(o)),n)}var r,o}var Cl=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new fl((function(t,e,n){return r.tableProps.createCellRange(t,e,n)})),this.highlight=new al({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(t,e){return r.tableProps.isDisabledCellSelection(t,e)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},createCellRange:function(t,e,n){return r.tableProps.createCellRange(t,e,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new ml(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))}))}var e,n,r;return e=t,n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(l.isUndefined)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,c=t.row<0,f=t.col<0,d=c&&f,h=t.clone();this.selectedByCorner=d,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),h),(!r||r&&!o&&Object(l.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(h),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!d&&f&&this.selectedByRowHeader.add(this.getLayerLevel()),!d&&c&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){var e=t.clone();this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Pi.c,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(Object(m.arrayEach)(this.highlight.getAreas(),(function(t){t.clear()})),Object(m.arrayEach)(this.highlight.getHeaders(),(function(t){t.clear()})),Object(m.arrayEach)(this.highlight.getActiveHeaders(),(function(t){t.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),c=this.highlight.createOrGetActiveHeader();if(o.clear(),l.clear(),c.clear(),this.highlight.isEnabledFor(Pi.b,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var f=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(f.from).commit().syncWith(f),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(Pi.f,n.highlight)){var d=0===this.tableProps.countRowsTranslated(),h=0===this.tableProps.countColsTranslated(),y=n;(d||h)&&(y=n.clone()),d&&(y.from.row=-1),h&&(y.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&y.from.normalize(),l.add(y.from).commit()):l.add(y.from).add(y.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&c.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&c.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=Object(object.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}},{key:"isEntireRowSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}},{key:"isEntireColumnSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(t||e||0!==n&&0!==r){var o=this.tableProps.createCellCoords(e?-1:0,t?-1:0),l=this.tableProps.createCellCoords(n-1,r-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(t){var e,n,r=this,o=Object(vl.c)(t);if(o===vl.a)return!1;if(o===vl.b)throw new Error(Object(d.a)(bl||(e=["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],(n=["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."])||(n=e.slice(0)),bl=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})))));var l=Object(vl.e)(o,{propToCol:function(t){return r.tableProps.propToCol(t)},keepDirection:!0}),c=this.tableProps.countRows(),f=this.tableProps.countCols(),h=!t.some((function(t){var e=wl(l(t),4),n=e[0],r=e[1],o=e[2],d=e[3];return!(Object(vl.d)(n,c)&&Object(vl.d)(r,f)&&Object(vl.d)(o,c)&&Object(vl.d)(d,f))}));return h&&(this.clear(),Object(m.arrayEach)(t,(function(t){var e=wl(l(t),4),n=e[0],o=e[1],c=e[2],f=e[3];r.setRangeStartOnly(r.tableProps.createCellCoords(n,o),!1),r.setRangeEnd(r.tableProps.createCellCoords(c,f)),r.finish()}))),h}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"==typeof t?this.tableProps.propToCol(t):t,o="string"==typeof e?this.tableProps.propToCol(e):e,l=this.tableProps.countCols(),c=this.tableProps.countRows(),f=Object(vl.d)(r,l)&&Object(vl.d)(o,l);return f&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(c-1,o)),this.finish()),f}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),l=Object(vl.d)(t,r)&&Object(vl.d)(e,r);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,n)),this.setRangeEnd(this.tableProps.createCellCoords(e,o-1)),this.finish()),l}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(t){t.commit()})),this.isSelected()){var t=this.highlight.getCell(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),l.commit()}this.highlight.useLayerLevel(e)}}}],n&&Ol(e.prototype,n),r&&Ol(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(object.mixin)(Cl,ni.a);var El=Cl,Tl=n(721);function Rl(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"==typeof e.type?Object(Tl.a)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Object(object.objectEach)(e,(function(e,n){t._automaticallyAssignedMetaProps.delete(n)})),Object(object.isObject)(r)){n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);var o={};Object(object.objectEach)(r,(function(e,r){var l;(function(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!Object(object.hasOwnProperty)(e,t))})(r,n)&&(o[r]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(r))})),Object(object.extend)(t,o)}}function kl(t){return Number.isInteger(t)&&t>=0}function jl(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function xl(t){return null==t}var Al=n(933);function _l(t){return _l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_l(t)}function Il(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ml(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Il(Object(source),!0).forEach((function(e){Nl(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Il(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Nl(t,e,n){return(e=Dl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dl(n.key),n)}}function Hl(t,e,n){return e&&Pl(t.prototype,e),n&&Pl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dl(t){var e=function(input,t){if("object"!==_l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==_l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===_l(e)?e:String(e)}function Ll(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Bl=function(){function t(e){Ll(this,t),this.metaCtor=Hl((function t(){Ll(this,t)})),this.meta=this.metaCtor.prototype,Object(object.extend)(this.meta,Object(Al.a)()),this.meta.instance=e}return Hl(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){var e;Object(object.extend)(this.meta,t),Rl(this.meta,Ml(Ml({},t),{},{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}]),t}();function Vl(t){return Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(t)}function Fl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Vl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Vl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Vl(o)?o:String(o)),n)}var r,o}var Wl=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.getMetaConstructor();this.meta=new n}var e,n,r;return e=t,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){Object(object.extend)(this.meta,t),Rl(this.meta,t,t)}}])&&Fl(e.prototype,n),r&&Fl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ul(t){return Ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(t)}function zl(t){return function(t){if(Array.isArray(t))return Gl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Gl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gl(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Xl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ul(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ul(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ul(o)?o:String(o)),n)}var r,o}var Kl=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}var n,r,o;return n=e,r=[{key:"obtain",value:function(t){jl((function(){return kl(t)}),"Expecting an unsigned number.");var e,n=this._getStorageIndexByKey(t);if(n>=0)void 0===(e=this.data[n])&&(e=this.valueFactory(t),this.data[n]=e);else if(e=this.valueFactory(t),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=e,this.index[t]=r}else this.data.push(e),this.index[t]=this.data.length-1;return e}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;jl((function(){return kl(t)||xl(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,i=0;i<e;i++)n.push(r+i),this.data.push(void 0);var o=xl(t)?this.index.length:t;this.index=[].concat(zl(this.index.slice(0,o)),n,zl(this.index.slice(o)))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;jl((function(){return kl(t)||xl(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(xl(t)?this.index.length-e:t,e),i=0;i<n.length;i++){var r=n[i];"number"==typeof r&&this.holes.add(r)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var t=this;return Object(m.arrayFilter)(this.data,(function(e,n){return!t.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var t=[],i=0;i<this.data.length;i++){var e=this._getKeyByStorageIndex(i);-1!==e&&t.push([e,this.data[i]])}var n=0;return{next:function(){if(n<t.length){var e=t[n];return n+=1,{value:e,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(t){return this.index.length>t?this.index[t]:-1}},{key:"_getKeyByStorageIndex",value:function(t){return this.index.indexOf(t)}},{key:t,value:function(){return this.entries()}}],r&&Xl(n.prototype,r),o&&Xl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}(Symbol.iterator);function Yl(t){return Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(t)}function ql(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Yl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Yl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Yl(o)?o:String(o)),n)}var r,o}var $l=["data","width"],Ql=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalMeta=e,this.metas=new Kl((function(){return n._createMeta()}))}var e,n,r;return e=t,n=[{key:"updateMeta",value:function(t,e){var meta=this.getMeta(t);Object(object.extend)(meta,e),Rl(meta,e)}},{key:"createColumn",value:function(t,e){this.metas.insert(t,e)}},{key:"removeColumn",value:function(t,e){this.metas.remove(t,e)}},{key:"getMeta",value:function(t){return this.metas.obtain(t)}},{key:"getMetaConstructor",value:function(t){return this.metas.obtain(t).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}Object(object.inherit)(n,t);for(var i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}(this.globalMeta.getMetaConstructor(),$l).prototype}}],n&&ql(e.prototype,n),r&&ql(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jl(t){return Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(t)}function Zl(t){return function(t){if(Array.isArray(t))return ts(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ts(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ts(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ts(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function es(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Jl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Jl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Jl(o)?o:String(o)),n)}var r,o}var ns=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.columnMeta=e,this.metas=new Kl((function(){return n._createRow()}))}var e,n,r;return e=t,(n=[{key:"updateMeta",value:function(t,e,n){var meta=this.getMeta(t,e);Object(object.extend)(meta,n),Rl(meta,n)}},{key:"createRow",value:function(t,e){this.metas.insert(t,e)}},{key:"createColumn",value:function(t,e){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(t,e)}},{key:"removeRow",value:function(t,e){this.metas.remove(t,e)}},{key:"removeColumn",value:function(t,e){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(t,e)}},{key:"getMeta",value:function(t,e,n){var r=this.metas.obtain(t).obtain(e);return void 0===n?r:r[n]}},{key:"setMeta",value:function(t,e,n,r){var o,l=this.metas.obtain(t).obtain(e);null===(o=l._automaticallyAssignedMetaProps)||void 0===o||o.delete(n),l[n]=r}},{key:"removeMeta",value:function(t,e,n){delete this.metas.obtain(t).obtain(e)[n]}},{key:"getMetas",value:function(){for(var t=[],e=Array.from(this.metas.values()),n=0;n<e.length;n++)t.push.apply(t,Zl(e[n].values()));return t}},{key:"getMetasAtRow",value:function(t){jl((function(){return kl(t)}),"Expecting an unsigned number.");var e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var t=this;return new Kl((function(e){return t._createMeta(e)}))}},{key:"_createMeta",value:function(t){return new(this.columnMeta.getMetaConstructor(t))}}])&&es(e.prototype,n),r&&es(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rs(t){return rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rs(t)}function os(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==rs(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==rs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===rs(o)?o:String(o)),n)}var r,o}var is=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.globalMeta=new Bl(e),this.tableMeta=new Wl(this.globalMeta),this.columnMeta=new Ql(this.globalMeta),this.cellMeta=new ns(this.columnMeta),o.forEach((function(t){return new t(n)})),this.globalMeta.updateMeta(r)}var e,n,r;return e=t,n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(t){this.globalMeta.updateMeta(t)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(t){this.tableMeta.updateMeta(t)}},{key:"getColumnMeta",value:function(t){return this.columnMeta.getMeta(t)}},{key:"updateColumnMeta",value:function(t,e){this.columnMeta.updateMeta(t,e)}},{key:"getCellMeta",value:function(t,e,n){var r=n.visualRow,o=n.visualColumn,l=this.cellMeta.getMeta(t,e);return l.visualRow=r,l.visualCol=o,l.row=t,l.col=e,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(t,e,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}},{key:"setCellMeta",value:function(t,e,n,r){this.cellMeta.setMeta(t,e,n,r)}},{key:"updateCellMeta",value:function(t,e,n){this.cellMeta.updateMeta(t,e,n)}},{key:"removeCellMeta",value:function(t,e,n){this.cellMeta.removeMeta(t,e,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(t){return this.cellMeta.getMetasAtRow(t)}},{key:"createRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}},{key:"createColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}},{key:"removeColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],n&&os(e.prototype,n),r&&os(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function as(t){return as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},as(t)}function ls(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==as(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==as(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===as(o)?o:String(o)),n)}var r,o}Object(object.mixin)(is,ni.a);var ss=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",(function(t){return n.extendCellMeta(t)})),_i.a.getSingleton().add("beforeRender",(function(t){t&&n.metaSyncMemo.clear()}),this.metaManager.hot)}var e,n,r;return e=t,(n=[{key:"extendCellMeta",value:function(t){var e,n=t.row,r=t.col;if(null===(e=this.metaSyncMemo.get(n))||void 0===e||!e.has(r)){var l=t.visualRow,c=t.visualCol,f=this.metaManager.hot,d=f.colToProp(c);t.prop=d,f.runHooks("beforeGetCellMeta",l,c,t);var h,y=Object(object.hasOwnProperty)(t,"type")?t.type:null,m=Object(o.isFunction)(t.cells)?t.cells(n,r,d):null;y&&(m?m.type=null!==(h=m.type)&&void 0!==h?h:y:m={type:y}),m&&this.metaManager.updateCellMeta(n,r,m),f.runHooks("afterGetCellMeta",l,c,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}])&&ls(e.prototype,n),r&&ls(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function us(t){return us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},us(t)}function cs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==us(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==us(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===us(o)?o:String(o)),n)}var r,o}var fs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(t,e,n){if(!n)throw new Error("The `".concat(t,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}var e,n,r;return e=t,(n=[{key:"extendMetaProps",value:function(){var t=this;this.propDescriptors.forEach((function(e,n){var r=e.target,o=e.onChange,l=void 0===o?function(){}:o,c="string"==typeof r,f=c?r:n,d="_".concat(f);t.metaManager.globalMeta.meta[d]=t.metaManager.globalMeta.meta[f],t.installPropWatcher(n,d,l),c&&t.installPropWatcher(r,d,l)}))}},{key:"installPropWatcher",value:function(t,e,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get:function(){return this[e]},set:function(o){var l=!r.usageTracker.has(t);r.usageTracker.add(t),n.call(r,t,o,l),this[e]=o},enumerable:!0,configurable:!0})}}])&&cs(e.prototype,n),r&&cs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ds=n(1052);function hs(t){return function(t){if(Array.isArray(t))return ps(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ps(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ps(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ps(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ys(t){return ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(t)}function bs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ys(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ys(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ys(o)?o:String(o)),n)}var r,o}var ms=function(){function t(e,data,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=data,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}var e,n,r;return e=t,n=[{key:"createMap",value:function(){var t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,e=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,e){var n=0,r=0,o=!1;if("function"==typeof e){var l=Object(object.deepObjectSize)(t);n=l>0?l:this.countFirstRowKeys(),o=!0}else{var c=this.tableMeta.maxCols;n=Math.min(c,e.length)}for(i=0;i<n;i++){var f=o?e(i):e[i];if(Object(object.isObject)(f)){if(void 0!==f.data){var d=o?r:i;this.colToPropCache[d]=f.data,this.propToColCache.set(f.data,d)}r+=1}}}else this.recursiveDuckColumns(t)}},{key:"countFirstRowKeys",value:function(){return Object(Ho.countFirstRowKeys)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(t,e,n){var r,o=this,l=e,c=n;return void 0===l&&(l=0,c=""),"object"!==ys(t)||Array.isArray(t)||Object(object.objectEach)(t,(function(t,e){null===t?(r=c+e,o.colToPropCache.push(r),o.propToColCache.set(r,l),l+=1):l=o.recursiveDuckColumns(t,l,"".concat(e,"."))})),l}},{key:"colToProp",value:function(t){if(!1===Number.isInteger(t))return t;var e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Object(l.isDefined)(this.colToPropCache[e])?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e=this.propToColCache.get(t);if(Object(l.isDefined)(e))return this.instance.toVisualColumn(e);var n=this.instance.toVisualColumn(t);return null===n?t:n}},{key:"getSchema",value:function(){var t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Object(object.duckSchema)(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},source=r.source,o=r.mode,l=void 0===o?"above":o,c=this.instance.countSourceRows(),f=c,d=0,h=t;if(("number"!=typeof h||h>=c)&&(h=c),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h)),!1===this.instance.runHooks("beforeCreateRow",h,n,source)||null===f)return{delta:0};for(var y=this.tableMeta.maxRows,m=this.getSchema().length,v=[],w=function(){var t=null;"array"===e.instance.dataType?e.tableMeta.dataSchema?t=Object(object.deepClone)(e.getSchema()):(t=[],Object(T.rangeEach)(m-1,(function(){return t.push(null)}))):"function"===e.instance.dataType?t=e.tableMeta.dataSchema(h+d):(t={},Object(object.deepExtend)(t,e.getSchema())),v.push(t),d+=1};d<n&&c+d<y;)w();this.instance.rowIndexMapper.insertIndexes(h,d),"below"===l&&(f=Math.min(f+1,c)),this.spliceData(f,0,v);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===v.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),d>0&&(null==t?this.metaManager.createRow(null,d):"auto"!==source&&this.metaManager.createRow(f,n)),this.instance.runHooks("afterCreateRow",S,d,source),this.instance.forceFullRender=!0,{delta:d,startPhysicalIndex:f}}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},source=n.source,r=n.mode,o=void 0===r?"start":r;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,c=this.tableMeta.maxCols,f=this.instance.countSourceCols(),d=t;if(("number"!=typeof d||d>=f)&&(d=f),!1===this.instance.runHooks("beforeCreateCol",d,e,source))return{delta:0};var h=f;d<this.instance.countCols()&&(h=this.instance.toPhysicalColumn(d));var y=this.instance.countSourceRows(),m=this.instance.countCols(),v=0,w=h;"end"===o&&(w=Math.min(w+1,f));for(var S=w;v<e&&m<c;){if("number"!=typeof d||d>=m)if(y>0)for(var O=0;O<y;O+=1)void 0===l[O]&&(l[O]=[]),l[O].push(null);else l.push([null]);else for(var C=0;C<y;C++)l[C].splice(w,0,null);v+=1,w+=1,m+=1}this.instance.columnIndexMapper.insertIndexes(d,v),v>0&&(null==t?this.metaManager.createColumn(null,v):"auto"!==source&&this.metaManager.createColumn(S,e));var E=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",E,v,source),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:v,startPhysicalIndex:S}}},{key:"removeRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(t)?t:-n,o=this.visualRowsToPhysical(r,n),c=this.instance.countSourceRows();if(r=(c+r)%c,!1===this.instance.runHooks("beforeRemoveRow",r,o.length,o,source))return!1;var f=o.length;if(this.filterData(r,f,o),r<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var d=Object(l.isDefined)(this.tableMeta.columns)||Object(l.isDefined)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===d&&this.instance.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((function(a,b){return b-a})).forEach((function(t){e.metaManager.removeRow(t,1)})),this.instance.runHooks("afterRemoveRow",r,f,o,source),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof t?-e:t;n=(this.instance.countCols()+n)%this.instance.countCols();var r=this.visualColumnsToPhysical(n,e),o=r.slice(0).sort((function(a,b){return b-a}));if(!1===this.instance.runHooks("beforeRemoveCol",n,e,r,source))return!1;for(var l=!0,c=o.length,data=this.dataSource,f=0;f<c;f++)l&&r[0]!==r[f]-f&&(l=!1);if(l)for(var d=0,h=this.instance.countSourceRows();d<h;d++)data[d].splice(r[0],e),0===d&&this.metaManager.removeColumn(r[0],e);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var v=0;v<c;v++)data[y].splice(o[v],1),0===y&&this.metaManager.removeColumn(o[v],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,e,r,source),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(col,t,e){for(var n=this.instance.getDataAtCol(col),r=n.slice(t,t+e),o=n.slice(t+e),l=arguments.length,c=new Array(l>3?l-3:0),f=3;f<l;f++)c[f-3]=arguments[f];Object(m.extendArray)(c,o);for(var i=0;i<e;)c.push(null),i+=1;return Object(m.to2dArray)(c),this.instance.populateFromArray(t,col,c,null,null,"spliceCol"),r}},{key:"spliceRow",value:function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),l=r.slice(e+n),c=arguments.length,f=new Array(c>3?c-3:0),d=3;d<c;d++)f[d-3]=arguments[d];Object(m.extendArray)(f,l);for(var i=0;i<n;)f.push(null),i+=1;return this.instance.populateFromArray(t,e,[f],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,n){var r=this;if(!1!==this.instance.runHooks("beforeDataSplice",t,e,n)){var o=[].concat(hs(this.dataSource.slice(0,t)),hs(n),hs(this.dataSource.slice(t)));this.dataSource.length=0,o.forEach((function(t){return r.dataSource.push(t)}))}}},{key:"filterData",value:function(t,e,n){var data=this.instance.runHooks("filterData",t,e,n);!1===Array.isArray(data)&&(data=this.dataSource.filter((function(t,e){return-1===n.indexOf(e)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,data)}},{key:"get",value:function(t,e){var n=this.instance.toPhysicalRow(t),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),l=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Object(object.hasOwnProperty)(r,e))l=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){var c=e.split("."),f=r;if(!f)return null;for(var i=0,d=c.length;i<d;i++)if(void 0===(f=f[c[i]]))return null;l=f}else"function"==typeof e&&(l=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var h=Object(object.createObjectPropListener)(l);this.instance.runHooks("modifyData",n,this.propToCol(e),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}},{key:"set",value:function(t,e,n){var r=this.instance.toPhysicalRow(t),o=n,l=this.dataSource[r],c=this.instance.runHooks("modifyRowData",r);if(l=isNaN(c)?c:l,this.instance.hasHook("modifyData")){var f=Object(object.createObjectPropListener)(o);this.instance.runHooks("modifyData",r,this.propToCol(e),f,"set"),f.isTouched()&&(o=f.value)}if(l&&l.hasOwnProperty&&Object(object.hasOwnProperty)(l,e))l[e]=o;else if("string"==typeof e&&e.indexOf(".")>-1){var d,h=e.split("."),y=l,i=0;for(i=0,d=h.length-1;i<d;i++)void 0===y[h[i]]&&(y[h[i]]={}),y=y[h[i]];y[h[i]]=o}else"function"==typeof e?e(this.dataSource.slice(r,r+1)[0],o):l[e]=o}},{key:"visualRowsToPhysical",value:function(t,e){for(var n,r=this.instance.countSourceRows(),o=[],l=(r+t)%r,c=e;l<r&&c;)n=this.instance.toPhysicalRow(l),o.push(n),c-=1,l+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,e){for(var n=this.instance.countCols(),r=[],o=(n+t)%n,l=e;o<n&&l;){var col=this.instance.toPhysicalColumn(o);r.push(col),l-=1,o+=1}return r}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"getLength",value:function(){var t,e=this.tableMeta.maxRows;t=e<0||0===e?0:e||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!=0||this.instance.countSourceRows()?this.getRange(e,n,t.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,n,r){var o,l,c,output=[],f=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(0===f||0===d)return[];var h=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(f-1,0),Math.max(e.row,n.row)),m=Math.min(Math.max(d-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=y;o++){c=[];var v=o>=0?this.instance.toPhysicalRow(o):o;for(l=Math.min(e.col,n.col);l<=m&&null!==v;l++)c.push(h.call(this,o,this.colToProp(l)));null!==v&&output.push(c)}return output}},{key:"getText",value:function(e,n){return Object(ds.b)(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return Object(ds.b)(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],r=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],n&&bs(e.prototype,n),r&&bs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),vs=ms;function gs(t){return gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(t)}function ws(data,t,e,n){var r=n.hotInstance,l=n.dataMap,c=n.dataSource,f=n.internalSource,source=n.source,d=n.metaManager,h=n.firstRun,y=Object(E.toUpperCaseFirst)(f),m=r.getSettings();Array.isArray(m.dataSchema)?r.dataType="array":Object(o.isFunction)(m.dataSchema)?r.dataType="function":r.dataType="object",l&&l.destroy(),data=r.runHooks("before".concat(y),data,h,source);var v=new vs(r,data,d);if(t(v),"object"===gs(data)&&null!==data)data.push&&data.splice||(data=[data]);else{if(null!==data)throw new Error("".concat(f," only accepts array of objects or array of arrays (").concat(gs(data)," given)"));var w,S=v.getSchema();data=[];var O,C=0;for(C=0,O=m.startRows;C<O;C++)if("object"!==r.dataType&&"function"!==r.dataType||!m.dataSchema)if("array"===r.dataType)w=Object(object.deepClone)(S[0]),data.push(w);else{w=[];for(var T=0,R=m.startCols;T<R;T++)w.push(null);data.push(w)}else w=Object(object.deepClone)(S),data.push(w)}Array.isArray(data[0])&&(r.dataType="array"),m.data=data,v.dataSource=data,c.data=data,c.dataType=r.dataType,c.colToProp=v.colToProp.bind(v),c.propToCol=v.propToCol.bind(v),c.countCachedColumns=v.countCachedColumns.bind(v),e(v),r.runHooks("after".concat(y),data,h,source),h||(r.runHooks("afterChange",null,f),r.render())}var Ss,Os=n(779),Cs=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Es=function(t){return t.map((function(t){var e=t.toLowerCase();return Cs.has(e)?Cs.get(e):e})).sort().join("+")},Ts=function(t){return t.toLowerCase()};function Rs(t){return function(t){if(Array.isArray(t))return xs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||js(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ks(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||js(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function js(t,e){if(t){if("string"==typeof t)return xs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xs(t,e):void 0}}function xs(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var As=function(t){var e=Object(Os.a)({errorIdExists:function(e){return'The "'.concat(e,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=r.keys,f=r.callback,h=r.group,y=r.runOnlyIf,m=void 0===y?function(){return!0}:y,v=r.captureCtrl,w=void 0!==v&&v,S=r.preventDefault,O=void 0===S||S,C=r.stopPropagation,E=void 0!==C&&C,T=r.relativeToGroup,R=r.position;if(Object(l.isUndefined)(h))throw new Error("You need to define the shortcut's group.");if(!1===Object(o.isFunction)(f))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(c))throw new Error(Object(d.a)(Ss||(t=["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],(n=["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."])||(n=t.slice(0)),Ss=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})))));var k={callback:f,group:h,runOnlyIf:m,captureCtrl:w,preventDefault:O,stopPropagation:E};if(Object(l.isDefined)(T)){var j=[T,R];k.relativeToGroup=j[0],k.position=j[1]}c.forEach((function(t){var n=Es(t);if(e.hasItem(n)){var r=e.getItem(n),o=r.findIndex((function(t){return t.group===T}));-1!==o?"before"===R?o-=1:o+=1:o=r.length,r.splice(o,0,k)}else e.addItem(n,[k])}))},r=function(t){var n=Es(t);e.removeItem(n)};return{addShortcut:n,addShortcuts:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((function(t){Object(object.objectEach)(e,(function(n,r){!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])})),n(t)}))},getShortcuts:function(t){var n=Es(t),r=e.getItem(n);return Object(l.isDefined)(r)?r.slice():[]},hasShortcut:function(t){var n=Es(t);return e.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:function(t){e.getItems().forEach((function(e){var n=ks(e,2),o=n[0],l=n[1],c=l.filter((function(option){return option.group!==t}));0===c.length?r(function(t){return t.split("+")}(o)):(l.length=0,l.push.apply(l,Rs(c)))}))}}};var _s,Is=["meta","alt","shift","control"],Ms=(_s=new Set,{press:function(t){_s.add(t)},release:function(t){_s.delete(t)},releaseAll:function(){_s.clear()},isPressed:function(t){return _s.has(t)}});var Ns,Ps,Hs=function(t){var e=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,l=t.afterKeyDown,f=Object(Os.a)({errorIdExists:function(t){return'The "'.concat(t,'" context name is already registered.')}}),d="grid",h=function(){return d},y=function(t){return f.getItem(t)},m=!1,v=function(t,e,n,o,l){var f=function(t){return Is.includes(t)},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},h=function(t){if(!1!==e(t)){var r=n(t);if(229!==t.keyCode&&!1!==r&&!Object(R.isImmediatePropagationStopped)(t)){var h=Ts(t.key),y=[];f(h)?Ms.press(h):y=d(t);var m=[h].concat(y);!l(t,m)&&(Object(c.isMacOS)()&&y.includes("meta")||!Object(c.isMacOS)()&&y.includes("control"))&&l(t,[h].concat(d(t,!0))),o(t)}}},y=function(t){if(!1!==e(t)){var n=Ts(t.key);!1!==f(n)&&Ms.release(n)}},m=function(){Ms.releaseAll()};return{mount:function(){for(var e=t;e;)e.document.documentElement.addEventListener("keydown",h),e.document.documentElement.addEventListener("keyup",y),e.document.documentElement.addEventListener("blur",m),e=Object(r.getParentWindow)(e)},unmount:function(){for(var e=t;e;)e.document.documentElement.removeEventListener("keydown",h),e.document.documentElement.removeEventListener("keyup",y),e.document.documentElement.removeEventListener("blur",m),e=Object(r.getParentWindow)(e)},isPressed:function(t){return Ms.isPressed(t)},releasePressedKeys:function(){return Ms.releaseAll()}}}(e,n,o,l,(function(t,e){var n=y(h()),r=!1;if(!n.hasShortcut(e))return r;for(var o=n.getShortcuts(e),l=0;l<o.length;l++){var c=o[l],f=c.callback,d=c.runOnlyIf,v=c.preventDefault,w=c.stopPropagation,S=c.captureCtrl;if(!1!==d(t)&&(m=S,r=!1===f(t,e),m=!1,v&&t.preventDefault(),w&&t.stopPropagation(),r))break}return r}));return v.mount(),{addContext:function(t){var e=As(t);return f.addItem(t,e),e},getActiveContextName:h,getContext:y,setActiveContextName:function(t){d=t},isCtrlPressed:function(){return!m&&(v.isPressed("control")||v.isPressed("meta"))},releasePressedKeys:function(){return v.releasePressedKeys()},destroy:function(){return v.unmount()}}};function Ds(t){return Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(t)}function Ls(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Bs(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||Fs(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vs(t){return function(t){if(Array.isArray(t))return Ws(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Fs(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fs(t,e){if(t){if("string"==typeof t)return Ws(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ws(t,e):void 0}}function Ws(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Us="gridDefault",zs=null,Gs=new Set;function Xs(t,e){var n,R,k,j,x,A=this,_=arguments.length>2&&void 0!==arguments[2]&&arguments[2],I=!1,M=this,N=new y.a(M),P=!0;Object(vo.a)(_)&&Object(vo.c)(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var H=null!==(n=null==e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",D=["rtl","ltr"].includes(H)?H:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",D),this.isRtl=function(){return"rtl"===D},this.isLtr=function(){return!M.isRtl()},this.getDirectionFactor=function(){return M.isLtr()?1:-1},e.language=Object(Ii.e)(e.language);var L=new is(M,e,[ss,fs]),B=L.getTableMeta(),V=L.getGlobalMeta(),F=Object(Os.a)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Object(vo.b)(this)&&Object(l._injectProductInfo)(e.licenseKey,t),this.guid="ht_".concat(Object(E.randomString)()),this.columnIndexMapper=new Ai,this.rowIndexMapper=new Ai,k=new Vo(M),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var W=function(t){var e=t.row,n=t.col;return M._createCellCoords(e>=0?M.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?M.columnIndexMapper.getRenderableFromVisualIndex(n):n)},U=new El(B,{rowIndexMapper:function(){return M.rowIndexMapper},columnIndexMapper:function(){return M.columnIndexMapper},countCols:function(){return M.countCols()},countRows:function(){return M.countRows()},propToCol:function(t){return R.propToCol(t)},isEditorOpened:function(){return!!M.getActiveEditor()&&M.getActiveEditor().isOpened()},countColsTranslated:function(){return A.view.countRenderableColumns()},countRowsTranslated:function(){return A.view.countRenderableRows()},getShortcutManager:function(){return M.getShortcutManager()},createCellCoords:function(t,e){return M._createCellCoords(t,e)},createCellRange:function(t,e,n){return M._createCellRange(t,e,n)},visualToRenderableCoords:W,renderableToVisualCoords:function(t){var e=t.row,n=t.col;return M._createCellCoords(e>=0?M.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?M.columnIndexMapper.getVisualFromRenderableIndex(n):n)},isDisabledCellSelection:function(t,e){return M.getCellMeta(t,e).disableVisualSelection}});this.selection=U;var z=function(t){t.hiddenIndexesChanged&&A.selection.refresh()};function G(t,e){var element="className"===t?M.rootElement:M.table;if(P)Object(r.addClass)(element,e);else{var n=[],o=[];V[t]&&(n=Array.isArray(V[t])?V[t]:Object(m.stringToArray)(V[t])),e&&(o=Array.isArray(e)?e:Object(m.stringToArray)(e));var l=Object(m.getDifferenceOfArrays)(n,o),c=Object(m.getDifferenceOfArrays)(o,n);l.length&&Object(r.removeClass)(element,l),c.length&&Object(r.addClass)(element,c)}V[t]=e}function X(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function K(t,source,e){if(t.length){var n=M.getActiveEditor(),o=M.runHooks("beforeChange",t,source||"edit"),l=!0;if(!1!==o){var c,f,d=new X;d.onQueueEmpty=function(t){n&&l&&n.cancelChanges(),e(t)};for(var i=t.length-1;i>=0;i--)if(null===t[i])t.splice(i,1);else{var h=Bs(t[i],4),y=h[0],m=h[1],v=h[3],col=R.propToCol(m),w=M.getCellMeta(y,col);"numeric"===w.type&&"string"==typeof v&&Object(T.isNumericLike)(v)&&(t[i][3]=(f=void 0,f=(c=v).replace(",","."),!1===isNaN(parseFloat(f))?parseFloat(f):c)),M.getCellValidator(w)&&(d.addValidatorToQueue(),M.validateCell(t[i][3],w,function(e,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){l=!1,t.splice(e,1),n.valid=!0;var c=M.getCell(n.visualRow,n.visualCol);null!==c&&Object(r.removeClass)(c,B.invalidCellClassName)}d.removeValidatorFormQueue()}}(i,w),source))}d.checkIfQueueIsEmpty()}else n&&n.cancelChanges()}}function Y(t,source){var i=t.length-1;if(!(i<0)){for(;i>=0;i--){var e=!1;if(null!==t[i]){if(null!==t[i][2]&&void 0!==t[i][2]||null!==t[i][3]&&void 0!==t[i][3]){if(B.allowInsertRow)for(;t[i][0]>M.countRows()-1;){if(0===R.createRow(void 0,void 0,{source:source}).delta){e=!0;break}}if("array"===M.dataType&&(!B.columns||0===B.columns.length)&&B.allowInsertColumn)for(;R.propToCol(t[i][1])>M.countCols()-1;){if(0===R.createCol(void 0,void 0,{source:source}).delta){e=!0;break}}e||R.set(t[i][0],t[i][1],t[i][3])}}else t.splice(i,1)}M.forceFullRender=!0,j.adjustRowsAndCols(),M.runHooks("beforeChangeRender",t,source),x.lockEditor(),M._refreshBorders(null),x.unlockEditor(),M.view.adjustElementsSize(),M.runHooks("afterChange",t,source||"edit");var n=M.getActiveEditor();n&&Object(l.isDefined)(n.refreshValue)&&n.refreshValue()}}function $(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("beforeSetRangeStart",(function(t){A.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(t){A.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(t){A.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=A.view._wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=A.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(t){var e=Object(object.createObjectPropListener)(!1),n=A.selection.getSelectedRange(),o=n.current(),l=o.from,c=o.to,f=n.size()-1;A.runHooks("afterSelection",l.row,l.col,c.row,c.col,e,f),A.runHooks("afterSelectionByProp",l.row,M.colToProp(l.col),c.row,M.colToProp(c.col),e,f);var d=A.selection.isSelectedByAnyHeader(),h=A.selection.selectedRange.current(),y=!0;I&&(y=!1),e.isTouched()&&(y=!e.value);var m=A.selection.isSelectedByRowHeader(),v=A.selection.isSelectedByColumnHeader();!1!==y&&(d?m?A.view.scrollViewportVertically(M.rowIndexMapper.getRenderableFromVisualIndex(t.row)):v&&A.view.scrollViewportHorizontally(M.columnIndexMapper.getRenderableFromVisualIndex(t.col)):h&&!A.selection.isMultiple()?A.view.scrollViewport(W(h.from)):A.view.scrollViewport(W(t))),m&&v?Object(r.addClass)(A.rootElement,["ht__selection--rows","ht__selection--columns"]):m?(Object(r.removeClass)(A.rootElement,"ht__selection--columns"),Object(r.addClass)(A.rootElement,"ht__selection--rows")):v?(Object(r.removeClass)(A.rootElement,"ht__selection--rows"),Object(r.addClass)(A.rootElement,"ht__selection--columns")):Object(r.removeClass)(A.rootElement,["ht__selection--rows","ht__selection--columns"]),A._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(t){var e=t.length-1,n=t[e],r=n.from,o=n.to;A.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,e),A.runHooks("afterSelectionEndByProp",r.row,M.colToProp(r.col),o.row,M.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(t){var e=A.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(t){A.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",(function(t,e,n){A.runHooks("afterModifyTransformStart",t,e,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(t){A.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(t,e,n){A.runHooks("afterModifyTransformEnd",t,e,n)})),this.selection.addLocalHook("afterDeselect",(function(){x.destroyEditor(),A._refreshBorders(),Object(r.removeClass)(A.rootElement,["ht__selection--rows","ht__selection--columns"]),A.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(t){A.alter("insert_row_above",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(t){A.alter("insert_col_start",t,1,"auto")})),j={alter:function(t,e){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,source=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,h=function(t){if(0===t.length)return[];var e=Vs(t);return e.sort((function(t,e){var n=Bs(t,1)[0],r=Bs(e,1)[0];return n===r?0:n>r?1:-1})),Object(m.arrayReduce)(e,(function(t,e){var n=Bs(e,2),r=n[0],o=n[1],l=t[t.length-1],c=Bs(l,2),f=c[0]+c[1];if(r<=f){var d=Math.max(o-(f-r),0);l[1]+=d}else t.push([r,o]);return t}),[e[0]])};switch(t){case"insert_row":Gs.has(t)||(Gs.add(t),Object(f.b)(Object(d.a)(Ns||(Ns=Ls(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),t)));case"insert_row_below":case"insert_row_above":var y=M.countSourceRows();if(B.maxRows===y)return;var v="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"insert_row"===t||"below"===v?y:0;var w=R.createRow(e,o,{source:source,mode:v}),S=w.delta,O=w.startPhysicalIndex;if(S){var C=U.selectedRange.current(),E=null==C?void 0:C.from,T=null==E?void 0:E.row,k=M.toVisualRow(O);if(U.isSelectedByCorner())M.selectAll();else if(Object(l.isDefined)(T)&&T>=k){var x=C.to,A=x.row,_=x.col,I=E.col;U.isSelectedByRowHeader()&&(I=-1),U.getSelectedRange().pop(),U.setRangeStartOnly(M._createCellCoords(T+S,I),!0),U.setRangeEnd(M._createCellCoords(A+S,_))}else M._refreshBorders()}break;case"insert_col":Gs.has(t)||(Gs.add(t),Object(f.b)(Object(d.a)(Ps||(Ps=Ls(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),t)));case"insert_col_start":case"insert_col_end":var N="insert_col_end"===t?"end":"start";e=null!==(r=e)&&void 0!==r?r:"insert_col"===t||"end"===N?M.countSourceCols():0;var P=R.createCol(e,o,{source:source,mode:N}),H=P.delta,D=P.startPhysicalIndex;if(H){if(Array.isArray(B.colHeaders)){var L=[M.toVisualColumn(D),0];L.length+=H,Array.prototype.splice.apply(B.colHeaders,L)}var V=U.selectedRange.current(),F=null==V?void 0:V.from,W=null==F?void 0:F.col,z=M.toVisualColumn(D);if(U.isSelectedByCorner())M.selectAll();else if(Object(l.isDefined)(W)&&W>=z){var G=V.to,X=G.row,K=G.col,Y=F.row;U.isSelectedByColumnHeader()&&(Y=-1),U.getSelectedRange().pop(),U.setRangeStartOnly(M._createCellCoords(Y,W+H),!0),U.setRangeEnd(M._createCellCoords(X,K+H))}else M._refreshBorders()}break;case"remove_row":var $=function(t){var e=0;Object(m.arrayEach)(t,(function(t){var n=Bs(t,2),r=n[0],o=n[1],c=Object(l.isEmpty)(r)?M.countRows()-1:Math.max(r-e,0);if(Number.isInteger(r)&&(r=Math.max(r-e,0)),R.removeRow(r,o,source)){var f=M.countRows(),d=B.fixedRowsTop;d>=c+1&&(B.fixedRowsTop-=Math.min(o,d-c));var h=B.fixedRowsBottom;h&&c>=f-h&&(B.fixedRowsBottom-=Math.min(o,h)),e+=o}}))};Array.isArray(e)?$(h(e)):$([[e,o]]),j.adjustRowsAndCols(),M._refreshBorders();break;case"remove_col":var Q=function(t){var e=0;Object(m.arrayEach)(t,(function(t){var n=Bs(t,2),r=n[0],o=n[1],c=Object(l.isEmpty)(r)?M.countCols()-1:Math.max(r-e,0),f=M.toPhysicalColumn(c);if(Number.isInteger(r)&&(r=Math.max(r-e,0)),R.removeCol(r,o,source)){var d=B.fixedColumnsStart;d>=c+1&&(B.fixedColumnsStart-=Math.min(o,d-c)),Array.isArray(B.colHeaders)&&(void 0===f&&(f=-1),B.colHeaders.splice(f,o)),e+=o}}))};Array.isArray(e)?Q(h(e)):Q([[e,o]]),j.adjustRowsAndCols(),M._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}c||j.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e=B.minRows,n=B.minSpareRows,r=B.minCols,o=B.minSpareCols;if(0===M.countRows()&&0===M.countCols()&&U.deselect(),e){var l=M.countRows();l<e&&R.createRow(l,e-l,{source:"auto"})}if(n){var c=M.countEmptyRows(!0);if(c<n){var f=n-c,d=Math.min(f,B.maxRows-M.countSourceRows());R.createRow(M.countRows(),d,{source:"auto"})}}(r||o)&&(t=M.countEmptyCols(!0));var h=M.countCols();if(r&&!B.columns&&h<r){var y=r-h;t+=y,R.createCol(h,y,{source:"auto"})}if(o&&!B.columns&&"array"===M.dataType&&t<o){h=M.countCols();var v=o-t,w=Math.min(v,B.maxCols-h);R.createCol(h,w,{source:"auto"})}if(U.isSelected()){var S=M.countRows(),O=M.countCols();Object(m.arrayEach)(U.selectedRange,(function(t){var e=!1,n=t.from.row,r=t.from.col,o=t.to.row,l=t.to.col;n>S-1?(e=!0,o>(n=S-1)&&(o=n)):o>S-1&&(e=!0,n>(o=S-1)&&(n=o)),r>O-1?(e=!0,l>(r=O-1)&&(l=r)):l>O-1&&(e=!0,r>(l=O-1)&&(r=l)),e&&M.selectCell(n,r,o,l)}))}M.view&&M.view.adjustElementsSize()},populateFromArray:function(t,input,e,source,n,r,o){var c,f,d,h,y=[],v={},w=[],S=t.row,O=t.col;if(0===(f=input.length))return!1;var C=0,E=0;switch(Object(object.isObject)(e)&&(C=e.col-O+1,E=e.row-S+1),n){case"shift_down":var T=Object(m.pivot)(input),R=T.length,k=Math.max(R,C),j=M.getData().slice(S),x=Object(m.pivot)(j).slice(O,O+k);for(d=0;d<k;d+=1)if(d<R){for(c=0,f=T[d].length;c<E-f;c+=1)T[d].push(T[d][c%f]);d<x.length?w.push(T[d].concat(x[d])):w.push(T[d].concat(new Array(j.length).fill(null)))}else w.push(T[d%R].concat(x[d]));M.populateFromArray(S,O,Object(m.pivot)(w));break;case"shift_right":var A=input.length,_=Math.max(A,E),I=M.getData().slice(S).map((function(t){return t.slice(O)}));for(c=0;c<_;c+=1)if(c<A){for(d=0,h=input[c].length;d<C-h;d+=1)input[c].push(input[c][d%h]);var N;if(c<I.length)for(var i=0;i<I[c].length;i+=1)input[c].push(I[c][i]);else(N=input[c]).push.apply(N,Vs(new Array(I[0].length).fill(null)))}else input.push(input[c%f].slice(0,_).concat(I[c]));M.populateFromArray(S,O,input);break;default:v.row=t.row,v.col=t.col;var P,H={row:e&&t?e.row-t.row+1:1,col:e&&t?e.col-t.col+1:1},D=0,L=0,V=!0,F=function(t){var col=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=input[t%input.length];return null!==col?e[col%e.length]:e},W=input.length,U=e?e.row-t.row+1:0;for(f=e?U:Math.max(W,U),c=0;c<f&&!(e&&v.row>e.row&&U>W||!B.allowInsertRow&&v.row>M.countRows()-1||v.row>=B.maxRows);c++){var z=c-D,G=F(z).length,X=e?e.col-t.col+1:0;if(h=e?X:Math.max(G,X),v.col=t.col,P=M.getCellMeta(v.row,v.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!P.skipRowOnPaste){for(L=0,d=0;d<h&&!(e&&v.col>e.col&&X>G||!B.allowInsertColumn&&v.col>M.countCols()-1||v.col>=B.maxCols);d++)if(P=M.getCellMeta(v.row,v.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!P.skipColumnOnPaste)if(P.readOnly&&"UndoRedo.undo"!==source)v.col+=1;else{var K=d-L,Y=F(z,K),$=M.getDataAtCell(v.row,v.col),Q={row:z,col:K};if("Autofill.fill"===source){var J=M.runHooks("beforeAutofillInsidePopulate",Q,r,input,o,{},H);J&&(Y=Object(l.isUndefined)(J.value)?Y:J.value)}if(null!==Y&&"object"===Ds(Y))if(Array.isArray(Y)&&null===$&&($=[]),null===$||"object"!==Ds($))V=!1;else{var Z=Object(object.duckSchema)(Array.isArray($)?$:$[0]||$),tt=Object(object.duckSchema)(Array.isArray(Y)?Y:Y[0]||Y);Object(object.isObjectEqual)(Z,tt)||Array.isArray(Z)&&Array.isArray(tt)?Y=Object(object.deepClone)(Y):V=!1}else null!==$&&"object"===Ds($)&&(V=!1);V&&y.push([v.row,v.col,Y]),V=!0,v.col+=1}else L+=1,v.col+=1,h+=1;v.row+=1}else D+=1,v.row+=1,f+=1}M.setDataAtCell(y,null,null,source||"populateFromArray")}}},this.init=function(){k.setData(B.data),M.runHooks("beforeInit"),(Object(c.isMobileBrowser)()||Object(c.isIpadOS)())&&Object(r.addClass)(M.rootElement,"mobile"),this.updateSettings(B,!0),this.view=new Po(this),x=h.c.getInstance(M,B,U),M.runHooks("init"),this.forceFullRender=!0,this.view.render(),P&&null===M.rootElement.offsetParent&&Object(r.observeVisibilityChangeOnce)(M.rootElement,(function(){M.view._wt.wtOverlays.updateLastSpreaderSize(),M.render(),M.view.adjustElementsSize()})),"object"===Ds(P)&&(M.runHooks("afterChange",P[0],P[1]),P=!1),M.runHooks("afterInit")},this._createCellCoords=function(t,e){return M.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return M.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,source){var r,c=M.getCellValidator(e);function f(t){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&!0!==e.hidden){var col=e.visualCol,r=e.visualRow,td=M.getCell(r,col,!0);if(td&&"TH"!==td.nodeName){var o=M.rowIndexMapper.getRenderableFromVisualIndex(r),l=M.columnIndexMapper.getRenderableFromVisualIndex(col);M.view._wt.getSetting("cellRenderer",o,l,td)}n(t)}else n(t)}Object(l.isRegExp)(c)&&(r=c,c=function(t,e){e(r.test(t))}),Object(o.isFunction)(c)?(t=M.runHooks("beforeValidate",t,e.visualRow,e.prop,source),M._registerImmediate((function(){c.call(e,t,(function(n){M&&(n=M.runHooks("afterValidate",n,t,e.visualRow,e.prop,source),e.valid=n,f(n),M.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,source))}))}))):M._registerImmediate((function(){e.valid=!0,f(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,source){var i,r,o,input=$(t,e,n),l=[],c=source;for(i=0,r=input.length;i<r;i++){if("object"!==Ds(input[i]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof input[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");o=input[i][1]>=this.countCols()?input[i][1]:R.colToProp(input[i][1]),l.push([input[i][0],o,k.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]])}c||"object"!==Ds(t)||(c=e),M.runHooks("afterSetDataAtCell",l,c),K(l,c,(function(){Y(l,c)}))},this.setDataAtRowProp=function(t,e,n,source){var i,r,input=$(t,e,n),o=[],l=source;for(i=0,r=input.length;i<r;i++)o.push([input[i][0],input[i][1],k.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);l||"object"!==Ds(t)||(l=e),M.runHooks("afterSetDataAtRowProp",o,l),K(o,l,(function(){Y(o,l)}))},this.listen=function(){M&&!M.isListening()&&(zs=M.guid,M.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(zs=null,M.runHooks("afterUnlisten"))},this.isListening=function(){return zs===M.guid},this.destroyEditor=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];M._refreshBorders(t,e)},this.populateFromArray=function(t,e,input,n,r,source,o,l,c){if("object"!==Ds(input)||"object"!==Ds(input[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var f="number"==typeof n?M._createCellCoords(n,r):null;return j.populateFromArray(M._createCellCoords(t,e),input,f,source,o,l,c)},this.spliceCol=function(t,e,n){for(var r,o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return(r=R).spliceCol.apply(r,[t,e,n].concat(l))},this.spliceRow=function(t,e,n){for(var r,o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return(r=R).spliceRow.apply(r,[t,e,n].concat(l))},this.getSelected=function(){if(U.isSelected())return Object(m.arrayMap)(U.getSelectedRange(),(function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){var t,e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){var t,e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(source){var t=this;if(U.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var e=[];Object(m.arrayEach)(U.getSelectedRange(),(function(n){var r=n.getTopStartCorner(),o=n.getBottomEndCorner();Object(T.rangeEach)(r.row,o.row,(function(n){Object(T.rangeEach)(r.col,o.col,(function(r){t.getCellMeta(n,r).readOnly||e.push([n,r,null])}))}))})),e.length>0&&this.setDataAtCell(e,source)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(x.lockEditor(),this._refreshBorders(null),x.unlockEditor()))},this.batchRender=function(t){this.suspendRender();var e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();var e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(M.view){var t=M.view.getLastSize(),e=t.width,n=t.height,r=M.rootElement.getBoundingClientRect(),o=r.width,l=r.height,c=o!==e||l!==n;!1===M.runHooks("beforeRefreshDimensions",{width:e,height:n},{width:o,height:l},c)||((c||M.view._wt.wtOverlays.scrollableElement===M.rootWindow)&&(M.view.setLastSize(o,l),M.render()),M.runHooks("afterRefreshDimensions",{width:e,height:n},{width:o,height:l},c))}},this.updateData=function(data,source){var t=this;ws(data,(function(t){R=t}),(function(e){R=e,M.columnIndexMapper.fitToLength(t.getInitialColumnCount()),M.rowIndexMapper.fitToLength(t.countSourceRows()),j.adjustRowsAndCols()}),{hotInstance:M,dataMap:R,dataSource:k,internalSource:"updateData",source:source,metaManager:L,firstRun:P})},this.loadData=function(data,source){ws(data,(function(t){R=t}),(function(){L.clearCellsCache(),M.initIndexMappers(),j.adjustRowsAndCols(),P&&(P=[null,"loadData"])}),{hotInstance:M,dataMap:R,dataSource:k,internalSource:"loadData",source:source,metaManager:L,firstRun:P})},this.getInitialColumnCount=function(){var t=B.columns,e=0;if(Array.isArray(t))e=t.length;else if(Object(o.isFunction)(t))if("array"===M.dataType)for(var n=this.countSourceCols(),r=0;r<n;r+=1)t(r)&&(e+=1);else"object"!==M.dataType&&"function"!==M.dataType||(e=R.colToPropCache.length);else if(Object(l.isDefined)(B.dataSchema)){var c=R.getSchema();e=Array.isArray(c)?c.length:Object(object.deepObjectSize)(c)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,r){return Object(l.isUndefined)(t)?R.getAll():R.getRange(M._createCellCoords(t,e),M._createCellCoords(n,r),R.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,r){return R.getCopyableText(M._createCellCoords(t,e),M._createCellCoords(n,r))},this.getCopyableData=function(t,e){return R.getCopyable(t,R.colToProp(e))},this.getSchema=function(){return R.getSchema()},this.updateSettings=function(t){var i,e,n,r,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=(P?M.loadData:M.updateData).bind(this),d=!1;if(Object(l.isDefined)(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Object(l.isDefined)(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Object(l.isDefined)(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in t)"data"===i||("language"===i?(n=t.language,r=void 0,r=Object(Mi.b)(n),Object(Ii.f)(r)?(M.runHooks("beforeLanguageChange",r),V.language=r,M.runHooks("afterLanguageChange",r)):Object(Mi.c)(n)):"className"===i?G("className",t.className):"tableClassName"===i&&M.table?(G("tableClassName",t.tableClassName),M.view._wt.wtOverlays.syncOverlayTableClassNames()):_i.a.getSingleton().isRegistered(i)||_i.a.getSingleton().isDeprecated(i)?(Object(o.isFunction)(t[i])||Array.isArray(t[i]))&&(t[i].initialHook=!0,M.addHook(i,t[i])):!c&&Object(object.hasOwnProperty)(t,i)&&(V[i]=t[i]));void 0===t.data&&void 0===B.data?f(null,"updateSettings"):void 0!==t.data?f(t.data,"updateSettings"):void 0!==t.columns&&(R.createMap(),M.initIndexMappers());var h=M.countCols(),y=B.columns;if(y&&Object(o.isFunction)(y)&&(d=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||L.clearCache(),h>0)for(i=0,e=0;i<h;i++){if(y){var m=d?y(i):y[e];m&&L.updateColumnMeta(e,m)}e+=1}Object(l.isDefined)(t.cell)&&Object(object.objectEach)(t.cell,(function(t){M.setCellMetaObject(t.row,t.col,t)})),M.runHooks("afterCellMetaReset");var v=M.rootElement.style.height;""!==v&&(v=parseInt(M.rootElement.style.height,10));var w=t.height;(Object(o.isFunction)(w)&&(w=w()),c)&&(M.rootElement.getAttribute("style")&&M.rootElement.setAttribute("data-initialstyle",M.rootElement.getAttribute("style")));if(null===w){var S=M.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?M.rootElement.setAttribute("style",S):(M.rootElement.style.height="",M.rootElement.style.overflow="")}else void 0!==w&&(M.rootElement.style.height=isNaN(w)?"".concat(w):"".concat(w,"px"),M.rootElement.style.overflow="hidden");if(void 0!==t.width){var O=t.width;Object(o.isFunction)(O)&&(O=O()),M.rootElement.style.width=isNaN(O)?"".concat(O):"".concat(O,"px")}c||(M.view&&(M.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),M.view._wt.exportSettingsAsClassNames()),M.runHooks("afterUpdateSettings",t)),j.adjustRowsAndCols(),M.view&&!P&&(M.forceFullRender=!0,x.lockEditor(),M._refreshBorders(null),M.view._wt.wtOverlays.adjustElementsSize(),x.unlockEditor()),c||!M.view||""!==v&&""!==w&&void 0!==w||v===w||M.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=M.getSelectedLast();if(B.getValue){if(Object(o.isFunction)(B.getValue))return B.getValue.call(M);if(t)return M.getData()[t[0][0]][B.getValue]}else if(t)return M.getDataAtCell(t[0],t[1])},this.getSettings=function(){return B},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,source,r){j.alter(t,e,n,source,r)},this.getCell=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===o||null===r?null:M.view.getCellAtCoords(M._createCellCoords(o,r),n)},this.getCoords=function(element){var t=this.view._wt.wtTable.getCoords(element);if(null===t)return null;var e=t.row,n=t.col,r=e,o=n;return e>=0&&(r=this.rowIndexMapper.getVisualFromRenderableIndex(e)),n>=0&&(o=this.columnIndexMapper.getVisualFromRenderableIndex(n)),M._createCellCoords(r,o)},this.colToProp=function(t){return R.colToProp(t)},this.propToCol=function(t){return R.propToCol(t)},this.toVisualRow=function(t){return A.rowIndexMapper.getVisualFromPhysicalIndex(t)},this.toVisualColumn=function(t){return A.columnIndexMapper.getVisualFromPhysicalIndex(t)},this.toPhysicalRow=function(t){return A.rowIndexMapper.getPhysicalFromVisualIndex(t)},this.toPhysicalColumn=function(t){return A.columnIndexMapper.getPhysicalFromVisualIndex(t)},this.getDataAtCell=function(t,e){return R.get(t,R.colToProp(e))},this.getDataAtRowProp=function(t,e){return R.get(t,e)},this.getDataAtCol=function(t){var e;return(e=[]).concat.apply(e,Vs(R.getRange(M._createCellCoords(0,t),M._createCellCoords(B.data.length-1,t),R.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=R.getRange(M._createCellCoords(0,R.propToCol(t)),M._createCellCoords(B.data.length-1,R.propToCol(t)),R.DESTINATION_RENDERER);return(e=[]).concat.apply(e,Vs(n))},this.getSourceData=function(t,e,n,r){return void 0===t?k.getData():k.getByRange(M._createCellCoords(t,e),M._createCellCoords(n,r))},this.getSourceDataArray=function(t,e,n,r){return void 0===t?k.getData(!0):k.getByRange(M._createCellCoords(t,e),M._createCellCoords(n,r),!0)},this.getSourceDataAtCol=function(t){return k.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,source){var input=$(t,e,n),r=this.hasHook("afterSetSourceDataAtCell"),o=[];r&&Object(m.arrayEach)(input,(function(t){var e=Bs(t,3),n=e[0],r=e[1],l=e[2];o.push([n,r,k.getAtCell(n,r),l])})),Object(m.arrayEach)(input,(function(t){var e=Bs(t,3),n=e[0],r=e[1],o=e[2];k.setAtCell(n,r,o)})),r&&this.runHooks("afterSetSourceDataAtCell",o,source),this.render();var c=M.getActiveEditor();c&&Object(l.isDefined)(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(t){return k.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return k.getAtCell(t,e)},this.getDataAtRow=function(t){return R.getRange(M._createCellCoords(t,0),M._createCellCoords(t,this.countCols()-1),R.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,r){var o=this,l=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],c=l[0],f=l[1],d=l[2],h=l[3],y=null,m=null;void 0===d&&(d=c),void 0===h&&(h=f);var v="mixed";return Object(T.rangeEach)(Math.max(Math.min(c,d),0),Math.max(c,d),(function(t){var e=!0;return Object(T.rangeEach)(Math.max(Math.min(f,h),0),Math.max(f,h),(function(n){var r=o.getCellMeta(t,n);return m=r.type,y?e=y===m:y=m,e})),v=e?m:"mixed",e})),v},this.removeCellMeta=function(t,e,n){var r=[this.toPhysicalRow(t),this.toPhysicalColumn(e)],o=r[0],l=r[1],c=L.getCellMetaKeyValue(o,l,n);!1!==M.runHooks("beforeRemoveCellMeta",t,e,n,c)&&(L.removeCellMeta(o,l,n),M.runHooks("afterRemoveCellMeta",t,e,n,c)),c=null},this.spliceCellsMeta=function(t){for(var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&L.removeRow(this.toPhysicalRow(t),n),o.length>0&&Object(m.arrayEach)(o.reverse(),(function(n){L.createRow(e.toPhysicalRow(t)),Object(m.arrayEach)(n,(function(n,r){return e.setCellMetaObject(t,r,n)}))})),M.render()},this.setCellMetaObject=function(t,e,n){var r=this;"object"===Ds(n)&&Object(object.objectEach)(n,(function(n,o){r.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,r){if(!1!==M.runHooks("beforeSetCellMeta",t,e,n,r)){var o=t,l=e;t<this.countRows()&&(o=this.toPhysicalRow(t)),e<this.countCols()&&(l=this.toPhysicalColumn(e)),L.setCellMeta(o,l,n,r),M.runHooks("afterSetCellMeta",t,e,n,r)}},this.getCellsMeta=function(){return L.getCellsMeta()},this.getCellMeta=function(t,e){var n=this.toPhysicalRow(t),r=this.toPhysicalColumn(e);return null===n&&(n=t),null===r&&(r=e),L.getCellMeta(n,r,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return L.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===M.dataType||B.columns)},this.getCellRenderer=function(t,e){var n="number"==typeof t?M.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof n?Object(S.b)(n):Object(l.isUndefined)(n)?Object(S.b)("text"):n},this.getCellEditor=function(t,e){var n="number"==typeof t?M.getCellMeta(t,e).editor:t.editor;return"string"==typeof n?Object(O.a)(n):Object(l.isUndefined)(n)?Object(O.a)("text"):n},this.getCellValidator=function(t,e){var n="number"==typeof t?M.getCellMeta(t,e).validator:t.validator;return"string"==typeof n?Object(C.b)(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new X;t&&(r.onQueueEmpty=t);for(var i=M.countRows()-1;i>=0;)if(void 0===e||-1!==e.indexOf(i)){for(var o=M.countCols()-1;o>=0;)void 0===n||-1!==n.indexOf(o)?(r.addValidatorToQueue(),M.validateCell(M.getDataAtCell(i,o),M.getCellMeta(i,o),(function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),o-=1):o-=1;i-=1}else i-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=B.rowHeaders,n=t;return void 0!==n&&(n=M.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Object(T.rangeEach)(M.countRows()-1,(function(i){e.push(M.getRowHeader(i))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:Object(o.isFunction)(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!B.rowHeaders},this.hasColHeaders=function(){if(void 0!==B.colHeaders&&null!==B.colHeaders)return!!B.colHeaders;for(var i=0,t=M.countCols();i<t;i++)if(M.getColHeader(i))return!0;return!1},this.getColHeader=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=M.runHooks("modifyColHeader",t);if(void 0===n){for(var r=[],l=M.countCols(),i=0;i<l;i++)r.push(M.getColHeader(i));return r}var c=B.colHeaders,f=M.toPhysicalColumn(n),d=function(t){for(var e=[],n=M.countCols(),r=0;r<n;r++)Object(o.isFunction)(B.columns)&&B.columns(r)&&e.push(r);return e[t]}(f);return!1===B.colHeaders?c=null:B.columns&&Object(o.isFunction)(B.columns)&&B.columns(d)&&B.columns(d).title?c=B.columns(d).title:B.columns&&B.columns[f]&&B.columns[f].title?c=B.columns[f].title:Array.isArray(B.colHeaders)&&void 0!==B.colHeaders[f]?c=B.colHeaders[f]:Object(o.isFunction)(B.colHeaders)?c=B.colHeaders(f):B.colHeaders&&"string"!=typeof B.colHeaders&&"number"!=typeof B.colHeaders&&(c=Object(Ho.spreadsheetColumnLabel)(n)),c=M.runHooks("modifyColumnHeaderValue",c,t,e)},this._getColWidthFromSettings=function(col){var t;col>=0&&(t=M.getCellMeta(0,col).width);if(void 0!==t&&t!==B.width||(t=B.colWidths),null!=t){switch(Ds(t)){case"object":t=t[col];break;case"function":t=t(col)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(t){var e=M._getColWidthFromSettings(t);return void 0===(e=M.runHooks("modifyColWidth",e,t))&&(e=Zr.a.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=B.rowHeights;if(null!=e){switch(Ds(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=M._getRowHeightFromSettings(t);return e=M.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return k.countRows()},this.countSourceCols=function(){return k.countFirstRowKeys()},this.countRows=function(){return R.getLength()},this.countCols=function(){var t=B.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return M.view._wt.drawn?M.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return M.view._wt.drawn?M.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return M.view._wt.drawn?M.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return M.view._wt.drawn?M.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(T.rangeEachReverse)(M.countRows()-1,(function(n){if(M.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(T.rangeEachReverse)(M.countCols()-1,(function(n){if(M.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return B.isEmptyRow.call(M,t)},this.isEmptyCol=function(t){return B.isEmptyCol.call(M,t)},this.selectCell=function(t,e,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(l.isUndefined)(t)&&!Object(l.isUndefined)(e)&&this.selectCells([[t,e,n,r]],o,c)},this.selectCells=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(I=!0);var n=U.selectCells(t);return n&&e&&M.listen(),I=!1,n},this.selectColumns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return U.selectColumns(t,e)},this.selectRows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return U.selectRows(t,e)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=t&&this.hasRowHeaders(),n=t&&this.hasColHeaders();I=!0,U.selectAll(e,n),I=!1};var Q=function(t,e){return t.getNearestNotHiddenIndex(e,1,!0)};this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!n,l=!r,c=t,f=e;if(!(arguments.length>4&&void 0!==arguments[4])||arguments[4]){var d=Number.isInteger(t),h=Number.isInteger(e),y=d?Q(this.rowIndexMapper,t):void 0,m=h?Q(this.columnIndexMapper,e):void 0;if(null===y||null===m)return!1;c=d?M.rowIndexMapper.getRenderableFromVisualIndex(y):void 0,f=h?M.columnIndexMapper.getRenderableFromVisualIndex(m):void 0}var v=Number.isInteger(c),w=Number.isInteger(f);return v&&w?M.view.scrollViewport(M._createCellCoords(c,f),o,r,n,l):v&&!1===w?M.view.scrollViewportVertically(c,o,n):!(!w||!1!==v)&&M.view.scrollViewportHorizontally(f,r,l)},this.destroy=function(){if(M._clearTimeouts(),M._clearImmediates(),M.view&&M.view.destroy(),k&&k.destroy(),k=null,this.getShortcutManager().destroy(),L.clearCache(),Object(vo.b)(M)){var t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}Object(r.empty)(M.rootElement),N.destroy(),x&&x.destroy(),M.batchExecution((function(){M.rowIndexMapper.unregisterAll(),M.columnIndexMapper.unregisterAll(),F.getItems().forEach((function(t){Bs(t,2)[1].destroy()})),F.clear(),M.runHooks("afterDestroy")}),!0),_i.a.getSingleton().destroy(M),Object(object.objectEach)(M,(function(t,e,n){var r;Object(o.isFunction)(t)?n[e]=(r=e,function(){throw new Error('The "'.concat(r,'" method cannot be called because this Handsontable instance has been destroyed'))}):"guid"!==e&&(n[e]=null)})),M.isDestroyed=!0,R&&R.destroy(),M.rowIndexMapper=null,M.columnIndexMapper=null,R=null,j=null,U=null,x=null,M=null},this.getActiveEditor=function(){return x.getActiveEditor()},this.getPlugin=function(t){var e=Object(E.toUpperCaseFirst)(t);return"UndoRedo"===e?this.undoRedo:F.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:F.getId(t)},this.getInstance=function(){return M},this.addHook=function(t,e){_i.a.getSingleton().add(t,e,M)},this.hasHook=function(t){return _i.a.getSingleton().has(t,M)||_i.a.getSingleton().has(t)},this.addHookOnce=function(t,e){_i.a.getSingleton().once(t,e,M)},this.removeHook=function(t,e){_i.a.getSingleton().remove(t,e,M)},this.runHooks=function(t,e,n,r,o,l,c){return _i.a.getSingleton().run(M,t,e,n,r,o,l,c)},this.getTranslatedPhrase=function(t,e){return Object(Ii.d)(B.language,t,e)},this.toHTML=function(){return Object(v.instanceToHTML)(A)},this.toTableElement=function(){var t=A.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Object(v.instanceToHTML)(A)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){var e=t;"function"==typeof e&&(e=setTimeout(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(e)},this._clearTimeouts=function(){Object(m.arrayEach)(this.timeouts,(function(t){clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){Object(m.arrayEach)(this.immediates,(function(t){clearImmediate(t)}))},this._refreshBorders=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];x.destroyEditor(t),M.view.render(),e&&U.isSelected()&&x.prepareEditor()},this.isRtl=function(){return"rtl"===M.rootWindow.getComputedStyle(M.rootElement).direction},this.isLtr=function(){return!M.isRtl()},this.getDirectionFactor=function(){return M.isLtr()?1:-1};var J=Hs({handleEvent:function(t){var e=M.isListening(),n=void 0!==(null==t?void 0:t.key);return e&&n},beforeKeyDown:function(t){return A.runHooks("beforeKeyDown",t)},afterKeyDown:function(t){A.isDestroyed||M.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(function(t){!1===t.ctrlKey&&!1===t.metaKey&&J.releasePressedKeys()})),this.getShortcutManager=function(){return J};var Z=J.addContext("grid"),tt={runOnlyIf:function(){return Object(l.isDefined)(M.getSelected())&&M.countRenderedRows()>0&&M.countRenderedCols()>0},group:Us};J.setActiveContextName("grid"),Z.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){M.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var t=M.getSelectedRange(),e=t[t.length-1].highlight,n=e.row,r=e.col,o=M.getDataAtCell(n,r),l=new Map,i=0;i<t.length;i++)t[i].forAll((function(t,e){t>=0&&e>=0&&(t!==n||e!==r)&&(M.getCellMeta(t,e).readOnly||l.set("".concat(t,"x").concat(e),[t,e,o]))}));M.setDataAtCell(Array.from(l.values()))},runOnlyIf:function(){return M.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){U.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){U.setRangeStart(M._createCellCoords(M.rowIndexMapper.getNearestNotHiddenIndex(0,1),M.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){U.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=M.getSelectedRangeLast(),e=t.from,n=t.to,r=M.rowIndexMapper.getNearestNotHiddenIndex(0,1);U.setRangeStart(e.clone()),U.setRangeEnd(M._createCellCoords(r,n.col))},runOnlyIf:function(){return!(M.selection.isSelectedByCorner()||M.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){U.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){U.setRangeStart(M._createCellCoords(M.rowIndexMapper.getNearestNotHiddenIndex(M.countRows()-1,-1),M.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){U.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=M.getSelectedRangeLast(),e=t.from,n=t.to,r=M.rowIndexMapper.getNearestNotHiddenIndex(M.countRows()-1,-1);U.setRangeStart(e.clone()),U.setRangeEnd(M._createCellCoords(r,n.col))},runOnlyIf:function(){return!(M.selection.isSelectedByCorner()||M.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){U.transformStart(0,-1*M.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=M.getSelectedRangeLast().highlight.row,n=(t=M.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Vs(M.isRtl()?[M.countCols()-1,-1]:[0,1]));U.setRangeStart(M._createCellCoords(e,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){U.transformEnd(0,-1*M.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=M.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=M.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Vs(M.isRtl()?[M.countCols()-1,-1]:[0,1]));U.setRangeStart(n.clone()),U.setRangeEnd(M._createCellCoords(r.row,o))},runOnlyIf:function(){return!(M.selection.isSelectedByCorner()||M.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){U.transformStart(0,M.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=M.getSelectedRangeLast().highlight.row,n=(t=M.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Vs(M.isRtl()?[0,1]:[M.countCols()-1,-1]));U.setRangeStart(M._createCellCoords(e,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){U.transformEnd(0,M.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=M.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=M.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Vs(M.isRtl()?[0,1]:[M.countCols()-1,-1]));U.setRangeStart(n.clone()),U.setRangeEnd(M._createCellCoords(r.row,o))},runOnlyIf:function(){return!(M.selection.isSelectedByCorner()||M.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var t=parseInt(M.getSettings().fixedColumnsStart,10),e=M.getSelectedRangeLast().highlight.row,n=M.columnIndexMapper.getNearestNotHiddenIndex(t,1);U.setRangeStart(M._createCellCoords(e,n))},runOnlyIf:function(){return M.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){U.setRangeEnd(M._createCellCoords(U.selectedRange.current().from.row,M.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(M.getSettings().fixedRowsTop,10),e=parseInt(M.getSettings().fixedColumnsStart,10),n=M.rowIndexMapper.getNearestNotHiddenIndex(t,1),r=M.columnIndexMapper.getNearestNotHiddenIndex(e,1);U.setRangeStart(M._createCellCoords(n,r))},runOnlyIf:function(){return M.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){U.setRangeStart(M._createCellCoords(M.getSelectedRangeLast().highlight.row,M.columnIndexMapper.getNearestNotHiddenIndex(M.countCols()-1,-1)))},runOnlyIf:function(){return M.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){U.setRangeEnd(M._createCellCoords(U.selectedRange.current().from.row,M.columnIndexMapper.getNearestNotHiddenIndex(M.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(M.getSettings().fixedRowsBottom,10),e=M.rowIndexMapper.getNearestNotHiddenIndex(M.countRows()-t-1,-1),n=M.columnIndexMapper.getNearestNotHiddenIndex(M.countCols()-1,-1);U.setRangeStart(M._createCellCoords(e,n))},runOnlyIf:function(){return M.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){U.transformStart(-M.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var t=M.getSelectedRangeLast().to,e=Math.max(t.row-M.countVisibleRows(),0),n=M.rowIndexMapper.getNearestNotHiddenIndex(e,1);if(null!==n){var r=M._createCellCoords(n,t.col),o=t.row-M.view.getFirstFullyVisibleRow(),l=Math.max(r.row-o,0);U.setRangeEnd(r),M.scrollViewportTo(l)}}},{keys:[["PageDown"]],callback:function(){U.transformStart(M.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var t=M.getSelectedRangeLast().to,e=Math.min(t.row+M.countVisibleRows(),M.countRows()-1),n=M.rowIndexMapper.getNearestNotHiddenIndex(e,-1);if(null!==n){var r=M._createCellCoords(n,t.col),o=t.row-M.view.getFirstFullyVisibleRow(),l=Math.min(r.row-o,M.countRows()-1);U.setRangeEnd(r),M.scrollViewportTo(l)}}},{keys:[["Tab"]],callback:function(t){var e="function"==typeof B.tabMoves?B.tabMoves(t):B.tabMoves;U.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var e="function"==typeof B.tabMoves?B.tabMoves(t):B.tabMoves;U.transformStart(-e.row,-e.col)}}],tt),Object(w.b)().forEach((function(t){var e=Object(w.a)(t);F.addItem(t,new e(A))})),_i.a.getSingleton().run(M,"construct")}},862:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"g",(function(){return j})),n.d(e,"b",(function(){return x})),n.d(e,"f",(function(){return A})),n.d(e,"c",(function(){return _})),n.d(e,"d",(function(){return I})),n.d(e,"e",(function(){return M}));var object=n(662),r=n(663),o=n(671),l=n(841),c=n(725);n(691),n(26);var f=Object(c.a)("phraseFormatters"),d=f.register,h=f.getValues;d("pluralize",(function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}));n(654),n(655),n(11),n(62),n(6),n(74),n(240),n(40),n(44);var y,m=n(665);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function w(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==v(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===v(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var S=(w(y={languageCode:"en-US"},m.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),w(y,m.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),w(y,m.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),w(y,m.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),w(y,m.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),w(y,m.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),w(y,m.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),w(y,m.CONTEXTMENU_ITEMS_UNDO,"Undo"),w(y,m.CONTEXTMENU_ITEMS_REDO,"Redo"),w(y,m.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),w(y,m.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),w(y,m.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),w(y,m.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),w(y,m.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),w(y,m.CONTEXTMENU_ITEMS_BORDERS,"Borders"),w(y,m.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),w(y,m.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),w(y,m.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),w(y,m.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),w(y,m.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),w(y,m.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),w(y,m.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),w(y,m.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),w(y,m.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),w(y,m.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),w(y,m.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),w(y,m.CONTEXTMENU_ITEMS_COPY,"Copy"),w(y,m.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,["Copy with header","Copy with headers"]),w(y,m.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,["Copy with group header","Copy with group headers"]),w(y,m.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,["Copy header only","Copy headers only"]),w(y,m.CONTEXTMENU_ITEMS_CUT,"Cut"),w(y,m.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),w(y,m.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),w(y,m.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),w(y,m.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),w(y,m.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),w(y,m.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),w(y,m.FILTERS_CONDITIONS_NONE,"None"),w(y,m.FILTERS_CONDITIONS_EMPTY,"Is empty"),w(y,m.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),w(y,m.FILTERS_CONDITIONS_EQUAL,"Is equal to"),w(y,m.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),w(y,m.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),w(y,m.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),w(y,m.FILTERS_CONDITIONS_CONTAINS,"Contains"),w(y,m.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),w(y,m.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),w(y,m.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),w(y,m.FILTERS_CONDITIONS_LESS_THAN,"Less than"),w(y,m.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),w(y,m.FILTERS_CONDITIONS_BETWEEN,"Is between"),w(y,m.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),w(y,m.FILTERS_CONDITIONS_AFTER,"After"),w(y,m.FILTERS_CONDITIONS_BEFORE,"Before"),w(y,m.FILTERS_CONDITIONS_TODAY,"Today"),w(y,m.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),w(y,m.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),w(y,m.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),w(y,m.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),w(y,m.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),w(y,m.FILTERS_LABELS_CONJUNCTION,"And"),w(y,m.FILTERS_LABELS_DISJUNCTION,"Or"),w(y,m.FILTERS_BUTTONS_SELECT_ALL,"Select all"),w(y,m.FILTERS_BUTTONS_CLEAR,"Clear"),w(y,m.FILTERS_BUTTONS_OK,"OK"),w(y,m.FILTERS_BUTTONS_CANCEL,"Cancel"),w(y,m.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),w(y,m.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),w(y,m.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),y),O=S.languageCode,C=Object(c.a)("languagesDictionaries"),E=C.register,T=C.getItem,R=C.hasItem,k=C.getValues;function j(t,e){var n=t,r=e;return Object(object.isObject)(t)&&(n=(r=t).languageCode),function(t,e){t!==O&&Object(l.a)(e,T(O))}(n,r),E(n,Object(object.deepClone)(r)),Object(object.deepClone)(r)}function x(t){return A(t)?Object(object.deepClone)(T(t)):null}function A(t){return R(t)}function _(){return k()}function I(t,e,n){var l=x(t);if(null===l)return null;var c=l[e];if(Object(o.isUndefined)(c))return null;var f=function(t,e){var n=t;return Object(r.arrayEach)(function(){return h()}(),(function(r){n=r(t,e)})),n}(c,n);return Array.isArray(f)?f[0]:f}function M(t){var e=Object(l.b)(t);return A(e)||(e=O,Object(l.c)(t)),e}j(S)},925:function(t,e,n){"use strict";var r=n(37),o=n(427),l=TypeError;t.exports=function(t){if(r(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw l("Incorrect hint");return o(this,t)}},926:function(t,e,n){"use strict";var r=n(7),o=n(249).codeAt;r({target:"String",proto:!0},{codePointAt:function(t){return o(this,t)}})},927:function(t,e,n){t.exports=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,p){return e=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},e(t,p)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function r(t,o,l){return r=n()?Reflect.construct:function(t,n,r){var a=[null];a.push.apply(a,n);var o=new(Function.bind.apply(t,a));return r&&e(o,r.prototype),o},r.apply(null,arguments)}function o(t){return l(t)||c(t)||f(t)||h()}function l(t){if(Array.isArray(t))return d(t)}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function f(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var y=Object.hasOwnProperty,m=Object.setPrototypeOf,v=Object.isFrozen,w=Object.getPrototypeOf,S=Object.getOwnPropertyDescriptor,O=Object.freeze,C=Object.seal,E=Object.create,T="undefined"!=typeof Reflect&&Reflect,R=T.apply,k=T.construct;R||(R=function(t,e,n){return t.apply(e,n)}),O||(O=function(t){return t}),C||(C=function(t){return t}),k||(k=function(t,e){return r(t,o(e))});var j=B(Array.prototype.forEach),x=B(Array.prototype.pop),A=B(Array.prototype.push),_=B(String.prototype.toLowerCase),I=B(String.prototype.toString),M=B(String.prototype.match),N=B(String.prototype.replace),P=B(String.prototype.indexOf),H=B(String.prototype.trim),D=B(RegExp.prototype.test),L=V(TypeError);function B(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return R(t,e,r)}}function V(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return k(t,n)}}function F(t,e,n){n=n||_,m&&m(t,null);for(var r=e.length;r--;){var element=e[r];if("string"==typeof element){var o=n(element);o!==element&&(v(e)||(e[r]=o),element=o)}t[element]=!0}return t}function W(object){var t,e=E(null);for(t in object)!0===R(y,object,[t])&&(e[t]=object[t]);return e}function U(object,t){for(;null!==object;){var desc=S(object,t);if(desc){if(desc.get)return B(desc.get);if("function"==typeof desc.value)return B(desc.value)}object=w(object)}function e(element){return console.warn("fallback value for",element),null}return e}var z=O(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),G=O(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),X=O(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),K=O(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Y=O(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),$=O(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=O(["#text"]),html=O(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg=O(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q=O(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),J=O(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Z=C(/\{\{[\w\W]*|[\w\W]*\}\}/gm),tt=C(/<%[\w\W]*|[\w\W]*%>/gm),et=C(/\${[\w\W]*}/gm),nt=C(/^data-[\-\w.\u00B7-\uFFFF]/),ot=C(/^aria-[\-\w]+$/),it=C(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),at=C(/^(?:\w+script|data):/i),lt=C(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),st=C(/^html$/i),ut=function(){return"undefined"==typeof window?null:window},ct=function(e,n){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var l="dompurify"+(r?"#"+r:"");try{return e.createPolicy(l,{createHTML:function(html){return html},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function ft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut(),n=function(t){return ft(t)};if(n.version="2.4.5",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var r=e.document,l=e.document,c=e.DocumentFragment,f=e.HTMLTemplateElement,d=e.Node,h=e.Element,y=e.NodeFilter,m=e.NamedNodeMap,v=void 0===m?e.NamedNodeMap||e.MozNamedAttrMap:m,w=e.HTMLFormElement,S=e.DOMParser,C=e.trustedTypes,E=h.prototype,T=U(E,"cloneNode"),R=U(E,"nextSibling"),k=U(E,"childNodes"),B=U(E,"parentNode");if("function"==typeof f){var template=l.createElement("template");template.content&&template.content.ownerDocument&&(l=template.content.ownerDocument)}var V=ct(C,r),ht=V?V.createHTML(""):"",pt=l,yt=pt.implementation,bt=pt.createNodeIterator,mt=pt.createDocumentFragment,vt=pt.getElementsByTagName,gt=r.importNode,wt={};try{wt=W(l).documentMode?l.documentMode:{}}catch(t){}var St={};n.isSupported="function"==typeof B&&yt&&void 0!==yt.createHTMLDocument&&9!==wt;var Ot,Ct,Et=Z,Tt=tt,Rt=et,kt=nt,jt=ot,xt=at,At=lt,_t=it,It=null,Mt=F({},[].concat(o(z),o(G),o(X),o(Y),o(text))),Nt=null,Pt=F({},[].concat(o(html),o(svg),o(Q),o(J))),Ht=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Dt=null,Lt=null,Bt=!0,Vt=!0,Ft=!1,Wt=!0,Ut=!1,zt=!1,Gt=!1,Xt=!1,Kt=!1,Yt=!1,qt=!1,$t=!0,Qt=!1,Jt="user-content-",Zt=!0,te=!1,ee={},ne=null,re=F({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),oe=null,ie=F({},["audio","video","img","source","image","track"]),ae=null,le=F({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),se="http://www.w3.org/1998/Math/MathML",ue="http://www.w3.org/2000/svg",ce="http://www.w3.org/1999/xhtml",fe=ce,de=!1,he=null,pe=F({},[se,ue,ce],I),ye=["application/xhtml+xml","text/html"],be="text/html",me=null,ve=l.createElement("form"),ge=function(t){return t instanceof RegExp||t instanceof Function},we=function(e){me&&me===e||(e&&"object"===t(e)||(e={}),e=W(e),Ot=Ot=-1===ye.indexOf(e.PARSER_MEDIA_TYPE)?be:e.PARSER_MEDIA_TYPE,Ct="application/xhtml+xml"===Ot?I:_,It="ALLOWED_TAGS"in e?F({},e.ALLOWED_TAGS,Ct):Mt,Nt="ALLOWED_ATTR"in e?F({},e.ALLOWED_ATTR,Ct):Pt,he="ALLOWED_NAMESPACES"in e?F({},e.ALLOWED_NAMESPACES,I):pe,ae="ADD_URI_SAFE_ATTR"in e?F(W(le),e.ADD_URI_SAFE_ATTR,Ct):le,oe="ADD_DATA_URI_TAGS"in e?F(W(ie),e.ADD_DATA_URI_TAGS,Ct):ie,ne="FORBID_CONTENTS"in e?F({},e.FORBID_CONTENTS,Ct):re,Dt="FORBID_TAGS"in e?F({},e.FORBID_TAGS,Ct):{},Lt="FORBID_ATTR"in e?F({},e.FORBID_ATTR,Ct):{},ee="USE_PROFILES"in e&&e.USE_PROFILES,Bt=!1!==e.ALLOW_ARIA_ATTR,Vt=!1!==e.ALLOW_DATA_ATTR,Ft=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Wt=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ut=e.SAFE_FOR_TEMPLATES||!1,zt=e.WHOLE_DOCUMENT||!1,Kt=e.RETURN_DOM||!1,Yt=e.RETURN_DOM_FRAGMENT||!1,qt=e.RETURN_TRUSTED_TYPE||!1,Xt=e.FORCE_BODY||!1,$t=!1!==e.SANITIZE_DOM,Qt=e.SANITIZE_NAMED_PROPS||!1,Zt=!1!==e.KEEP_CONTENT,te=e.IN_PLACE||!1,_t=e.ALLOWED_URI_REGEXP||_t,fe=e.NAMESPACE||ce,Ht=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ge(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ht.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ge(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ht.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ht.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ut&&(Vt=!1),Yt&&(Kt=!0),ee&&(It=F({},o(text)),Nt=[],!0===ee.html&&(F(It,z),F(Nt,html)),!0===ee.svg&&(F(It,G),F(Nt,svg),F(Nt,J)),!0===ee.svgFilters&&(F(It,X),F(Nt,svg),F(Nt,J)),!0===ee.mathMl&&(F(It,Y),F(Nt,Q),F(Nt,J))),e.ADD_TAGS&&(It===Mt&&(It=W(It)),F(It,e.ADD_TAGS,Ct)),e.ADD_ATTR&&(Nt===Pt&&(Nt=W(Nt)),F(Nt,e.ADD_ATTR,Ct)),e.ADD_URI_SAFE_ATTR&&F(ae,e.ADD_URI_SAFE_ATTR,Ct),e.FORBID_CONTENTS&&(ne===re&&(ne=W(ne)),F(ne,e.FORBID_CONTENTS,Ct)),Zt&&(It["#text"]=!0),zt&&F(It,["html","head","body"]),It.table&&(F(It,["tbody"]),delete Dt.tbody),O&&O(e),me=e)},Se=F({},["mi","mo","mn","ms","mtext"]),Oe=F({},["foreignobject","desc","title","annotation-xml"]),Ce=F({},["title","style","font","a","script"]),Ee=F({},G);F(Ee,X),F(Ee,K);var Te=F({},Y);F(Te,$);var Re=function(element){var t=B(element);t&&t.tagName||(t={namespaceURI:fe,tagName:"template"});var e=_(element.tagName),n=_(t.tagName);return!!he[element.namespaceURI]&&(element.namespaceURI===ue?t.namespaceURI===ce?"svg"===e:t.namespaceURI===se?"svg"===e&&("annotation-xml"===n||Se[n]):Boolean(Ee[e]):element.namespaceURI===se?t.namespaceURI===ce?"math"===e:t.namespaceURI===ue?"math"===e&&Oe[n]:Boolean(Te[e]):element.namespaceURI===ce?!(t.namespaceURI===ue&&!Oe[n])&&!(t.namespaceURI===se&&!Se[n])&&!Te[e]&&(Ce[e]||!Ee[e]):!("application/xhtml+xml"!==Ot||!he[element.namespaceURI]))},ke=function(t){A(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=ht}catch(e){t.remove()}}},je=function(t,e){try{A(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){A(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Nt[t])if(Kt||Yt)try{ke(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},xe=function(t){var e,n;if(Xt)t="<remove></remove>"+t;else{var r=M(t,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===Ot&&fe===ce&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=V?V.createHTML(t):t;if(fe===ce)try{e=(new S).parseFromString(o,Ot)}catch(t){}if(!e||!e.documentElement){e=yt.createDocument(fe,"template",null);try{e.documentElement.innerHTML=de?ht:o}catch(t){}}var body=e.body||e.documentElement;return t&&n&&body.insertBefore(l.createTextNode(n),body.childNodes[0]||null),fe===ce?vt.call(e,zt?"html":"body")[0]:zt?e.documentElement:body},Ae=function(t){return bt.call(t.ownerDocument||t,t,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT,null,!1)},_e=function(t){return t instanceof w&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof v)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Ie=function(object){return"object"===t(d)?object instanceof d:object&&"object"===t(object)&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName},Me=function(t,e,data){St[t]&&j(St[t],(function(t){t.call(n,e,data,me)}))},Ne=function(t){var content;if(Me("beforeSanitizeElements",t,null),_e(t))return ke(t),!0;if(D(/[\u0080-\uFFFF]/,t.nodeName))return ke(t),!0;var e=Ct(t.nodeName);if(Me("uponSanitizeElement",t,{tagName:e,allowedTags:It}),t.hasChildNodes()&&!Ie(t.firstElementChild)&&(!Ie(t.content)||!Ie(t.content.firstElementChild))&&D(/<[/\w]/g,t.innerHTML)&&D(/<[/\w]/g,t.textContent))return ke(t),!0;if("select"===e&&D(/<template/i,t.innerHTML))return ke(t),!0;if(!It[e]||Dt[e]){if(!Dt[e]&&He(e)){if(Ht.tagNameCheck instanceof RegExp&&D(Ht.tagNameCheck,e))return!1;if(Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(e))return!1}if(Zt&&!ne[e]){var r=B(t)||t.parentNode,o=k(t)||t.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore(T(o[i],!0),R(t))}return ke(t),!0}return t instanceof h&&!Re(t)?(ke(t),!0):"noscript"!==e&&"noembed"!==e||!D(/<\/no(script|embed)/i,t.innerHTML)?(Ut&&3===t.nodeType&&(content=t.textContent,content=N(content,Et," "),content=N(content,Tt," "),content=N(content,Rt," "),t.textContent!==content&&(A(n.removed,{element:t.cloneNode()}),t.textContent=content)),Me("afterSanitizeElements",t,null),!1):(ke(t),!0)},Pe=function(t,e,n){if($t&&("id"===e||"name"===e)&&(n in l||n in ve))return!1;if(Vt&&!Lt[e]&&D(kt,e));else if(Bt&&D(jt,e));else if(!Nt[e]||Lt[e]){if(!(He(t)&&(Ht.tagNameCheck instanceof RegExp&&D(Ht.tagNameCheck,t)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(t))&&(Ht.attributeNameCheck instanceof RegExp&&D(Ht.attributeNameCheck,e)||Ht.attributeNameCheck instanceof Function&&Ht.attributeNameCheck(e))||"is"===e&&Ht.allowCustomizedBuiltInElements&&(Ht.tagNameCheck instanceof RegExp&&D(Ht.tagNameCheck,n)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(n))))return!1}else if(ae[e]);else if(D(_t,N(n,At,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==P(n,"data:")||!oe[t])if(Ft&&!D(xt,N(n,At,"")));else if(n)return!1;return!0},He=function(t){return t.indexOf("-")>0},De=function(e){var r,o,l,c;Me("beforeSanitizeAttributes",e,null);var f=e.attributes;if(f){var d={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Nt};for(c=f.length;c--;){var h=r=f[c],y=h.name,m=h.namespaceURI;if(o="value"===y?r.value:H(r.value),l=Ct(y),d.attrName=l,d.attrValue=o,d.keepAttr=!0,d.forceKeepAttr=void 0,Me("uponSanitizeAttribute",e,d),o=d.attrValue,!d.forceKeepAttr&&(je(y,e),d.keepAttr))if(Wt||!D(/\/>/i,o)){Ut&&(o=N(o,Et," "),o=N(o,Tt," "),o=N(o,Rt," "));var v=Ct(e.nodeName);if(Pe(v,l,o)){if(!Qt||"id"!==l&&"name"!==l||(je(y,e),o=Jt+o),V&&"object"===t(C)&&"function"==typeof C.getAttributeType)if(m);else switch(C.getAttributeType(v,l)){case"TrustedHTML":o=V.createHTML(o);break;case"TrustedScriptURL":o=V.createScriptURL(o)}try{m?e.setAttributeNS(m,y,o):e.setAttribute(y,o),x(n.removed)}catch(t){}}}else je(y,e)}Me("afterSanitizeAttributes",e,null)}},Le=function t(e){var n,r=Ae(e);for(Me("beforeSanitizeShadowDOM",e,null);n=r.nextNode();)Me("uponSanitizeShadowNode",n,null),Ne(n)||(n.content instanceof c&&t(n.content),De(n));Me("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(o){var body,l,f,h,y,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((de=!o)&&(o="\x3c!--\x3e"),"string"!=typeof o&&!Ie(o)){if("function"!=typeof o.toString)throw L("toString is not a function");if("string"!=typeof(o=o.toString()))throw L("dirty is not a string, aborting")}if(!n.isSupported){if("object"===t(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof o)return e.toStaticHTML(o);if(Ie(o))return e.toStaticHTML(o.outerHTML)}return o}if(Gt||we(m),n.removed=[],"string"==typeof o&&(te=!1),te){if(o.nodeName){var v=Ct(o.nodeName);if(!It[v]||Dt[v])throw L("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof d)1===(l=(body=xe("\x3c!----\x3e")).ownerDocument.importNode(o,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?body=l:body.appendChild(l);else{if(!Kt&&!Ut&&!zt&&-1===o.indexOf("<"))return V&&qt?V.createHTML(o):o;if(!(body=xe(o)))return Kt?null:qt?ht:""}body&&Xt&&ke(body.firstChild);for(var w=Ae(te?o:body);f=w.nextNode();)3===f.nodeType&&f===h||Ne(f)||(f.content instanceof c&&Le(f.content),De(f),h=f);if(h=null,te)return o;if(Kt){if(Yt)for(y=mt.call(body.ownerDocument);body.firstChild;)y.appendChild(body.firstChild);else y=body;return(Nt.shadowroot||Nt.shadowrootmod)&&(y=gt.call(r,y,!0)),y}var S=zt?body.outerHTML:body.innerHTML;return zt&&It["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&D(st,body.ownerDocument.doctype.name)&&(S="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+S),Ut&&(S=N(S,Et," "),S=N(S,Tt," "),S=N(S,Rt," ")),V&&qt?V.createHTML(S):S},n.setConfig=function(t){we(t),Gt=!0},n.clearConfig=function(){me=null,Gt=!1},n.isValidAttribute=function(t,e,n){me||we({});var r=Ct(t),o=Ct(e);return Pe(r,o,n)},n.addHook=function(t,e){"function"==typeof e&&(St[t]=St[t]||[],A(St[t],e))},n.removeHook=function(t){if(St[t])return x(St[t])},n.removeHooks=function(t){St[t]&&(St[t]=[])},n.removeAllHooks=function(){St={}},n}return ft()}()},928:function(t,e,n){var r=n(42);t.exports=function(t){return void 0!==t&&(r(t,"value")||r(t,"writable"))}},929:function(t,e,n){var r=n(46),o=Math.floor;t.exports=Number.isInteger||function(t){return!r(t)&&isFinite(t)&&o(t)===t}},930:function(t,e,n){n(931),n(932)},931:function(t,e,n){var r=n(7),o=n(27),l=n(314).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==l},{clearImmediate:l})},932:function(t,e,n){var r=n(7),o=n(27),l=n(314).set,c=n(334),f=o.setImmediate?c(l,!1):l;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==f},{setImmediate:f})},933:function(t,e,n){"use strict";n(11),n(62),n(6),n(74),n(240),n(40),n(44);var r=n(671),o=n(662);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}e.a=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(col){var t,e,n;for(t=0,e=this.countRows();t<e;t++)if(n=this.getDataAtCell(t,col),!1===Object(r.isEmpty)(n))return!1;return!0},isEmptyRow:function(t){var col,e,n,meta;for(col=0,e=this.countCols();col<e;col++)if(n=this.getDataAtCell(t,col),!1===Object(r.isEmpty)(n))return"object"===l(n)&&(meta=this.getCellMeta(t,col),Object(o.isObjectEqual)(this.getSchema()[meta.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}}},934:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return y}));n(240),n(243),n(6),n(40),n(44),n(12),n(56),n(654),n(655),n(11),n(62),n(26),n(74);var r=n(671),o=n(662),l=n(712);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==c(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}var d=0,h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.collection=new Map}var e,n,o;return e=t,(n=[{key:"register",value:function(t,e){var n=this;!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(function(){return n.runLocalHooks("change",e)})),d+=1)}},{key:"unregister",value:function(t){var e=this.collection.get(t);Object(r.isDefined)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),d-=1)}},{key:"unregisterAll",value:function(){var t=this;this.collection.forEach((function(e,n){return t.unregister(n)})),this.collection.clear()}},{key:"get",value:function(t){return Object(r.isUndefined)(t)?Array.from(this.collection.values()):this.collection.get(t)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(t){this.collection.forEach((function(e){e.remove(t)}))}},{key:"insertToEvery",value:function(t,e){this.collection.forEach((function(n){n.insert(t,e)}))}},{key:"initEvery",value:function(t){this.collection.forEach((function(e){e.init(t)}))}}])&&f(e.prototype,n),o&&f(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(){return d}Object(o.mixin)(h,l.a)},935:function(t,e,n){var r=n(7),o=n(936);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},936:function(t,e,n){"use strict";var r=n(143),o=n(88),l=n(117),c=n(77),f=n(248),d=Math.min,h=[].lastIndexOf,y=!!h&&1/[1].lastIndexOf(1,-0)<0,m=f("lastIndexOf"),v=y||!m;t.exports=v?function(t){if(y)return r(h,this,arguments)||0;var e=o(this),n=c(e),f=n-1;for(arguments.length>1&&(f=d(f,l(arguments[1]))),f<0&&(f=n+f);f>=0;f--)if(f in e&&e[f]===t)return f||0;return-1}:h},937:function(t,e,n){var r=n(87),o=n(60),l=n(202),c=n(77),f=TypeError,d=function(t){return function(e,n,d,h){r(n);var y=o(e),m=l(y),v=c(y),w=t?v-1:0,i=t?-1:1;if(d<2)for(;;){if(w in m){h=m[w],w+=i;break}if(w+=i,t?w<0:v<=w)throw f("Reduce of empty array with no initial value")}for(;t?w>=0:v>w;w+=i)w in m&&(h=n(h,m[w],w,y));return h}};t.exports={left:d(!1),right:d(!0)}},938:function(t,e,n){var r=n(18)((function(i){return i[1]}));r.push([t.i,'/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n * \n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in\n * Gdynia, Poland, at Aleja Zwyciestwa 96-98, registered by the District Court in Gdansk under number\n * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n * \n * This software is protected by applicable copyright laws, including international treaties, and dual-\n * licensed  depending on whether your use for commercial purposes, meaning intended for or\n * resulting in commercial advantage or monetary compensation, or not.\n * \n * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing\n * the suitability, performance, and usefulness of this software outside the production environment,\n * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.\n * \n * Your use of this software for commercial purposes is subject to the terms included in an applicable\n * license agreement.\n * \n * In any case, you must not make any such use of this software as to develop software which may be\n * considered competitive with this software.\n * \n * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"\n * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO\n * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,\n * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM\n * USE OR INABILITY TO USE THIS SOFTWARE.\n * \n * Version: 12.3.1\n * Release date: 06/02/2023 (built at 06/02/2023 12:35:03)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-md-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{height:auto;position:relative;width:0}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0;min-height:auto}.handsontable table.htCore{border-collapse:separate;border-spacing:0;border-width:0;cursor:default;margin:0;max-height:none;max-width:none;outline-width:0;table-layout:fixed;width:0}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{background-color:#fff;border-bottom:1px solid #ccc;border-left-width:0;border-right:1px solid #ccc;border-top-width:0;empty-cells:show;height:22px;line-height:21px;outline-width:0;overflow:hidden;padding:0 4px;vertical-align:top;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-left:1px solid #ccc;border-right-width:0}.handsontable th:last-child{border-bottom:1px solid #ccc;border-left:none;border-right:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-left:1px solid #ccc;border-right:none}.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child,[dir=rtl].handsontable th:nth-child(2){border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-left:1px solid #ccc;border-right-width:0}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child{border-left:1px solid #ccc;border-right-width:0}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;font-weight:400;text-align:center;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{font-size:0;position:absolute}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{cursor:crosshair;font-size:0}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{color:#373737;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:13px;font-weight:400;touch-action:manipulation}.handsontable a{color:#104acc}.handsontable.htAutoSize{left:-99000px;position:absolute;top:-99000px;visibility:hidden}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}.hot-display-license-info{color:#373737;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:10px;font-weight:400;padding:5px 0 3px;text-align:left}.hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .manualColumnResizer{cursor:col-resize;height:25px;position:absolute;top:0;width:5px;z-index:210}.handsontable .manualRowResizer{cursor:row-resize;height:5px;left:0;position:absolute;width:50px;z-index:210}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{background-color:#34a9db;border-left:none;border-right:1px dashed #777;display:none;margin-left:5px;margin-right:0;position:absolute;right:auto;top:0;width:0}[dir=rtl].handsontable .manualColumnResizerGuide{border-left:1px dashed #777;border-right:none;left:auto;margin-left:0;margin-right:5px}.handsontable .manualRowResizerGuide{background-color:#34a9db;border-bottom:1px dashed #777;bottom:0;display:none;height:0;left:0;margin-top:5px;position:absolute}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{cursor:pointer;-webkit-text-decoration:underline;text-decoration:underline}.handsontable span.colHeader.columnSorting:before{background-position-x:right;background-repeat:no-repeat;background-size:contain;content:"";height:10px;left:auto;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;top:50%;width:5px}[dir=rtl].handsontable span.colHeader.columnSorting:before{background-position-x:left;left:-9px;padding-left:0;padding-right:8px;right:auto}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC")}.handsontable span.colHeader.columnSorting.descending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=")}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;padding-right:20px;position:relative}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{background:#005eff;bottom:0;bottom:-100%\\9;content:"";left:0;position:absolute;right:0;top:0}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{background-color:#fff;border:none;border-radius:0;box-shadow:inset 0 0 0 2px #5292f7;color:#000;display:block;font-family:inherit;font-size:inherit;line-height:21px;margin:0;outline-width:0;padding:1px 5px 0;resize:none}.handsontableInput:focus{outline:none}.handsontableInputHolder{left:0;position:absolute;top:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{color:#777;content:"";font-size:9px;position:absolute;right:5px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{color:#777;content:"";font-size:9px;left:5px;position:absolute}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{background:#fff;border:1px solid #ccc;border-collapse:separate}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{text-overflow:ellipsis;white-space:nowrap}.handsontable.listbox td.htDimmed{color:inherit;cursor:default;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr td.current,.handsontable.listbox tr:hover td{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable .collapsibleIndicator{background:#eee;border:1px solid #a6a6a6;border-radius:10px;box-shadow:0 0 0 6px #eee;color:#222;cursor:pointer;font-size:10px;height:10px;left:auto;line-height:8px;position:absolute;right:5px;text-align:center;top:50%;transform:translateY(-50%);width:10px}[dir=rtl].handsontable .collapsibleIndicator{left:5px;right:auto}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch;-webkit-user-select:none;-moz-user-select:none;user-select:none}.handsontable.mobile .handsontableInput:focus{-webkit-appearance:none;box-shadow:inset 0 0 0 2px #5292f7}.topSelectionHandle-HitArea:not(.ht_master .topSelectionHandle-HitArea),.topSelectionHandle:not(.ht_master .topSelectionHandle){z-index:9999}.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea{left:-10000px;right:auto;top:-10000px}[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea{left:auto;right:-10000px}.handsontable.hide-tween{animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}\n/*!\n * Pikaday\n * Copyright  2014 David Bushell | BSD & MIT license | https://dbushell.com/\n */.pika-single{background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;color:#333;display:block;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;position:relative;z-index:9999}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single.is-hidden{display:none}.pika-single.is-bound{box-shadow:0 5px 15px -5px rgba(0,0,0,.5);position:absolute}.pika-lendar{float:left;margin:8px;width:240px}.pika-title{position:relative;text-align:center}.pika-label{background-color:#fff;display:inline-block;font-size:14px;font-weight:700;line-height:20px;margin:0;overflow:hidden;padding:5px 3px;position:relative;z-index:9999}.pika-title select{cursor:pointer;left:0;margin:0;opacity:0;position:absolute;top:5px;z-index:9998}.pika-next,.pika-prev{background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;border:0;cursor:pointer;display:block;height:30px;opacity:.5;outline:none;overflow:hidden;padding:0;position:relative;text-indent:20px;white-space:nowrap;width:20px}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==");float:left}.is-rtl .pika-prev,.pika-next{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=");float:right}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block}.pika-table{border:0;border-collapse:collapse;border-spacing:0;width:100%}.pika-table td,.pika-table th{padding:0;width:14.2857142857%}.pika-table th{color:#999;font-size:12px;font-weight:700;line-height:25px;text-align:center}.pika-button{background:#f5f5f5;border:0;box-sizing:border-box;-moz-box-sizing:border-box;color:#666;cursor:pointer;display:block;font-size:12px;height:auto;line-height:15px;margin:0;outline:none;padding:5px;text-align:right;width:100%}.pika-week{color:#999;font-size:11px}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{background:#3af;border-radius:3px;box-shadow:inset 0 1px 3px #178fe5;color:#fff;font-weight:700}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{background:#6cb31d;border-radius:3px;box-shadow:none;color:#fff}.is-endrange .pika-button{background:#3af;border-radius:3px;box-shadow:none;color:#fff}.is-disabled .pika-button{color:#999;cursor:default;opacity:.3;pointer-events:none}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{cursor:default;pointer-events:none}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{background:#ff8000;border-radius:3px;box-shadow:none;color:#fff}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{color:#eee;cursor:default;float:right;font-size:10px;text-align:center;width:16px}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;font-size:inherit;vertical-align:middle}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{border-left:6px solid transparent;border-right:none;border-top:6px solid #000;content:"";left:auto;position:absolute;right:0;top:0}[dir=rtl].handsontable .htCommentCell:after{border-left:none;border-right:6px solid transparent;left:0;right:auto}.htCommentsContainer .htComments{display:none;position:absolute;z-index:1059}.htCommentsContainer .htCommentTextArea{-webkit-appearance:none;background-color:#fff;border:none;border-left:3px solid #ccc;box-shadow:0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.239);box-sizing:border-box;font-size:12px;height:90px;outline:0!important;padding:5px;width:215px}[dir=rtl].htCommentsContainer .htCommentTextArea{border-left:none;border-right:3px solid #ccc}.htCommentsContainer .htCommentTextArea:focus{border-left:3px solid #5292f7;border-right:none;box-shadow:0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.239),inset 0 0 0 1px #5292f7}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-left:none;border-right:3px solid #5292f7}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-left-width:2px;border-right-width:1px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htContextMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{opacity:0;outline:0 none!important;overflow:hidden;position:fixed!important;right:100%!important;top:0!important}\n/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border:1px solid #bbb;border-radius:2px;color:#bbb;float:right;font-size:9px;line-height:9px;margin:3px 1px 0 5px;padding:2px}[dir=rtl].handsontable .changeType{float:left}.handsontable .changeType:before{content:" "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-left-width:2px;border-right-width:1px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}\n/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_bottom,.htFiltersConditionsMenu .ht_clone_bottom_inline_start_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top,.htFiltersConditionsMenu .ht_clone_top_inline_start_corner{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{padding-bottom:3px;padding-top:10px;text-align:center}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{box-sizing:border-box;font-family:inherit;font-size:.75em;padding:4px;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{background-color:#d2e0d9;border:1px solid #509272;color:#18804e}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-left:10px;margin-right:0}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{height:1em;margin:0 5px 0 0;vertical-align:middle}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border:1px solid #d2d1d1;border-radius:2px}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-left:10px;margin-right:0}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border:1px solid #d2d1d1;border-radius:2px;font-family:inherit;font-size:.75em;font-weight:700;overflow:hidden;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border:1px solid #d2d1d1;border-radius:2px;padding:3px}.handsontable .htUIRadio{display:inline-block;height:100%;margin-left:0;margin-right:5px}[dir=rtl].handsontable .htUIRadio{margin-left:5px;margin-right:0}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-left:.5ex;margin-right:0}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;font-size:5pt;position:absolute;top:50%;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{content:"";right:1px}[dir=rtl].handsontable th.beforeHiddenColumn:after{content:"";left:1px;right:auto}.handsontable th.afterHiddenColumn:before{content:"";left:1px}[dir=rtl].handsontable th.afterHiddenColumn:before{content:"";left:auto;right:1px}\n/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;left:2px;line-height:6pt;position:absolute}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{bottom:2px;content:""}.handsontable th.afterHiddenRow:after{content:"";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{display:none;height:100%;position:absolute}.handsontable .ht__manualColumnMove--guideline{background:#757575;margin-left:-1px;margin-right:0;top:0;width:2px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;pointer-events:none;z-index:205}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{display:none;position:absolute;width:100%}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;pointer-events:none;z-index:205}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{font-size:8px;height:8px;left:auto;line-height:1.1;margin-top:-2px;padding-left:5px;padding-right:0;position:absolute;right:-15px;-webkit-text-decoration:underline;text-decoration:underline;top:50%}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;padding-left:0;padding-right:5px;right:auto}.handsontable span.colHeader.columnSorting:after{-webkit-text-decoration:none;text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{padding-left:7px;text-align:left}[dir=rtl].handsontable th.ht_nestingLevels{padding-right:7px;text-align:right}.handsontable th div.ht_nestingLevels{display:inline-block;left:11px;position:absolute;right:auto}[dir=rtl].handsontable th div.ht_nestingLevels{left:auto;right:11px}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:auto;right:10px}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:auto}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;float:left;height:1px;width:10px}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{bottom:3px;content:"";display:inline-block;font-size:9px;position:relative}.handsontable th div.ht_nestingButton{cursor:pointer;display:inline-block;left:auto;position:absolute;right:-2px}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:auto}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:auto;right:0}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:auto}',""]),r.locals={},t.exports=r},996:function(t,e,n){"use strict";n.d(e,"b",(function(){return T})),n.d(e,"c",(function(){return R})),n.d(e,"a",(function(){return k}));n(245),n(85),n(34),n(48),n(654),n(655),n(11),n(62),n(6),n(26),n(417),n(418),n(130),n(74),n(240),n(40),n(44),n(55),n(56),n(33);var r=n(671),object=n(662),o=n(763),l=n(663),c={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;Object(l.arrayEach)(this._hooksStorage[t]||[],(function(n){e.hot.removeHook(t,n)}))},clearHooks:function(){var t=this;Object(object.objectEach)(this._hooksStorage,(function(e,n){return t.removeHooksByKey(n)})),this._hooksStorage={}}};Object(object.defineGetter)(c,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var f=c,d=n(664);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function y(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,d=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){d=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(t,p){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},v(t,p)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S(t);if(e){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==h(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===h(o)?o:String(o)),n)}var r,o}function E(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var T=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),R="baseEditor",k=function(){function t(e){O(this,t),this.hot=e,this.instance=e,this.state=T.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return E(t,[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,col,e,td,n,r){this.TD=td,this.row=t,this.col=col,this.prop=e,this.originalValue=n,this.cellProperties=r,this.state=T.VIRGIN}},{key:"extend",value:function(){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(n,t);var e=w(n);function n(){return O(this,n),e.apply(this,arguments)}return E(n)}(this.constructor)}},{key:"saveValue",value:function(t,e){var n,o,l,c,f=this;if(e){var d=this.hot.getSelectedLast();n=Math.max(Math.min(d[0],d[2]),0),o=Math.max(Math.min(d[1],d[3]),0),l=Math.max(d[0],d[2]),c=Math.max(d[1],d[3])}else{var h=[this.row,this.col,null,null];n=h[0],o=h[1],l=h[2],c=h[3]}var m=this.hot.runHooks("modifyGetCellCoords",n,o);if(Array.isArray(m)){var v=y(m,2);n=v[0],o=v[1]}var w=this.hot.getShortcutManager().getContext("editor"),S={runOnlyIf:function(){return Object(r.isDefined)(f.hot.getSelected())},group:R};this.isInFullEditMode()&&w.addShortcuts([{keys:[["ArrowUp"]],callback:function(){f.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){f.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){f.hot.selection.transformStart(0,-1*f.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){f.hot.selection.transformStart(0,f.hot.getDirectionFactor())}}],S),this.hot.populateFromArray(n,o,t,l,c,"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===T.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),l=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,l)),this.state=T.EDITING,this.isInFullEditMode()){var c="string"==typeof t?t:Object(r.stringify)(this.originalValue);this.setValue(c)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,n){var r,l=this;if(n){var c=this._closeCallback;this._closeCallback=function(t){c&&c(t),n(t),l.hot.view.render()}}if(!this.isWaiting()){var f=this.hot.getShortcutManager().getContext("editor");if(f.removeShortcutsByGroup(R),f.removeShortcutsByGroup(o.b),this.state!==T.VIRGIN){if(this.state===T.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var d=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof d?String.prototype.trim.call(d||""):d]]:[[d]],this.state=T.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(t){l.state=T.FINISHED,l.discardEditor(t)})):(this.state=T.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){l._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=T.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){this.state===T.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=T.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=T.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===T.WAITING}},{key:"getEditedCellRect",value:function(){var t,e=this.getEditedCell();if(e){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,l=this.hot.rootWindow,c=Object(d.offset)(e),f=Object(d.outerWidth)(e),h=Object(d.offset)(this.hot.rootElement),y=Object(d.outerWidth)(this.hot.rootElement),m=r.topOverlay.holder,v=r.inlineStartOverlay.holder,w=m!==l?m.scrollTop:0,S=v!==l?v.scrollLeft:0,O=l.innerWidth-h.left-y,C=(null!==(t=r.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt).wtTable,E=C.name,T=["master","inline_start"].includes(E)?w:0,R=["master","top","bottom"].includes(E)?S:0,k=c.top===h.top?0:1,j=c.top-h.top-k-T,x=0;x=this.hot.isRtl()?l.innerWidth-c.left-f-O-1+R:c.left-h.left-1-R,["top","top_inline_start_corner"].includes(E)&&(j+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var A=this.hot.hasColHeaders(),_=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),I=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),M=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(A&&_<=0||_===M)&&(j+=1),I<=0&&(x+=1);var N=o.rowsRenderCalculator.startPosition,P=o.columnsRenderCalculator.startPosition,H=Math.abs(r.inlineStartOverlay.getScrollPosition()),D=r.topOverlay.getScrollPosition(),L=Object(d.getScrollbarWidth)(this.hot.rootDocument),B=e.offsetTop+N-D,V=0;if(this.hot.isRtl()){var F=e.offsetLeft;V=F>=0?C.getWidth()-e.offsetLeft:Math.abs(F),V+=P-H-f}else V=e.offsetLeft+P-H;var W=Object(d.getComputedStyle)(this.TD,this.hot.rootWindow),U=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",z=parseInt(W[U],10)>0?0:1,G=parseInt(W.borderTopWidth,10)>0?0:1,X=Object(d.outerWidth)(e)+z,K=Object(d.outerHeight)(e)+G,Y=Object(d.hasVerticalScrollbar)(m)?L:0,$=Object(d.hasHorizontalScrollbar)(v)?L:0,Q=this.hot.view.maximumVisibleElementWidth(V)-Y+z;return{top:j,start:x,height:K,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(B)-$+G,23),width:X,maxWidth:Q}}}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),section="";return this.row<this.hot.getSettings().fixedRowsTop?section=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?section=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(section="inline-start"),section}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),t}();Object(object.mixin)(k,f)}}]);